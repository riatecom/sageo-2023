<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Timoth√©e Giraud, Nicolas Lambert, Matthieu Viry, Ronan Ysebaert (UAR RIATE, CNRS, Universit√© Paris Cit√©)">

<title>Articulation de diff√©rents langages (R, JavaScript et Python) pour la g√©ovisualisation avec Quarto</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="ojs_files/libs/clipboard/clipboard.min.js"></script>
<script src="ojs_files/libs/quarto-html/quarto.js"></script>
<script src="ojs_files/libs/quarto-html/popper.min.js"></script>
<script src="ojs_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="ojs_files/libs/quarto-html/anchor.min.js"></script>
<link href="ojs_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="ojs_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="ojs_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="ojs_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="ojs_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script type="module" src="ojs_files/libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="ojs_files/libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul class="collapse">
  <li><a href="#observable-javascript" id="toc-observable-javascript" class="nav-link active" data-scroll-target="#observable-javascript">Observable JavaScript</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Articulation de diff√©rents langages (R, JavaScript et Python) pour la g√©ovisualisation avec Quarto</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
<p class="subtitle lead">Atelier Sageo, Qu√©bec, Juin 2023</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Timoth√©e Giraud, Nicolas Lambert, Matthieu Viry, Ronan Ysebaert (UAR RIATE, CNRS, Universit√© Paris Cit√©) </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="observable-javascript" class="level2">
<h2 class="anchored" data-anchor-id="observable-javascript">Observable JavaScript</h2>
<section id="observable-kezako" class="level3">
<h3 class="anchored" data-anchor-id="observable-kezako">Observable Kezako ?</h3>
<p>L‚Äô<b>Observable javascript {ojs}</b> est un ensemble d‚Äôam√©liorations apport√©es √† vanilla JavaScript cr√©√© par Mike Bostock (√©galement auteur de D3). Observable JS se distingue par son ex√©cution r√©active, qui convient particuli√®rement bien √† l‚Äôexploration et √† l‚Äôanalyse interactives des donn√©es.</p>
<p><img src="fig/d3.png" class="img-fluid" style="width:20.0%"> <img src="fig/arrow.png" class="img-fluid" style="width:20.0%"> <img src="fig/observable.png" class="img-fluid" style="width:20.0%"> <br> <strong>Observable</strong> est aussi une startup fond√©e par Mike Bostock et Melody Meckfessel, qui propose une plateforme 100% en ligne (<a href="https://observablehq.com">https://observablehq.com</a>) pour concevoir, partager et diffuser des visualisations de donn√©es.</p>
<p><img src="fig/frise.png" class="img-fluid"></p>
<p><strong>Observable</strong> c‚Äôest donc aussi C‚Äôest aussi une plateforme web qui h√©berge des notebooks computationnels sur la visualisation de donn√©es.</p>
<p>üëâ <strong>Objectif</strong> : faire collaborer une communaut√© autour de la visualisation de donn√©es.</p>
</section>
<section id="observable-dans-quarto" class="level3">
<h3 class="anchored" data-anchor-id="observable-dans-quarto">Observable dans Quarto</h3>
<p>Le runtime d‚ÄôObservable est Open Source et est utilis√© dans Quarto.</p>
<p>Dans Quarto, toutes les instructions s‚Äô√©crivent dans des chunks {ojs}</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>On peut param√©trer l‚Äôaffiche et/ou l‚Äôexecution du code avec <strong>//| echo</strong> et <strong>//| eval</strong>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">//| eval: true</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><em>NB : Contrairement aux chunks R et Python, le code s‚Äôexecute <em>just in time</em> dans le navigateur web une fois le notebook g√©n√©r√©. Seul l‚Äôexport html est donc pris en compte.</em></p>
</section>
<section id="principes" class="level3">
<h3 class="anchored" data-anchor-id="principes">Principes</h3>
<p>Le langage JavaScript n‚Äôa pas du √©t√© con√ßu pour l‚Äôanalyse de donn√©es. Mais, gros point fort, on a tous un navigateur web et JavaScript tourne sur toutes les machines. Le but : b√¢tir une √©volution du langage JavaScript pour en faire un langage adapt√© √† l‚Äôanalyse et la visualisation de donn√©es sur le web.</p>
<section id="des-biblioth√®ques-pr√©charg√©es" class="level4">
<h4 class="anchored" data-anchor-id="des-biblioth√®ques-pr√©charg√©es">üëâ Des biblioth√®ques pr√©charg√©es üìä</h4>
<p>OJS c‚Äôest du JavaScript + plein de biblioth√®ques pr√© charg√©es : <br></p>
<table class="table">
<thead>
<tr class="header">
<th>Symbol</th>
<th>Name</th>
<th>Version</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>_</td>
<td>Lodash</td>
<td>4.17.21</td>
</tr>
<tr class="even">
<td>aq</td>
<td>Arquero</td>
<td><span><span id="ojs-element-id-1"></span></span></td>
</tr>
<tr class="odd">
<td>Arrow</td>
<td>Apache Arrow</td>
<td>4.0.1</td>
</tr>
<tr class="even">
<td>d3</td>
<td>D3.js</td>
<td><span><span id="ojs-element-id-2"></span></span></td>
</tr>
<tr class="odd">
<td>dot</td>
<td>Graphviz</td>
<td>0.2.1</td>
</tr>
<tr class="even">
<td>htl</td>
<td>Hypertext Literal</td>
<td><span><span id="ojs-element-id-3"></span></span></td>
</tr>
<tr class="odd">
<td>Inputs</td>
<td>Observable Inputs</td>
<td><span><span id="ojs-element-id-4"></span></span></td>
</tr>
<tr class="even">
<td>L</td>
<td>Leaflet</td>
<td><span><span id="ojs-element-id-5"></span></span></td>
</tr>
<tr class="odd">
<td>mermaid</td>
<td>Mermaid</td>
<td>9.1.6</td>
</tr>
<tr class="even">
<td>Plot</td>
<td>Observable Plot</td>
<td><span><span id="ojs-element-id-6"></span></span></td>
</tr>
<tr class="odd">
<td>SQLite</td>
<td>SQL.js</td>
<td>1.7.0</td>
</tr>
<tr class="even">
<td>topojson</td>
<td>TopoJSON Client</td>
<td>3.1.0</td>
</tr>
<tr class="odd">
<td>vl</td>
<td>Vega, Vega-Lite</td>
<td>5.22.1, 5.2.0</td>
</tr>
</tbody>
</table>
</section>
<section id="chaque-d√©but-de-ligne-identifie-une-cellule-ojs" class="level4">
<h4 class="anchored" data-anchor-id="chaque-d√©but-de-ligne-identifie-une-cellule-ojs">üëâ Chaque d√©but de ligne identifie une cellule ojs üôã</h4>
<p>Chaque ligne d√©finit une variable et une cellule qui doit √™tre unique sur l‚Äôensemble du document.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="dv">10</span> <span class="co">// une cellule</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">20</span> <span class="co">// une cellule</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> a <span class="op">+</span> b <span class="co">// une cellule</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> { </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> a <span class="op">=</span> <span class="dv">10</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> b <span class="op">=</span> <span class="dv">30</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> a <span class="op">+</span> b </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>} <span class="co">// Une cellule</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="lordre-des-cellules-na-pas-dimportance" class="level4">
<h4 class="anchored" data-anchor-id="lordre-des-cellules-na-pas-dimportance">üëâ L‚Äôordre des cellules n‚Äôa pas d‚Äôimportance ü§Ø</h4>
<p>On peut donc √©crire √ßa</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> val1 <span class="op">*</span> val2</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>avant √ßa</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>val1 <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>val2 <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Le lien entre les cellules se fait de fa√ßon topologique et non de haut en bas.</p>
<p><img src="fig/topology.png" class="img-fluid"></p>
</section>
<section id="tout-est-r√©actif" class="level4">
<h4 class="anchored" data-anchor-id="tout-est-r√©actif">üëâ Tout est r√©actif üî•</h4>
<p>D√®s lors qu‚Äôune cellule est modifi√©e, les cellules qui en d√©pendent sont modifi√©es √©galement.</p>
<p>Pour modifier la valeutr d‚Äôune c√©llule, on utilise des <strong><code>Inputs</code></strong> (des composants propos√©s par OJS pour explorer les donn√©es) avec le mot cl√© <strong><code>viewof</code></strong>. Voir : https://observablehq.com/<span class="citation" data-cites="observablehq/inputs">@observablehq/inputs</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" data-startfrom="123" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 122;"><span id="cb8-123"><a href="#cb8-123" aria-hidden="true" tabindex="-1"></a>viewof x <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">255</span>]<span class="op">,</span> {<span class="dt">step</span><span class="op">:</span> <span class="dv">1</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" data-startfrom="127" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 126;"><span id="cb9-127"><a href="#cb9-127" aria-hidden="true" tabindex="-1"></a>viewof y <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">text</span>({<span class="dt">value</span><span class="op">:</span> <span class="dv">30</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" data-startfrom="131" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 130;"><span id="cb10-131"><a href="#cb10-131" aria-hidden="true" tabindex="-1"></a>viewof z <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">radio</span>([<span class="dv">10</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">1000</span>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="dv">10</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" data-startfrom="135" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 134;"><span id="cb11-135"><a href="#cb11-135" aria-hidden="true" tabindex="-1"></a>x <span class="op">*</span> y <span class="op">*</span> z</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-4" data-nodetype="expression">

</div>
</div>
</div>
<p>Ce syst√®me est pratique pour modifier des visualisations de donn√©es.</p>
<p>Ici, un exemple avec un simple cercle dessin√© en svg.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" data-startfrom="144" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 143;"><span id="cb12-144"><a href="#cb12-144" aria-hidden="true" tabindex="-1"></a>viewof color <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">color</span>({ <span class="dt">label</span><span class="op">:</span> <span class="st">"Couleur"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">"#4ab58c"</span> })</span>
<span id="cb12-145"><a href="#cb12-145" aria-hidden="true" tabindex="-1"></a>viewof radius <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">1</span><span class="op">,</span> <span class="dv">50</span>]<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"Rayon"</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">100</span> })</span>
<span id="cb12-146"><a href="#cb12-146" aria-hidden="true" tabindex="-1"></a>viewof position <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">50</span><span class="op">,</span> <span class="dv">950</span>]<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"Position"</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">50</span> })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-3" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" data-startfrom="149" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 148;"><span id="cb13-149"><a href="#cb13-149" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`&lt;svg viewBox="0 0 1000 100" xmlns="http://www.w3.org/2000/svg"&gt;</span></span>
<span id="cb13-150"><a href="#cb13-150" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;circle cx=</span><span class="sc">${</span>position<span class="sc">}</span><span class="vs"> cy="50" r=</span><span class="sc">${</span>radius<span class="sc">}</span><span class="vs"> fill="</span><span class="sc">${</span>color<span class="sc">}</span><span class="vs">"/&gt;</span></span>
<span id="cb13-151"><a href="#cb13-151" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/svg&gt;`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-6" data-nodetype="expression">

</div>
</div>
</div>
</section>
</section>
<section id="l√©cosyst√®me-spatial-avec-ojs" class="level3">
<h3 class="anchored" data-anchor-id="l√©cosyst√®me-spatial-avec-ojs">l‚Äô√©cosyst√®me spatial avec Ojs</h3>
<p>L‚Äô√©cosyst√®me spatial de JavaScript est moins √©toff√© que ce qu‚Äôon peut trouver en Python ou en R. Mais on trouve quand m√™me des choses int√©ressantes qui permettent de faire de la g√©omatique directement dans le navigateur web. Voici quelques exemples.</p>
<p><strong>Les fonctionnalit√©s spatiales de <code>d3.js</code></strong></p>
<div class="columns">
<div class="column" style="width:8%;">
<p><img src="fig/d3.png" class="img-fluid"></p>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:90%;">
<p><a href="https://github.com/d3/d3-geo"><strong><code>d3-geo</code></strong></a> est le module spatial de d3. Il permet de g√©rer les projections cartographiques, les formes sph√©riques et la trigonom√©trie sph√©rique. Voir aussi <a href="https://github.com/d3/d3-geo-projection"><strong><code>d3-geo-projection</code></strong></a>. <a href="https://github.com/d3/d3-delaunay"><strong><code>d3-delaunay</code></strong></a> est une biblioth√®que rapide pour calculer le diagramme de Vorono√Ø d‚Äôun ensemble de points bidimensionnels. Elle est bas√©e sur Delaunator, une biblioth√®que rapide pour calculer la triangulation de Delaunay en utilisant des algorithmes de balayage. Le diagramme de Vorono√Ø est construit en reliant les circonf√©rences des triangles adjacents dans la triangulation de Delaunay. <a href="https://github.com/Fil/d3-geo-voronoi"><strong><code>d3-geo-voronoi</code></strong></a> est une adaptation de d3-delaunay sur la sph√®re.</p>
</div>
</div>
<div class="columns">
<div class="column" style="width:8%;">
<p><img src="fig/topojson.svg" class="img-fluid"></p>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:90%;">
<p><a href="https://github.com/topojson/topojson"><strong><code>TopoJSON</code></strong></a> est une extension de GeoJSON. La librairie permet de r√©aliser des op√©rations SIG bas√©es sur la topologie (agr√©gation, voisins, simplification, etc.)</p>
</div>
</div>
<p><strong>Les biblioth√®ques SIG</strong></p>
<div class="columns">
<div class="column" style="width:8%;">
<p><img src="fig/turf.png" class="img-fluid"></p>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:90%;">
<p><a href="https://turfjs.org/"><strong><code>turf</code></strong></a> est une biblioth√®que JavaScript pour l‚Äôanalyse spatiale (de type SIG). Elle comprend les op√©rations spatiales traditionnelles, des fonctions d‚Äôaide pour la cr√©ation de donn√©es GeoJSON, ainsi que des outils de classification des donn√©es et de statistiques. L‚Äôavantage de turf est d‚Äô√™tre modulaire. On ne charge que ce dont on a besoin.</p>
</div>
</div>
<div class="columns">
<div class="column" style="width:8%;">
<p><img src="fig/spljs.jpg" class="img-fluid"></p>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:90%;">
<p><a href="https://turfjs.org/"><strong><code>spl.js</code></strong></a> est une impl√©mentation de SpatiaLite (et de ses amis : sqlite, geos, proj, rttopo) pour le navigateur.</p>
</div>
</div>
<div class="columns">
<div class="column" style="width:8%;">
<p><img src="fig/geotoolbox.svg" class="img-fluid"></p>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:90%;">
<p><a href="https://github.com/neocarto/geotoolbox"><strong><code>geotoolbox</code></strong></a> est un outil javascript pour les g√©ographes bas√© sur d3geo, topojson et jsts. Il permet de traiter simplement les propri√©t√©s geojson et fournit plusieurs op√©rations SIG utiles pour la cartographie th√©matique.</p>
</div>
</div>
<div class="columns">
<div class="column" style="width:8%;">
<p><img src="fig/gdal.png" class="img-fluid"></p>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:90%;">
<p><a href="https://github.com/bugra9/gdal3.js"><strong><code>Gdals3.js</code></strong></a> est un portage des applications Gdal (gdal_translate, ogr2ogr, gdal_rasterize, gdalwarp, gdaltransform) vers Webassembly. Il permet de convertir des donn√©es g√©ospatiales matricielles et vectorielles dans divers formats et syst√®mes de coordonn√©es.</p>
</div>
</div>
<div class="columns">
<div class="column" style="width:8%;">
<p><img src="fig/proj4.png" class="img-fluid"></p>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:90%;">
<p><a href="http://proj4js.org/"><strong><code>proj4js</code></strong></a> est une biblioth√®que JavaScript permettant de transformer les coordonn√©es d‚Äôun syst√®me de coordonn√©es √† un autre, y compris les transformations de datum</p>
</div>
</div>
<p><strong>Dataviz / cartographie</strong></p>
<div class="columns">
<div class="column" style="width:8%;">
<p><img src="fig/plot.png" class="img-fluid"></p>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:90%;">
<p><a href="https://observablehq.com/plot/"><strong><code>plot</code></strong></a> est la biblioth√®que de visualisation de donn√©e d√©velopp√©e par Observable (Mike Bostock et Philippe Rivi√®re). Au d√©part pens√©e pour la visualisation de donn√©es statistiques, elle permet aujourd‚Äôhui de r√©aliser des cartes. Plot est disponible par d√©faut dans les cellules {ojs}.</p>
</div>
</div>
<div class="columns">
<div class="column" style="width:8%;">
<p><img src="fig/vega.png" class="img-fluid"></p>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:90%;">
<p><a href="https://github.com/vega/vega-lite"><strong><code>vega-lite</code></strong></a> est un outil de visualisation mettant en ≈ìuvre une grammaire graphique, similaire √† ggplot2. Cette biblioth√®que est disponible par d√©faut dans les cellules {ojs}.</p>
</div>
</div>
<div class="columns">
<div class="column" style="width:8%;">
<p><img src="fig/bertin.png" class="img-fluid"></p>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:90%;">
<p><a href="https://github.com/neocarto/bertin"><strong><code>bertin</code></strong></a> est une biblioth√®que √©crite en JavaScript qui permet de r√©aliser des cartes th√©matiques pour le web. Sa conception vise √† permettre aux utilisateurs de cr√©er rapidement des cartes th√©matiques interactives sans forcement conna√Ætre le langage JavaScript.</p>
</div>
</div>
<div class="columns">
<div class="column" style="width:8%;">
<p><img src="fig/gridviz.png" class="img-fluid"></p>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:90%;">
<p><a href="https://github.com/eurostat/gridviz"><strong><code>Gridviz</code></strong></a> est une biblioth√®que JavaScript bas√©e sur WebGL d√©velopp√©e par Julien Gaffuri et Joe Davies. Elle permet de visualiser des donn√©es carroy√©es (ou tout ensemble de donn√©es tabulaires avec une position x/y) dans le navigateur dans une grande vari√©t√© de styles cartographiques.</p>
</div>
</div>
<div class="columns">
<div class="column" style="width:8%;">
<p><img src="fig/logo-go-cart-wasm.png" class="img-fluid"></p>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:90%;">
<p><a href="https://github.com/riatelab/go-cart-wasm"><strong><code>go-cart-wasm</code></strong></a> est une biblioth√®que JS/WASM permettant de r√©aliser des cartogrammes bas√©s sur le flux (comme d√©crit dans ‚ÄúGastner, Seguy, and More (2018).</p>
</div>
</div>
</section>
<section id="cartographie-interactive-avec-observable-javascript" class="level3">
<h3 class="anchored" data-anchor-id="cartographie-interactive-avec-observable-javascript">Cartographie interactive avec Observable JavaScript</h3>
<p>On souhaite √† pr√©sent r√©aliser une carte interactive √† l‚Äô√©chelle des municipalit√©s.</p>
<p>Tout d‚Äôabord, on r√©cp√®re les donn√©es depuis R (<strong>TODO</strong>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" data-startfrom="305" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 304;"><span id="cb14-305"><a href="#cb14-305" aria-hidden="true" tabindex="-1"></a>munic <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"geom/munic.geojson"</span>)<span class="op">.</span><span class="fu">json</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-7" data-nodetype="declaration">

</div>
</div>
</div>
<p>Regardons la table attributaire</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" data-startfrom="311" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 310;"><span id="cb15-311"><a href="#cb15-311" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">table</span>(munic<span class="op">.</span><span class="at">features</span><span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">properties</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-8" data-nodetype="expression">

</div>
</div>
</div>
<p>Comme leaflet est disponible dans les cellules {ojs}, on peut directement afficher les g√©om√©tries.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16" data-startfrom="317" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 316;"><span id="cb16-317"><a href="#cb16-317" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb16-318"><a href="#cb16-318" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> container <span class="op">=</span> <span class="kw">yield</span> htl<span class="op">.</span><span class="fu">html</span><span class="vs">`&lt;div style="height: 500px;"&gt;`</span><span class="op">;</span></span>
<span id="cb16-319"><a href="#cb16-319" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> map <span class="op">=</span> L<span class="op">.</span><span class="fu">map</span>(container)<span class="op">;</span></span>
<span id="cb16-320"><a href="#cb16-320" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> layer <span class="op">=</span> L<span class="op">.</span><span class="fu">geoJSON</span>(munic)<span class="op">.</span><span class="fu">addTo</span>(map)<span class="op">;</span></span>
<span id="cb16-321"><a href="#cb16-321" aria-hidden="true" tabindex="-1"></a>  map<span class="op">.</span><span class="fu">fitBounds</span>(layer<span class="op">.</span><span class="fu">getBounds</span>()<span class="op">,</span> { <span class="dt">maxZoom</span><span class="op">:</span> <span class="dv">9</span> })<span class="op">;</span></span>
<span id="cb16-322"><a href="#cb16-322" aria-hidden="true" tabindex="-1"></a>  L<span class="op">.</span><span class="fu">tileLayer</span>(<span class="st">"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"</span><span class="op">,</span> {</span>
<span id="cb16-323"><a href="#cb16-323" aria-hidden="true" tabindex="-1"></a>    <span class="dt">attribution</span><span class="op">:</span></span>
<span id="cb16-324"><a href="#cb16-324" aria-hidden="true" tabindex="-1"></a>      <span class="st">"¬© &lt;a href=https://www.openstreetmap.org/copyright&gt;OpenStreetMap&lt;/a&gt; contributors"</span></span>
<span id="cb16-325"><a href="#cb16-325" aria-hidden="true" tabindex="-1"></a>  })<span class="op">.</span><span class="fu">addTo</span>(map)<span class="op">;</span></span>
<span id="cb16-326"><a href="#cb16-326" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-9" data-nodetype="expression">

</div>
</div>
</div>
<p>Le fond de carte n‚Äôest pas assez simplifi√©. Donc on le simplifie et on le nettoie avec la bibioth√®que <strong><code>geotoolbox</code></strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" data-startfrom="332" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 331;"><span id="cb17-332"><a href="#cb17-332" aria-hidden="true" tabindex="-1"></a>geo <span class="op">=</span> <span class="pp">require</span>(<span class="st">"geotoolbox"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-10" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" data-startfrom="336" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 335;"><span id="cb18-336"><a href="#cb18-336" aria-hidden="true" tabindex="-1"></a>munic2 <span class="op">=</span> geo<span class="op">.</span><span class="fu">rewind</span>(geo<span class="op">.</span><span class="fu">simplify</span>(munic<span class="op">,</span> { <span class="dt">k</span><span class="op">:</span> <span class="fl">0.02</span> }))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-11" data-nodetype="declaration">

</div>
</div>
</div>
<p><strong>Cr√©ation de cartes th√©matiques</strong></p>
<p>Pour cr√©er des cartes th√©matiques, on peut utiliser la biblioth√®que <a href="https://github.com/neocarto/bertin"><strong><code>bertin</code></strong></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19" data-startfrom="344" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 343;"><span id="cb19-344"><a href="#cb19-344" aria-hidden="true" tabindex="-1"></a>bertin <span class="op">=</span> <span class="pp">require</span>(<span class="st">"bertin"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-12" data-nodetype="declaration">

</div>
</div>
</div>
<p>La fonction <strong><code>draw</code></strong> permet de r√©aliser n‚Äôimporte quel type de carte.</p>
<p><img src="fig/bertin_code.png" class="img-fluid"></p>
<p>Par d√©faut, la couche s‚Äôaffiche simplement.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" data-startfrom="354" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 353;"><span id="cb20-354"><a href="#cb20-354" aria-hidden="true" tabindex="-1"></a>bertin<span class="op">.</span><span class="fu">draw</span>({<span class="dt">layers</span><span class="op">:</span>[{<span class="dt">geojson</span><span class="op">:</span> munic2<span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"#d18de0"</span>}]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-13" data-nodetype="expression">

</div>
</div>
</div>
<p><strong>Cartographie th√©matique</strong></p>
<p>A pr√©sent, r√©alisons une carte de la population en 2022. Pour cela, on utilise le type <strong><code>bubble</code></strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21" data-startfrom="362" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 361;"><span id="cb21-362"><a href="#cb21-362" aria-hidden="true" tabindex="-1"></a>bertin<span class="op">.</span><span class="fu">draw</span>({</span>
<span id="cb21-363"><a href="#cb21-363" aria-hidden="true" tabindex="-1"></a>  <span class="dt">params</span><span class="op">:</span> { <span class="dt">margin</span><span class="op">:</span> [<span class="op">-</span><span class="dv">550</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">50</span><span class="op">,</span> <span class="dv">0</span>]}<span class="op">,</span> <span class="co">// marges [Haut, droite, bas, gauche]</span></span>
<span id="cb21-364"><a href="#cb21-364" aria-hidden="true" tabindex="-1"></a>  <span class="dt">layers</span><span class="op">:</span> [</span>
<span id="cb21-365"><a href="#cb21-365" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">type</span><span class="op">:</span> <span class="st">"header"</span><span class="op">,</span> <span class="dt">text</span><span class="op">:</span> <span class="st">"Population en 2022"</span><span class="op">,</span> <span class="dt">anchor</span><span class="op">:</span> <span class="st">"start"</span> }<span class="op">,</span> <span class="co">// Titre</span></span>
<span id="cb21-366"><a href="#cb21-366" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">type</span><span class="op">:</span> <span class="st">"minimap"</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="dv">30</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="dv">185</span><span class="op">,</span> <span class="dt">width</span><span class="op">:</span> <span class="dv">90</span><span class="op">,</span> <span class="dt">projection</span><span class="op">:</span><span class="st">"Polar"</span> }<span class="op">,</span> <span class="co">// Carte de localisation</span></span>
<span id="cb21-367"><a href="#cb21-367" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb21-368"><a href="#cb21-368" aria-hidden="true" tabindex="-1"></a>      <span class="dt">id</span> <span class="op">:</span> <span class="st">"bub"</span><span class="op">,</span> <span class="co">//  identifiant de la couche</span></span>
<span id="cb21-369"><a href="#cb21-369" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"bubble"</span><span class="op">,</span> <span class="co">// couche de symboles proportionnels</span></span>
<span id="cb21-370"><a href="#cb21-370" aria-hidden="true" tabindex="-1"></a>      <span class="dt">geojson</span><span class="op">:</span> munic2<span class="op">,</span> </span>
<span id="cb21-371"><a href="#cb21-371" aria-hidden="true" tabindex="-1"></a>      <span class="dt">values</span><span class="op">:</span> <span class="st">"POP_2022"</span><span class="op">,</span> <span class="co">// variable √† cartographier </span></span>
<span id="cb21-372"><a href="#cb21-372" aria-hidden="true" tabindex="-1"></a>      <span class="dt">k</span><span class="op">:</span> <span class="dv">30</span><span class="op">,</span> <span class="co">// Rayon du plus gros cercle</span></span>
<span id="cb21-373"><a href="#cb21-373" aria-hidden="true" tabindex="-1"></a>      <span class="dt">leg_x</span><span class="op">:</span> <span class="dv">500</span><span class="op">,</span></span>
<span id="cb21-374"><a href="#cb21-374" aria-hidden="true" tabindex="-1"></a>      <span class="dt">leg_y</span><span class="op">:</span> <span class="dv">130</span><span class="op">,</span></span>
<span id="cb21-375"><a href="#cb21-375" aria-hidden="true" tabindex="-1"></a>      <span class="dt">leg_round</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb21-376"><a href="#cb21-376" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fill</span><span class="op">:</span> <span class="st">"red"</span><span class="op">,</span></span>
<span id="cb21-377"><a href="#cb21-377" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fillOpacity</span><span class="op">:</span><span class="fl">0.5</span><span class="op">,</span></span>
<span id="cb21-378"><a href="#cb21-378" aria-hidden="true" tabindex="-1"></a>      <span class="dt">tooltip</span><span class="op">:</span> [<span class="st">"$MUS_NM_MUN"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">properties</span>[<span class="st">"POP_2022"</span>]] <span class="co">// infobulle</span></span>
<span id="cb21-379"><a href="#cb21-379" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb21-380"><a href="#cb21-380" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">geojson</span><span class="op">:</span> munic2<span class="op">,</span> <span class="dt">fill</span><span class="op">:</span><span class="st">"#CCC"</span>}<span class="op">,</span> <span class="co">// Couche des communes</span></span>
<span id="cb21-381"><a href="#cb21-381" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb21-382"><a href="#cb21-382" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-14" data-nodetype="expression">

</div>
</div>
</div>
<div class="callout-caution callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
A vous de jouer - Rendez la carte interactive avec {ojs}
</div>
</div>
<div class="callout-body-container callout-body">
<p>Pour rendre la carte interactive, vous avez pouvez proposer des <code>Inputs</code> pour interagir avec l‚Äôutilisateur.</p>
<p>Ajoutez un Input de type <code>radio</code> pour d√©finir la symbologie : <a href="https://github.com/neocarto/bertin#bubble"><strong><code>bubble</code></strong></a>, <a href="https://github.com/neocarto/bertin#square"><strong><code>square</code></strong></a> et <a href="https://github.com/neocarto/bertin#spikes"><strong><code>spikes</code></strong></a></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>viewof symbol <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">radio</span>([<span class="vs">`a`</span><span class="op">,</span> <span class="vs">`b`</span><span class="op">,</span> <span class="vs">`c`</span>]<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="vs">`label`</span><span class="op">,</span>  <span class="dt">value</span><span class="op">:</span> <span class="vs">`valeur par d√©faut`</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Cr√©ez un slider pouyr faire varier la taille des symboles</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>viewof rayon <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="vs">`min`</span><span class="op">,</span> <span class="vs">`max`</span>]<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"label"</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">30</span> })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Modifiez la carte pr√©c√©dente pour prendre en compte ces valeurs.</p>
<p>Utilisez <code>//| echo: false</code> pour masquer le code.</p>
<p>Pour en savoir plus sur les <code>inputs</code>, voir : <a href="https://observablehq.com/@observablehq/inputs"><span class="citation" data-cites="observablehq/inputs">@observablehq/inputs</span></a></p>
</div>
</div>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Les Inputs</p>
<div class="cell" data-eval="false">
<div class="sourceCode cell-code" id="cb24" data-startfrom="424" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 423;"><span id="cb24-424"><a href="#cb24-424" aria-hidden="true" tabindex="-1"></a>viewof symbol <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">radio</span>([<span class="vs">`bubble`</span><span class="op">,</span> <span class="vs">`square`</span>]<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="vs">`Symbol`</span><span class="op">,</span>  <span class="dt">value</span><span class="op">:</span> <span class="vs">`bubble`</span>})</span>
<span id="cb24-425"><a href="#cb24-425" aria-hidden="true" tabindex="-1"></a>viewof rayon <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">1</span><span class="op">,</span> <span class="dv">100</span>]<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"Rayon"</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">30</span> })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-15-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-15-2" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<p>Et la carte</p>
<div class="cell" data-eval="false">
<div class="sourceCode cell-code" id="cb25" data-startfrom="432" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 431;"><span id="cb25-432"><a href="#cb25-432" aria-hidden="true" tabindex="-1"></a>bertin<span class="op">.</span><span class="fu">draw</span>({</span>
<span id="cb25-433"><a href="#cb25-433" aria-hidden="true" tabindex="-1"></a>  <span class="dt">params</span><span class="op">:</span> { <span class="dt">margin</span><span class="op">:</span> [<span class="op">-</span><span class="dv">550</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">50</span><span class="op">,</span> <span class="dv">0</span>]}<span class="op">,</span></span>
<span id="cb25-434"><a href="#cb25-434" aria-hidden="true" tabindex="-1"></a>  <span class="dt">layers</span><span class="op">:</span> [</span>
<span id="cb25-435"><a href="#cb25-435" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">type</span><span class="op">:</span> <span class="st">"header"</span><span class="op">,</span> <span class="dt">text</span><span class="op">:</span> title<span class="op">,</span> <span class="dt">anchor</span><span class="op">:</span> <span class="st">"start"</span> }<span class="op">,</span> <span class="co">// ICI</span></span>
<span id="cb25-436"><a href="#cb25-436" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">type</span><span class="op">:</span> <span class="st">"minimap"</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="dv">30</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="dv">185</span><span class="op">,</span> <span class="dt">width</span><span class="op">:</span> <span class="dv">90</span><span class="op">,</span> <span class="dt">projection</span><span class="op">:</span><span class="st">"Polar"</span> }<span class="op">,</span> </span>
<span id="cb25-437"><a href="#cb25-437" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb25-438"><a href="#cb25-438" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> symbol<span class="op">,</span> <span class="co">// ICI </span></span>
<span id="cb25-439"><a href="#cb25-439" aria-hidden="true" tabindex="-1"></a>      <span class="dt">geojson</span><span class="op">:</span> munic2<span class="op">,</span> </span>
<span id="cb25-440"><a href="#cb25-440" aria-hidden="true" tabindex="-1"></a>      <span class="dt">values</span><span class="op">:</span> <span class="st">"POP_2022"</span><span class="op">,</span> </span>
<span id="cb25-441"><a href="#cb25-441" aria-hidden="true" tabindex="-1"></a>      <span class="dt">k</span><span class="op">:</span> rayon<span class="op">,</span> <span class="co">// ICI</span></span>
<span id="cb25-442"><a href="#cb25-442" aria-hidden="true" tabindex="-1"></a>      <span class="dt">leg_x</span><span class="op">:</span> <span class="dv">500</span><span class="op">,</span></span>
<span id="cb25-443"><a href="#cb25-443" aria-hidden="true" tabindex="-1"></a>      <span class="dt">leg_y</span><span class="op">:</span> <span class="dv">130</span><span class="op">,</span></span>
<span id="cb25-444"><a href="#cb25-444" aria-hidden="true" tabindex="-1"></a>      <span class="dt">leg_round</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb25-445"><a href="#cb25-445" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fill</span><span class="op">:</span> <span class="st">"red"</span><span class="op">,</span></span>
<span id="cb25-446"><a href="#cb25-446" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fillOpacity</span><span class="op">:</span><span class="fl">0.5</span><span class="op">,</span></span>
<span id="cb25-447"><a href="#cb25-447" aria-hidden="true" tabindex="-1"></a>      <span class="dt">tooltip</span><span class="op">:</span> [<span class="st">"$MUS_NM_MUN"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">properties</span>[<span class="st">"POP_2022"</span>]] </span>
<span id="cb25-448"><a href="#cb25-448" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb25-449"><a href="#cb25-449" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">geojson</span><span class="op">:</span> munic2<span class="op">,</span> <span class="dt">fill</span><span class="op">:</span><span class="st">"#CCC"</span>}<span class="op">,</span></span>
<span id="cb25-450"><a href="#cb25-450" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb25-451"><a href="#cb25-451" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-16" data-nodetype="expression">

</div>
</div>
</div>
<div class="cell" data-eval="true">
<div class="sourceCode cell-code hidden" id="cb26" data-startfrom="458" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 457;"><span id="cb26-458"><a href="#cb26-458" aria-hidden="true" tabindex="-1"></a>viewof symbol <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">radio</span>([<span class="vs">`bubble`</span><span class="op">,</span> <span class="vs">`square`</span>]<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="vs">`Symbol`</span><span class="op">,</span>  <span class="dt">value</span><span class="op">:</span> <span class="vs">`bubble`</span>})</span>
<span id="cb26-459"><a href="#cb26-459" aria-hidden="true" tabindex="-1"></a>viewof rayon <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">1</span><span class="op">,</span> <span class="dv">100</span>]<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"Rayon"</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">30</span> })</span>
<span id="cb26-460"><a href="#cb26-460" aria-hidden="true" tabindex="-1"></a>title <span class="op">=</span> val <span class="op">==</span> <span class="st">"AREA"</span> <span class="op">?</span> <span class="st">"Superficie"</span> <span class="op">:</span> <span class="st">"Population en 2022"</span></span>
<span id="cb26-461"><a href="#cb26-461" aria-hidden="true" tabindex="-1"></a>bertin<span class="op">.</span><span class="fu">draw</span>({</span>
<span id="cb26-462"><a href="#cb26-462" aria-hidden="true" tabindex="-1"></a>  <span class="dt">params</span><span class="op">:</span> { <span class="dt">margin</span><span class="op">:</span> [<span class="op">-</span><span class="dv">550</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">50</span><span class="op">,</span> <span class="dv">0</span>]}<span class="op">,</span></span>
<span id="cb26-463"><a href="#cb26-463" aria-hidden="true" tabindex="-1"></a>  <span class="dt">layers</span><span class="op">:</span> [</span>
<span id="cb26-464"><a href="#cb26-464" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">type</span><span class="op">:</span> <span class="st">"header"</span><span class="op">,</span> <span class="dt">text</span><span class="op">:</span> title<span class="op">,</span> <span class="dt">anchor</span><span class="op">:</span> <span class="st">"start"</span> }<span class="op">,</span></span>
<span id="cb26-465"><a href="#cb26-465" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">type</span><span class="op">:</span> <span class="st">"minimap"</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="dv">30</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="dv">185</span><span class="op">,</span> <span class="dt">width</span><span class="op">:</span> <span class="dv">90</span><span class="op">,</span> <span class="dt">projection</span><span class="op">:</span><span class="st">"Polar"</span> }<span class="op">,</span> </span>
<span id="cb26-466"><a href="#cb26-466" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb26-467"><a href="#cb26-467" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> symbol<span class="op">,</span> </span>
<span id="cb26-468"><a href="#cb26-468" aria-hidden="true" tabindex="-1"></a>      <span class="dt">geojson</span><span class="op">:</span> munic2<span class="op">,</span> </span>
<span id="cb26-469"><a href="#cb26-469" aria-hidden="true" tabindex="-1"></a>      <span class="dt">values</span><span class="op">:</span> <span class="st">"POP_2022"</span><span class="op">,</span> </span>
<span id="cb26-470"><a href="#cb26-470" aria-hidden="true" tabindex="-1"></a>      <span class="dt">k</span><span class="op">:</span> rayon<span class="op">,</span></span>
<span id="cb26-471"><a href="#cb26-471" aria-hidden="true" tabindex="-1"></a>      <span class="dt">leg_x</span><span class="op">:</span> <span class="dv">500</span><span class="op">,</span></span>
<span id="cb26-472"><a href="#cb26-472" aria-hidden="true" tabindex="-1"></a>      <span class="dt">leg_y</span><span class="op">:</span> <span class="dv">130</span><span class="op">,</span></span>
<span id="cb26-473"><a href="#cb26-473" aria-hidden="true" tabindex="-1"></a>      <span class="dt">leg_round</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb26-474"><a href="#cb26-474" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fill</span><span class="op">:</span> <span class="st">"red"</span><span class="op">,</span></span>
<span id="cb26-475"><a href="#cb26-475" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fillOpacity</span><span class="op">:</span><span class="fl">0.5</span><span class="op">,</span></span>
<span id="cb26-476"><a href="#cb26-476" aria-hidden="true" tabindex="-1"></a>      <span class="dt">tooltip</span><span class="op">:</span> [<span class="st">"$MUS_NM_MUN"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">properties</span>[<span class="st">"POP_2022"</span>]] </span>
<span id="cb26-477"><a href="#cb26-477" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb26-478"><a href="#cb26-478" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">geojson</span><span class="op">:</span> munic2<span class="op">,</span> <span class="dt">fill</span><span class="op">:</span><span class="st">"#CCC"</span>}<span class="op">,</span></span>
<span id="cb26-479"><a href="#cb26-479" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb26-480"><a href="#cb26-480" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-17-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-17-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-17-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-17-4" data-nodetype="expression">

</div>
</div>
</div>
</div>
</div>
</div>
</div>
<p>A pr√©sent, on souhaite colorier les cercles en fonction de l‚Äôindice de vitalit√© √©conomique.</p>
<div class="callout-caution callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
A vous de jouer
</div>
</div>
<div class="callout-body-container callout-body">
<p>Proposer la variable √† cartographier via une liste d√©roulante.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>viewof val <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">select</span>([<span class="st">"A"</span><span class="op">,</span> <span class="st">"B"</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Select one"</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Pour faire des variations de couleurs (i.e.&nbsp;valeur), on utilise le type <strong><code>choro</code></strong> √† l‚Äôint√©rieur de l‚Äôattribut <strong><code>fill</code></strong> de la couche √† colorier. Ici, les cercles proportionnels.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>fill <span class="op">:</span> {type <span class="st">"choro"</span><span class="op">,</span> <span class="dt">values</span><span class="op">:</span> <span class="vs">`votre variable`</span><span class="op">,</span> <span class="dt">colors</span><span class="op">:</span> <span class="st">"RdYlBu"</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Pour param√©trer, voir : <a href="https://github.com/neocarto/bertin#choropleth">bertin#choropleth</a> &amp; <a href="https://observablehq.com/@neocartocnrs/bertin-js-chropoleth?collection=@neocartocnrs/bertin">bertin-js-chropoleth</a></p>
</div>
</div>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb29" data-startfrom="510" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 509;"><span id="cb29-510"><a href="#cb29-510" aria-hidden="true" tabindex="-1"></a>viewof val <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">select</span>([<span class="st">"VIT_ECO"</span><span class="op">,</span> <span class="st">"REV_MED"</span><span class="op">,</span>   <span class="st">"TX_2564"</span><span class="op">,</span> <span class="st">"TAAM"</span>]<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"Variable"</span> })</span>
<span id="cb29-511"><a href="#cb29-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-512"><a href="#cb29-512" aria-hidden="true" tabindex="-1"></a>bertin<span class="op">.</span><span class="fu">draw</span>({</span>
<span id="cb29-513"><a href="#cb29-513" aria-hidden="true" tabindex="-1"></a>  <span class="dt">params</span><span class="op">:</span> { <span class="dt">margin</span><span class="op">:</span> [<span class="op">-</span><span class="dv">550</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">50</span><span class="op">,</span> <span class="dv">0</span>]}<span class="op">,</span></span>
<span id="cb29-514"><a href="#cb29-514" aria-hidden="true" tabindex="-1"></a>  <span class="dt">layers</span><span class="op">:</span> [</span>
<span id="cb29-515"><a href="#cb29-515" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">type</span><span class="op">:</span> <span class="st">"header"</span><span class="op">,</span> <span class="dt">text</span><span class="op">:</span> title<span class="op">,</span> <span class="dt">anchor</span><span class="op">:</span> <span class="st">"start"</span> }<span class="op">,</span></span>
<span id="cb29-516"><a href="#cb29-516" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">type</span><span class="op">:</span> <span class="st">"minimap"</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="dv">30</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="dv">185</span><span class="op">,</span> <span class="dt">width</span><span class="op">:</span> <span class="dv">90</span><span class="op">,</span> <span class="dt">projection</span><span class="op">:</span><span class="st">"Polar"</span> }<span class="op">,</span> </span>
<span id="cb29-517"><a href="#cb29-517" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb29-518"><a href="#cb29-518" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> symbol<span class="op">,</span> </span>
<span id="cb29-519"><a href="#cb29-519" aria-hidden="true" tabindex="-1"></a>      <span class="dt">geojson</span><span class="op">:</span> munic2<span class="op">,</span> </span>
<span id="cb29-520"><a href="#cb29-520" aria-hidden="true" tabindex="-1"></a>      <span class="dt">values</span><span class="op">:</span> <span class="st">"POP_2020"</span><span class="op">,</span> </span>
<span id="cb29-521"><a href="#cb29-521" aria-hidden="true" tabindex="-1"></a>      <span class="dt">k</span><span class="op">:</span> rayon<span class="op">,</span></span>
<span id="cb29-522"><a href="#cb29-522" aria-hidden="true" tabindex="-1"></a>      <span class="dt">leg_x</span><span class="op">:</span> <span class="dv">500</span><span class="op">,</span></span>
<span id="cb29-523"><a href="#cb29-523" aria-hidden="true" tabindex="-1"></a>      <span class="dt">leg_y</span><span class="op">:</span> <span class="dv">130</span><span class="op">,</span></span>
<span id="cb29-524"><a href="#cb29-524" aria-hidden="true" tabindex="-1"></a>      <span class="dt">leg_round</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb29-525"><a href="#cb29-525" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fill</span><span class="op">:</span> { <span class="co">// ICI</span></span>
<span id="cb29-526"><a href="#cb29-526" aria-hidden="true" tabindex="-1"></a>        <span class="dt">type</span><span class="op">:</span> <span class="st">"choro"</span><span class="op">,</span></span>
<span id="cb29-527"><a href="#cb29-527" aria-hidden="true" tabindex="-1"></a>        <span class="dt">values</span><span class="op">:</span> val<span class="op">,</span> <span class="co">// ICI</span></span>
<span id="cb29-528"><a href="#cb29-528" aria-hidden="true" tabindex="-1"></a>        <span class="dt">colors</span><span class="op">:</span> <span class="st">"RdYlBu"</span><span class="op">,</span></span>
<span id="cb29-529"><a href="#cb29-529" aria-hidden="true" tabindex="-1"></a>        <span class="dt">leg_x</span><span class="op">:</span><span class="dv">680</span><span class="op">,</span></span>
<span id="cb29-530"><a href="#cb29-530" aria-hidden="true" tabindex="-1"></a>        <span class="dt">leg_y</span><span class="op">:</span><span class="dv">100</span><span class="op">,</span></span>
<span id="cb29-531"><a href="#cb29-531" aria-hidden="true" tabindex="-1"></a>        <span class="dt">leg_round</span><span class="op">:</span> <span class="dv">0</span></span>
<span id="cb29-532"><a href="#cb29-532" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb29-533"><a href="#cb29-533" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fillOpacity</span><span class="op">:</span><span class="fl">0.8</span><span class="op">,</span></span>
<span id="cb29-534"><a href="#cb29-534" aria-hidden="true" tabindex="-1"></a>      <span class="dt">tooltip</span><span class="op">:</span> [<span class="st">"$MUS_NM_MUN"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">properties</span>[val]] <span class="co">// ICI</span></span>
<span id="cb29-535"><a href="#cb29-535" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb29-536"><a href="#cb29-536" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">geojson</span><span class="op">:</span> munic2<span class="op">,</span> <span class="dt">fill</span><span class="op">:</span><span class="st">"#CCC"</span>}<span class="op">,</span></span>
<span id="cb29-537"><a href="#cb29-537" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb29-538"><a href="#cb29-538" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-18-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-18-2" data-nodetype="expression">

</div>
</div>
</div>
</div>
</div>
</div>
</div>
<p><strong>Cr√©ation de graphiques</strong></p>
<p>Avec <strong><code>{ojs}</code></strong>, on va aussi pouvoir faire des graphiques avec la biblioth√®que <strong><code>plot</code></strong>.</p>
<p>Tout d‚Äôabord, on r√©cup√®re les noms des 20 communes les plus peupl√©es, class√©es par ordre d√©croissant de population.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30" data-startfrom="548" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 547;"><span id="cb30-548"><a href="#cb30-548" aria-hidden="true" tabindex="-1"></a>communes <span class="op">=</span> munic2<span class="op">.</span><span class="at">features</span></span>
<span id="cb30-549"><a href="#cb30-549" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">properties</span>)</span>
<span id="cb30-550"><a href="#cb30-550" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">sort</span>((a<span class="op">,</span> b) <span class="kw">=&gt;</span> d3<span class="op">.</span><span class="fu">descending</span>(a<span class="op">.</span><span class="at">POP_2022</span><span class="op">,</span> b<span class="op">.</span><span class="at">POP_2022</span>))</span>
<span id="cb30-551"><a href="#cb30-551" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">MUS_NM_MUN</span>)</span>
<span id="cb30-552"><a href="#cb30-552" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-19" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell" data-eval="true">
<div class="sourceCode cell-code hidden" id="cb31" data-startfrom="558" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 557;"><span id="cb31-558"><a href="#cb31-558" aria-hidden="true" tabindex="-1"></a>communes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-20" data-nodetype="expression">

</div>
</div>
</div>
<p>On met en forme les donn√©es.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32" data-startfrom="564" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 563;"><span id="cb32-564"><a href="#cb32-564" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> {</span>
<span id="cb32-565"><a href="#cb32-565" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> arr <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb32-566"><a href="#cb32-566" aria-hidden="true" tabindex="-1"></a>  communes<span class="op">.</span><span class="fu">forEach</span>((d) <span class="kw">=&gt;</span> {</span>
<span id="cb32-567"><a href="#cb32-567" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> tmp <span class="op">=</span> munic2<span class="op">.</span><span class="at">features</span></span>
<span id="cb32-568"><a href="#cb32-568" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">properties</span>)</span>
<span id="cb32-569"><a href="#cb32-569" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">find</span>((x) <span class="kw">=&gt;</span> x<span class="op">.</span><span class="at">MUS_NM_MUN</span> <span class="op">==</span> d)<span class="op">;</span></span>
<span id="cb32-570"><a href="#cb32-570" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">2001</span><span class="op">;</span> i <span class="op">&lt;=</span> <span class="dv">2022</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb32-571"><a href="#cb32-571" aria-hidden="true" tabindex="-1"></a>      arr<span class="op">.</span><span class="fu">push</span>({ <span class="dt">year</span><span class="op">:</span> i<span class="op">,</span> <span class="dt">pop</span><span class="op">:</span> tmp[<span class="st">"POP_"</span> <span class="op">+</span> i]<span class="op">,</span> <span class="dt">com</span><span class="op">:</span> d })<span class="op">;</span></span>
<span id="cb32-572"><a href="#cb32-572" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb32-573"><a href="#cb32-573" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb32-574"><a href="#cb32-574" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> arr<span class="op">;</span></span>
<span id="cb32-575"><a href="#cb32-575" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-21" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell" data-eval="true">
<div class="sourceCode cell-code hidden" id="cb33" data-startfrom="581" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 580;"><span id="cb33-581"><a href="#cb33-581" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-22" data-nodetype="expression">

</div>
</div>
</div>
<p>Puis on r√©alise le graphique avec <code>plot</code> en proposant de s√©lectionner une commune.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34" data-startfrom="588" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 587;"><span id="cb34-588"><a href="#cb34-588" aria-hidden="true" tabindex="-1"></a>viewof commune <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">select</span>(communes<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"Commune"</span> })</span>
<span id="cb34-589"><a href="#cb34-589" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb34-590"><a href="#cb34-590" aria-hidden="true" tabindex="-1"></a>  <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb34-591"><a href="#cb34-591" aria-hidden="true" tabindex="-1"></a>  <span class="dt">x</span><span class="op">:</span> {</span>
<span id="cb34-592"><a href="#cb34-592" aria-hidden="true" tabindex="-1"></a>    <span class="dt">label</span><span class="op">:</span> <span class="st">"Ann√©es ‚Üí"</span><span class="op">,</span></span>
<span id="cb34-593"><a href="#cb34-593" aria-hidden="true" tabindex="-1"></a>    <span class="dt">tickFormat</span><span class="op">:</span> <span class="st">""</span></span>
<span id="cb34-594"><a href="#cb34-594" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb34-595"><a href="#cb34-595" aria-hidden="true" tabindex="-1"></a>  <span class="dt">y</span><span class="op">:</span> {</span>
<span id="cb34-596"><a href="#cb34-596" aria-hidden="true" tabindex="-1"></a>    <span class="dt">label</span><span class="op">:</span> <span class="vs">`‚Üë Population (</span><span class="sc">${</span>commune<span class="sc">}</span><span class="vs">)`</span></span>
<span id="cb34-597"><a href="#cb34-597" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb34-598"><a href="#cb34-598" aria-hidden="true" tabindex="-1"></a>  <span class="dt">color</span><span class="op">:</span> { <span class="dt">legend</span><span class="op">:</span> <span class="kw">true</span> }<span class="op">,</span></span>
<span id="cb34-599"><a href="#cb34-599" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marginLeft</span><span class="op">:</span> <span class="dv">60</span><span class="op">,</span></span>
<span id="cb34-600"><a href="#cb34-600" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb34-601"><a href="#cb34-601" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">lineY</span>(data<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">com</span> <span class="op">==</span> commune)<span class="op">,</span> {</span>
<span id="cb34-602"><a href="#cb34-602" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span></span>
<span id="cb34-603"><a href="#cb34-603" aria-hidden="true" tabindex="-1"></a>      <span class="dt">y</span><span class="op">:</span> <span class="st">"pop"</span><span class="op">,</span></span>
<span id="cb34-604"><a href="#cb34-604" aria-hidden="true" tabindex="-1"></a>      <span class="dt">stroke</span><span class="op">:</span> <span class="st">"red"</span><span class="op">,</span></span>
<span id="cb34-605"><a href="#cb34-605" aria-hidden="true" tabindex="-1"></a>      <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">2</span></span>
<span id="cb34-606"><a href="#cb34-606" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb34-607"><a href="#cb34-607" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb34-608"><a href="#cb34-608" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-23-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-23-2" data-nodetype="expression">

</div>
</div>
</div>
</div>
<p><strong>Cartographie de donn√©es raster</strong></p>
<!-- -->

<script type="ojs-module-contents">
{"contents":[
  {"methodName":"interpret","inline":"true","source":"htl.html`<span>${aq.version}</span>`", "cellName":"ojs-element-id-1"}
,
  {"methodName":"interpret","inline":"true","source":"htl.html`<span>${d3.version}</span>`", "cellName":"ojs-element-id-2"}
,
  {"methodName":"interpret","inline":"true","source":"htl.html`<span>${htl.version}</span>`", "cellName":"ojs-element-id-3"}
,
  {"methodName":"interpret","inline":"true","source":"htl.html`<span>${Inputs.version}</span>`", "cellName":"ojs-element-id-4"}
,
  {"methodName":"interpret","inline":"true","source":"htl.html`<span>${L.version}</span>`", "cellName":"ojs-element-id-5"}
,
  {"methodName":"interpret","inline":"true","source":"htl.html`<span>${Plot.version}</span>`", "cellName":"ojs-element-id-6"}
]}
</script>
</section>
</section>

</main>
<!-- /main column -->

<script type="ojs-module-contents">
{"contents":[{"methodName":"interpret","cellName":"ojs-cell-1","inline":false,"source":"viewof x = Inputs.range([0, 255], {step: 1})\n"},{"methodName":"interpret","cellName":"ojs-cell-2","inline":false,"source":"viewof y = Inputs.text({value: 30})\n"},{"methodName":"interpret","cellName":"ojs-cell-3","inline":false,"source":"viewof z = Inputs.radio([10, 100, 1000], {value: 10})\n"},{"methodName":"interpret","cellName":"ojs-cell-4","inline":false,"source":"x * y * z\n"},{"methodName":"interpret","cellName":"ojs-cell-5","inline":false,"source":"viewof color = Inputs.color({ label: \"Couleur\", value: \"#4ab58c\" })\nviewof radius = Inputs.range([1, 50], { label: \"Rayon\", step: 1, value: 100 })\nviewof position = Inputs.range([50, 950], { label: \"Position\", step: 1, value: 50 })\n"},{"methodName":"interpret","cellName":"ojs-cell-6","inline":false,"source":"html`<svg viewBox=\"0 0 1000 100\" xmlns=\"http://www.w3.org/2000/svg\">\n  <circle cx=${position} cy=\"50\" r=${radius} fill=\"${color}\"/>\n</svg>`\n"},{"methodName":"interpret","cellName":"ojs-cell-7","inline":false,"source":"munic = FileAttachment(\"geom/munic.geojson\").json()\n"},{"methodName":"interpret","cellName":"ojs-cell-8","inline":false,"source":"Inputs.table(munic.features.map(d => d.properties))\n"},{"methodName":"interpret","cellName":"ojs-cell-9","inline":false,"source":"{\n  const container = yield htl.html`<div style=\"height: 500px;\">`;\n  const map = L.map(container);\n  const layer = L.geoJSON(munic).addTo(map);\n  map.fitBounds(layer.getBounds(), { maxZoom: 9 });\n  L.tileLayer(\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\", {\n    attribution:\n      \"¬© <a href=https://www.openstreetmap.org/copyright>OpenStreetMap</a> contributors\"\n  }).addTo(map);\n}\n"},{"methodName":"interpret","cellName":"ojs-cell-10","inline":false,"source":"geo = require(\"geotoolbox\")\n"},{"methodName":"interpret","cellName":"ojs-cell-11","inline":false,"source":"munic2 = geo.rewind(geo.simplify(munic, { k: 0.02 }))\n"},{"methodName":"interpret","cellName":"ojs-cell-12","inline":false,"source":"bertin = require(\"bertin\")\n"},{"methodName":"interpret","cellName":"ojs-cell-13","inline":false,"source":"bertin.draw({layers:[{geojson: munic2, fill: \"#d18de0\"}]})\n"},{"methodName":"interpret","cellName":"ojs-cell-14","inline":false,"source":"bertin.draw({\n  params: { margin: [-550, 0, 50, 0]}, // marges [Haut, droite, bas, gauche]\n  layers: [\n    { type: \"header\", text: \"Population en 2022\", anchor: \"start\" }, // Titre\n    { type: \"minimap\", x: 30, y: 185, width: 90, projection:\"Polar\" }, // Carte de localisation\n    {\n      id : \"bub\", //  identifiant de la couche\n      type: \"bubble\", // couche de symboles proportionnels\n      geojson: munic2, \n      values: \"POP_2022\", // variable √† cartographier \n      k: 30, // Rayon du plus gros cercle\n      leg_x: 500,\n      leg_y: 130,\n      leg_round: 0,\n      fill: \"red\",\n      fillOpacity:0.5,\n      tooltip: [\"$MUS_NM_MUN\", d => d.properties[\"POP_2022\"]] // infobulle\n    },\n    {geojson: munic2, fill:\"#CCC\"}, // Couche des communes\n  ]\n})\n"},{"methodName":"interpret","cellName":"ojs-cell-17","inline":false,"source":"viewof symbol = Inputs.radio([`bubble`, `square`], { label: `Symbol`,  value: `bubble`})\nviewof rayon = Inputs.range([1, 100], { label: \"Rayon\", step: 2, value: 30 })\ntitle = val == \"AREA\" ? \"Superficie\" : \"Population en 2022\"\nbertin.draw({\n  params: { margin: [-550, 0, 50, 0]},\n  layers: [\n    { type: \"header\", text: title, anchor: \"start\" },\n    { type: \"minimap\", x: 30, y: 185, width: 90, projection:\"Polar\" }, \n    {\n      type: symbol, \n      geojson: munic2, \n      values: \"POP_2022\", \n      k: rayon,\n      leg_x: 500,\n      leg_y: 130,\n      leg_round: 0,\n      fill: \"red\",\n      fillOpacity:0.5,\n      tooltip: [\"$MUS_NM_MUN\", d => d.properties[\"POP_2022\"]] \n    },\n    {geojson: munic2, fill:\"#CCC\"},\n  ]\n})\n"},{"methodName":"interpret","cellName":"ojs-cell-18","inline":false,"source":"viewof val = Inputs.select([\"VIT_ECO\", \"REV_MED\",\t\"TX_2564\", \"TAAM\"], { label: \"Variable\" })\n\nbertin.draw({\n  params: { margin: [-550, 0, 50, 0]},\n  layers: [\n    { type: \"header\", text: title, anchor: \"start\" },\n    { type: \"minimap\", x: 30, y: 185, width: 90, projection:\"Polar\" }, \n    {\n      type: symbol, \n      geojson: munic2, \n      values: \"POP_2020\", \n      k: rayon,\n      leg_x: 500,\n      leg_y: 130,\n      leg_round: 0,\n      fill: { // ICI\n        type: \"choro\",\n        values: val, // ICI\n        colors: \"RdYlBu\",\n        leg_x:680,\n        leg_y:100,\n        leg_round: 0\n        },\n      fillOpacity:0.8,\n      tooltip: [\"$MUS_NM_MUN\", d => d.properties[val]] // ICI\n    },\n    {geojson: munic2, fill:\"#CCC\"},\n  ]\n})\n"},{"methodName":"interpret","cellName":"ojs-cell-19","inline":false,"source":"communes = munic2.features\n  .map((d) => d.properties)\n  .sort((a, b) => d3.descending(a.POP_2022, b.POP_2022))\n  .map((d) => d.MUS_NM_MUN)\n  .slice(0, 20)\n"},{"methodName":"interpret","cellName":"ojs-cell-20","inline":false,"source":"communes\n"},{"methodName":"interpret","cellName":"ojs-cell-21","inline":false,"source":"data = {\n  let arr = [];\n  communes.forEach((d) => {\n    let tmp = munic2.features\n      .map((d) => d.properties)\n      .find((x) => x.MUS_NM_MUN == d);\n    for (let i = 2001; i <= 2022; i++) {\n      arr.push({ year: i, pop: tmp[\"POP_\" + i], com: d });\n    }\n  });\n  return arr;\n}\n"},{"methodName":"interpret","cellName":"ojs-cell-22","inline":false,"source":"data\n"},{"methodName":"interpret","cellName":"ojs-cell-23","inline":false,"source":"viewof commune = Inputs.select(communes, { label: \"Commune\" })\nPlot.plot({\n  grid: true,\n  x: {\n    label: \"Ann√©es ‚Üí\",\n    tickFormat: \"\"\n  },\n  y: {\n    label: `‚Üë Population (${commune})`\n  },\n  color: { legend: true },\n  marginLeft: 60,\n  marks: [\n    Plot.lineY(data.filter(d => d.com == commune), {\n      x: \"year\",\n      y: \"pop\",\n      stroke: \"red\",\n      strokeWidth: 2\n    })\n  ]\n})\n"},{"methodName":"interpretQuiet","source":"shinyInput('x')"},{"methodName":"interpretQuiet","source":"shinyInput('y')"},{"methodName":"interpretQuiet","source":"shinyInput('z')"},{"methodName":"interpretQuiet","source":"shinyInput('color')"},{"methodName":"interpretQuiet","source":"shinyInput('radius')"},{"methodName":"interpretQuiet","source":"shinyInput('position')"},{"methodName":"interpretQuiet","source":"shinyInput('symbol')"},{"methodName":"interpretQuiet","source":"shinyInput('rayon')"},{"methodName":"interpretQuiet","source":"shinyInput('val')"},{"methodName":"interpretQuiet","source":"shinyInput('commune')"}]}
</script>
<script type="module">
window._ojs.paths.runtimeToDoc = "../../..";
window._ojs.paths.runtimeToRoot = "../../..";
window._ojs.paths.docToRoot = "";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb35" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Articulation de diff√©rents langages (R, JavaScript et Python) pour la g√©ovisualisation avec Quarto"</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Atelier Sageo, Qu√©bec, Juin 2023"</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Timoth√©e Giraud, Nicolas Lambert, Matthieu Viry, Ronan Ysebaert (UAR RIATE, CNRS, Universit√© Paris Cit√©)"</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: sandstone</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="co">    fontsize: 0.9em</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 2</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="co">    linkcolor: "#8631ad"</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span><span class="co"> </span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="co">  cache: false</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a><span class="fu">## Observable JavaScript</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a><span class="fu">### Observable Kezako ?</span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>L'<span class="kw">&lt;b&gt;</span>Observable javascript {ojs}<span class="kw">&lt;/b&gt;</span> est un ensemble d'am√©liorations apport√©es √† vanilla JavaScript cr√©√© par Mike Bostock (√©galement auteur de D3). Observable JS se distingue par son ex√©cution r√©active, qui convient particuli√®rement bien √† l'exploration et √† l'analyse interactives des donn√©es.</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a><span class="al">![](fig/d3.png)</span>{width=20%} <span class="al">![](fig/arrow.png)</span>{width=20%} <span class="al">![](fig/observable.png)</span>{width=20%} <span class="kw">&lt;br/&gt;</span></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>**Observable** est aussi une startup fond√©e par Mike Bostock et Melody Meckfessel, qui propose une plateforme 100% en ligne (<span class="co">[</span><span class="ot">https://observablehq.com</span><span class="co">](https://observablehq.com)</span>) pour concevoir, partager et diffuser des visualisations de donn√©es. </span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a><span class="al">![](fig/frise.png)</span></span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>**Observable** c'est donc aussi C‚Äôest aussi une plateforme web qui h√©berge des notebooks computationnels sur la visualisation de donn√©es.</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>üëâ **Objectif** : faire collaborer une communaut√© autour de la visualisation de donn√©es.</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a><span class="fu">### Observable dans Quarto</span></span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>Le runtime d'Observable est Open Source et est utilis√© dans Quarto. </span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>Dans Quarto, toutes les instructions s'√©crivent dans des chunks {ojs}</span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a><span class="in">``` {{ojs}}</span></span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a>On peut param√©trer l'affiche et/ou l'execution du code avec **//| echo** et **//| eval**.</span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a><span class="in">``` {{ojs}}</span></span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a><span class="in">//| echo: false</span></span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a><span class="in">//| eval: true</span></span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a>_NB : Contrairement aux chunks R et Python, le code s'execute *just in time* dans le navigateur web une fois le notebook g√©n√©r√©. Seul l'export html est donc pris en compte._</span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-51"><a href="#cb35-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-52"><a href="#cb35-52" aria-hidden="true" tabindex="-1"></a><span class="fu">### Principes</span></span>
<span id="cb35-53"><a href="#cb35-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-54"><a href="#cb35-54" aria-hidden="true" tabindex="-1"></a>Le langage JavaScript n'a pas du √©t√© con√ßu pour l‚Äôanalyse de donn√©es. Mais, gros point fort, on a tous un navigateur web et JavaScript tourne sur toutes les machines. Le but : b√¢tir une √©volution du langage JavaScript pour en faire un langage adapt√© √† l‚Äôanalyse et la visualisation de donn√©es sur le web. </span>
<span id="cb35-55"><a href="#cb35-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-56"><a href="#cb35-56" aria-hidden="true" tabindex="-1"></a><span class="fu">#### üëâ Des biblioth√®ques pr√©charg√©es üìä</span></span>
<span id="cb35-57"><a href="#cb35-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-58"><a href="#cb35-58" aria-hidden="true" tabindex="-1"></a>OJS c'est du JavaScript + plein de biblioth√®ques pr√© charg√©es : <span class="kw">&lt;br/&gt;</span></span>
<span id="cb35-59"><a href="#cb35-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-60"><a href="#cb35-60" aria-hidden="true" tabindex="-1"></a>| Symbol   | Name              | Version            |</span>
<span id="cb35-61"><a href="#cb35-61" aria-hidden="true" tabindex="-1"></a>|----------|-------------------|--------------------|</span>
<span id="cb35-62"><a href="#cb35-62" aria-hidden="true" tabindex="-1"></a>| <span class="sc">\_</span>       | Lodash            | 4.17.21            |</span>
<span id="cb35-63"><a href="#cb35-63" aria-hidden="true" tabindex="-1"></a>| aq       | Arquero           | \${aq.version}     |</span>
<span id="cb35-64"><a href="#cb35-64" aria-hidden="true" tabindex="-1"></a>| Arrow    | Apache Arrow      | 4.0.1              |</span>
<span id="cb35-65"><a href="#cb35-65" aria-hidden="true" tabindex="-1"></a>| d3       | D3.js             | \${d3.version}     |</span>
<span id="cb35-66"><a href="#cb35-66" aria-hidden="true" tabindex="-1"></a>| dot      | Graphviz          | 0.2.1              |</span>
<span id="cb35-67"><a href="#cb35-67" aria-hidden="true" tabindex="-1"></a>| htl      | Hypertext Literal | \${htl.version}    |</span>
<span id="cb35-68"><a href="#cb35-68" aria-hidden="true" tabindex="-1"></a>| Inputs   | Observable Inputs | \${Inputs.version} |</span>
<span id="cb35-69"><a href="#cb35-69" aria-hidden="true" tabindex="-1"></a>| L        | Leaflet           | \${L.version}      |</span>
<span id="cb35-70"><a href="#cb35-70" aria-hidden="true" tabindex="-1"></a>| mermaid  | Mermaid           | 9.1.6              |</span>
<span id="cb35-71"><a href="#cb35-71" aria-hidden="true" tabindex="-1"></a>| Plot     | Observable Plot   | \${Plot.version}   |</span>
<span id="cb35-72"><a href="#cb35-72" aria-hidden="true" tabindex="-1"></a>| SQLite   | SQL.js            | 1.7.0              |</span>
<span id="cb35-73"><a href="#cb35-73" aria-hidden="true" tabindex="-1"></a>| topojson | TopoJSON Client   | 3.1.0              |</span>
<span id="cb35-74"><a href="#cb35-74" aria-hidden="true" tabindex="-1"></a>| vl       | Vega, Vega-Lite   | 5.22.1, 5.2.0      |</span>
<span id="cb35-75"><a href="#cb35-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-76"><a href="#cb35-76" aria-hidden="true" tabindex="-1"></a><span class="fu">#### üëâ Chaque d√©but de ligne identifie une cellule ojs üôã</span></span>
<span id="cb35-77"><a href="#cb35-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-78"><a href="#cb35-78" aria-hidden="true" tabindex="-1"></a>Chaque ligne d√©finit une variable et une cellule qui doit √™tre unique sur l'ensemble du document.</span>
<span id="cb35-79"><a href="#cb35-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-80"><a href="#cb35-80" aria-hidden="true" tabindex="-1"></a><span class="in">``` {{ojs}}</span></span>
<span id="cb35-81"><a href="#cb35-81" aria-hidden="true" tabindex="-1"></a><span class="in">a = 10 // une cellule</span></span>
<span id="cb35-82"><a href="#cb35-82" aria-hidden="true" tabindex="-1"></a><span class="in">b = 20 // une cellule</span></span>
<span id="cb35-83"><a href="#cb35-83" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-84"><a href="#cb35-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-85"><a href="#cb35-85" aria-hidden="true" tabindex="-1"></a><span class="in">``` {{ojs}}</span></span>
<span id="cb35-86"><a href="#cb35-86" aria-hidden="true" tabindex="-1"></a><span class="in">c = a + b // une cellule</span></span>
<span id="cb35-87"><a href="#cb35-87" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-88"><a href="#cb35-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-89"><a href="#cb35-89" aria-hidden="true" tabindex="-1"></a><span class="in">``` {{ojs}}</span></span>
<span id="cb35-90"><a href="#cb35-90" aria-hidden="true" tabindex="-1"></a><span class="in">d = { </span></span>
<span id="cb35-91"><a href="#cb35-91" aria-hidden="true" tabindex="-1"></a><span class="in">  let a = 10 </span></span>
<span id="cb35-92"><a href="#cb35-92" aria-hidden="true" tabindex="-1"></a><span class="in">  let b = 30</span></span>
<span id="cb35-93"><a href="#cb35-93" aria-hidden="true" tabindex="-1"></a><span class="in">  return a + b </span></span>
<span id="cb35-94"><a href="#cb35-94" aria-hidden="true" tabindex="-1"></a><span class="in">} // Une cellule</span></span>
<span id="cb35-95"><a href="#cb35-95" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-96"><a href="#cb35-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-97"><a href="#cb35-97" aria-hidden="true" tabindex="-1"></a><span class="fu">#### üëâ L‚Äôordre des cellules n‚Äôa pas d‚Äôimportance ü§Ø</span></span>
<span id="cb35-98"><a href="#cb35-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-99"><a href="#cb35-99" aria-hidden="true" tabindex="-1"></a>On peut donc √©crire √ßa</span>
<span id="cb35-100"><a href="#cb35-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-101"><a href="#cb35-101" aria-hidden="true" tabindex="-1"></a><span class="in">``` {{ojs}}</span></span>
<span id="cb35-102"><a href="#cb35-102" aria-hidden="true" tabindex="-1"></a><span class="in">result = val1 * val2</span></span>
<span id="cb35-103"><a href="#cb35-103" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-104"><a href="#cb35-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-105"><a href="#cb35-105" aria-hidden="true" tabindex="-1"></a>avant √ßa</span>
<span id="cb35-106"><a href="#cb35-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-107"><a href="#cb35-107" aria-hidden="true" tabindex="-1"></a><span class="in">``` {{ojs}}</span></span>
<span id="cb35-108"><a href="#cb35-108" aria-hidden="true" tabindex="-1"></a><span class="in">val1 = 10</span></span>
<span id="cb35-109"><a href="#cb35-109" aria-hidden="true" tabindex="-1"></a><span class="in">val2 = 20</span></span>
<span id="cb35-110"><a href="#cb35-110" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-111"><a href="#cb35-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-112"><a href="#cb35-112" aria-hidden="true" tabindex="-1"></a>Le lien entre les cellules se fait de fa√ßon topologique et non de haut en bas. </span>
<span id="cb35-113"><a href="#cb35-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-114"><a href="#cb35-114" aria-hidden="true" tabindex="-1"></a><span class="al">![](fig/topology.png)</span></span>
<span id="cb35-115"><a href="#cb35-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-116"><a href="#cb35-116" aria-hidden="true" tabindex="-1"></a><span class="fu">#### üëâ Tout est r√©actif üî•</span></span>
<span id="cb35-117"><a href="#cb35-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-118"><a href="#cb35-118" aria-hidden="true" tabindex="-1"></a>D√®s lors qu'une cellule est modifi√©e, les cellules qui en d√©pendent sont modifi√©es √©galement.</span>
<span id="cb35-119"><a href="#cb35-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-120"><a href="#cb35-120" aria-hidden="true" tabindex="-1"></a>Pour modifier la valeutr d'une c√©llule, on utilise des **`Inputs`** (des composants propos√©s par OJS pour explorer les donn√©es) avec le mot cl√© **`viewof`**. Voir : https://observablehq.com/@observablehq/inputs</span>
<span id="cb35-121"><a href="#cb35-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-122"><a href="#cb35-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-125"><a href="#cb35-125" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-126"><a href="#cb35-126" aria-hidden="true" tabindex="-1"></a>viewof x <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">255</span>]<span class="op">,</span> {<span class="dt">step</span><span class="op">:</span> <span class="dv">1</span>})</span>
<span id="cb35-127"><a href="#cb35-127" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb35-128"><a href="#cb35-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-131"><a href="#cb35-131" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-132"><a href="#cb35-132" aria-hidden="true" tabindex="-1"></a>viewof y <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">text</span>({<span class="dt">value</span><span class="op">:</span> <span class="dv">30</span>})</span>
<span id="cb35-133"><a href="#cb35-133" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb35-134"><a href="#cb35-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-137"><a href="#cb35-137" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-138"><a href="#cb35-138" aria-hidden="true" tabindex="-1"></a>viewof z <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">radio</span>([<span class="dv">10</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">1000</span>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="dv">10</span>})</span>
<span id="cb35-139"><a href="#cb35-139" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb35-140"><a href="#cb35-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-143"><a href="#cb35-143" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-144"><a href="#cb35-144" aria-hidden="true" tabindex="-1"></a>x <span class="op">*</span> y <span class="op">*</span> z</span>
<span id="cb35-145"><a href="#cb35-145" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb35-146"><a href="#cb35-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-147"><a href="#cb35-147" aria-hidden="true" tabindex="-1"></a><span class="vs">Ce syst√®me est pratique pour modifier des visualisations de donn√©es.</span></span>
<span id="cb35-148"><a href="#cb35-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-149"><a href="#cb35-149" aria-hidden="true" tabindex="-1"></a><span class="vs">Ici, un exemple avec un simple cercle dessin√© en svg.</span></span>
<span id="cb35-150"><a href="#cb35-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-153"><a href="#cb35-153" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-154"><a href="#cb35-154" aria-hidden="true" tabindex="-1"></a>viewof color <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">color</span>({ <span class="dt">label</span><span class="op">:</span> <span class="st">"Couleur"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">"#4ab58c"</span> })</span>
<span id="cb35-155"><a href="#cb35-155" aria-hidden="true" tabindex="-1"></a>viewof radius <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">1</span><span class="op">,</span> <span class="dv">50</span>]<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"Rayon"</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">100</span> })</span>
<span id="cb35-156"><a href="#cb35-156" aria-hidden="true" tabindex="-1"></a>viewof position <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">50</span><span class="op">,</span> <span class="dv">950</span>]<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"Position"</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">50</span> })</span>
<span id="cb35-157"><a href="#cb35-157" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb35-158"><a href="#cb35-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-161"><a href="#cb35-161" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-162"><a href="#cb35-162" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`&lt;svg viewBox="0 0 1000 100" xmlns="http://www.w3.org/2000/svg"&gt;</span></span>
<span id="cb35-163"><a href="#cb35-163" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;circle cx=</span><span class="sc">${</span>position<span class="sc">}</span><span class="vs"> cy="50" r=</span><span class="sc">${</span>radius<span class="sc">}</span><span class="vs"> fill="</span><span class="sc">${</span>color<span class="sc">}</span><span class="vs">"/&gt;</span></span>
<span id="cb35-164"><a href="#cb35-164" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/svg&gt;`</span></span>
<span id="cb35-165"><a href="#cb35-165" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb35-166"><a href="#cb35-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-167"><a href="#cb35-167" aria-hidden="true" tabindex="-1"></a><span class="vs">### l'√©cosyst√®me spatial avec Ojs</span></span>
<span id="cb35-168"><a href="#cb35-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-169"><a href="#cb35-169" aria-hidden="true" tabindex="-1"></a><span class="vs">L'√©cosyst√®me spatial de JavaScript est moins √©toff√© que ce qu'on peut trouver en Python ou en R. Mais on trouve quand m√™me des choses int√©ressantes qui permettent de faire de la g√©omatique directement dans le navigateur web. Voici quelques exemples.</span></span>
<span id="cb35-170"><a href="#cb35-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-171"><a href="#cb35-171" aria-hidden="true" tabindex="-1"></a><span class="vs">**Les fonctionnalit√©s spatiales de `</span>d3<span class="op">.</span><span class="fu">js</span><span class="vs">`**</span></span>
<span id="cb35-172"><a href="#cb35-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-173"><a href="#cb35-173" aria-hidden="true" tabindex="-1"></a><span class="vs">::: columns</span></span>
<span id="cb35-174"><a href="#cb35-174" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="8%"}</span></span>
<span id="cb35-175"><a href="#cb35-175" aria-hidden="true" tabindex="-1"></a><span class="vs">![](fig/d3.png)</span></span>
<span id="cb35-176"><a href="#cb35-176" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb35-177"><a href="#cb35-177" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="2%"}</span></span>
<span id="cb35-178"><a href="#cb35-178" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb35-179"><a href="#cb35-179" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="90%"}</span></span>
<span id="cb35-180"><a href="#cb35-180" aria-hidden="true" tabindex="-1"></a><span class="vs">[**`</span>d3<span class="op">-</span><span class="fu">geo</span><span class="vs">`**](https://github.com/d3/d3-geo) est le module spatial de d3. Il permet de g√©rer les projections cartographiques, les formes sph√©riques et la trigonom√©trie sph√©rique. Voir aussi [**`</span>d3<span class="op">-</span>geo<span class="op">-</span><span class="fu">projection</span><span class="vs">`**](https://github.com/d3/d3-geo-projection). [**`</span>d3<span class="op">-</span><span class="fu">delaunay</span><span class="vs">`**](https://github.com/d3/d3-delaunay) est une biblioth√®que rapide pour calculer le diagramme de Vorono√Ø d'un ensemble de points bidimensionnels. Elle est bas√©e sur Delaunator, une biblioth√®que rapide pour calculer la triangulation de Delaunay en utilisant des algorithmes de balayage. Le diagramme de Vorono√Ø est construit en reliant les circonf√©rences des triangles adjacents dans la triangulation de Delaunay. [**`</span>d3<span class="op">-</span>geo<span class="op">-</span><span class="fu">voronoi</span><span class="vs">`**](https://github.com/Fil/d3-geo-voronoi) est une adaptation de d3-delaunay sur la sph√®re.</span></span>
<span id="cb35-181"><a href="#cb35-181" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb35-182"><a href="#cb35-182" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb35-183"><a href="#cb35-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-184"><a href="#cb35-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-185"><a href="#cb35-185" aria-hidden="true" tabindex="-1"></a><span class="vs">::: columns</span></span>
<span id="cb35-186"><a href="#cb35-186" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="8%"}</span></span>
<span id="cb35-187"><a href="#cb35-187" aria-hidden="true" tabindex="-1"></a><span class="vs">![](fig/topojson.svg)</span></span>
<span id="cb35-188"><a href="#cb35-188" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb35-189"><a href="#cb35-189" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="2%"}</span></span>
<span id="cb35-190"><a href="#cb35-190" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb35-191"><a href="#cb35-191" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="90%"}</span></span>
<span id="cb35-192"><a href="#cb35-192" aria-hidden="true" tabindex="-1"></a><span class="vs">[**`</span><span class="fu">TopoJSON</span><span class="vs">`**](https://github.com/topojson/topojson)  est une extension de GeoJSON. La librairie permet de r√©aliser des op√©rations SIG bas√©es sur la topologie (agr√©gation, voisins, simplification, etc.)</span></span>
<span id="cb35-193"><a href="#cb35-193" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb35-194"><a href="#cb35-194" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb35-195"><a href="#cb35-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-196"><a href="#cb35-196" aria-hidden="true" tabindex="-1"></a><span class="vs">**Les biblioth√®ques SIG**</span></span>
<span id="cb35-197"><a href="#cb35-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-198"><a href="#cb35-198" aria-hidden="true" tabindex="-1"></a><span class="vs">::: columns</span></span>
<span id="cb35-199"><a href="#cb35-199" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="8%"}</span></span>
<span id="cb35-200"><a href="#cb35-200" aria-hidden="true" tabindex="-1"></a><span class="vs">![](fig/turf.png)</span></span>
<span id="cb35-201"><a href="#cb35-201" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb35-202"><a href="#cb35-202" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="2%"}</span></span>
<span id="cb35-203"><a href="#cb35-203" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb35-204"><a href="#cb35-204" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="90%"}</span></span>
<span id="cb35-205"><a href="#cb35-205" aria-hidden="true" tabindex="-1"></a><span class="vs">[**`</span><span class="fu">turf</span><span class="vs">`**](https://turfjs.org/) est une biblioth√®que JavaScript pour l'analyse spatiale (de type SIG). Elle comprend les op√©rations spatiales traditionnelles, des fonctions d'aide pour la cr√©ation de donn√©es GeoJSON, ainsi que des outils de classification des donn√©es et de statistiques. L'avantage de turf est d'√™tre modulaire. On ne charge que ce dont on a besoin.</span></span>
<span id="cb35-206"><a href="#cb35-206" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb35-207"><a href="#cb35-207" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb35-208"><a href="#cb35-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-209"><a href="#cb35-209" aria-hidden="true" tabindex="-1"></a><span class="vs">::: columns</span></span>
<span id="cb35-210"><a href="#cb35-210" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="8%"}</span></span>
<span id="cb35-211"><a href="#cb35-211" aria-hidden="true" tabindex="-1"></a><span class="vs">![](fig/spljs.jpg)</span></span>
<span id="cb35-212"><a href="#cb35-212" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb35-213"><a href="#cb35-213" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="2%"}</span></span>
<span id="cb35-214"><a href="#cb35-214" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb35-215"><a href="#cb35-215" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="90%"}</span></span>
<span id="cb35-216"><a href="#cb35-216" aria-hidden="true" tabindex="-1"></a><span class="vs">[**`</span>spl<span class="op">.</span><span class="fu">js</span><span class="vs">`**](https://turfjs.org/) est une impl√©mentation de SpatiaLite (et de ses amis : sqlite, geos, proj, rttopo) pour le navigateur.</span></span>
<span id="cb35-217"><a href="#cb35-217" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb35-218"><a href="#cb35-218" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb35-219"><a href="#cb35-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-220"><a href="#cb35-220" aria-hidden="true" tabindex="-1"></a><span class="vs">::: columns</span></span>
<span id="cb35-221"><a href="#cb35-221" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="8%"}</span></span>
<span id="cb35-222"><a href="#cb35-222" aria-hidden="true" tabindex="-1"></a><span class="vs">![](fig/geotoolbox.svg)</span></span>
<span id="cb35-223"><a href="#cb35-223" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb35-224"><a href="#cb35-224" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="2%"}</span></span>
<span id="cb35-225"><a href="#cb35-225" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb35-226"><a href="#cb35-226" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="90%"}</span></span>
<span id="cb35-227"><a href="#cb35-227" aria-hidden="true" tabindex="-1"></a><span class="vs">[**`</span><span class="fu">geotoolbox</span><span class="vs">`**](https://github.com/neocarto/geotoolbox) est un outil javascript pour les g√©ographes bas√© sur d3geo, topojson et jsts. Il permet de traiter simplement les propri√©t√©s geojson et fournit plusieurs op√©rations SIG utiles pour la cartographie th√©matique.</span></span>
<span id="cb35-228"><a href="#cb35-228" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb35-229"><a href="#cb35-229" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb35-230"><a href="#cb35-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-231"><a href="#cb35-231" aria-hidden="true" tabindex="-1"></a><span class="vs">::: columns</span></span>
<span id="cb35-232"><a href="#cb35-232" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="8%"}</span></span>
<span id="cb35-233"><a href="#cb35-233" aria-hidden="true" tabindex="-1"></a><span class="vs">![](fig/gdal.png)</span></span>
<span id="cb35-234"><a href="#cb35-234" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb35-235"><a href="#cb35-235" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="2%"}</span></span>
<span id="cb35-236"><a href="#cb35-236" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb35-237"><a href="#cb35-237" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="90%"}</span></span>
<span id="cb35-238"><a href="#cb35-238" aria-hidden="true" tabindex="-1"></a><span class="vs">[**`</span>Gdals3<span class="op">.</span><span class="fu">js</span><span class="vs">`**](https://github.com/bugra9/gdal3.js) est un portage des applications Gdal (gdal_translate, ogr2ogr, gdal_rasterize, gdalwarp, gdaltransform) vers Webassembly. Il permet de convertir des donn√©es g√©ospatiales matricielles et vectorielles dans divers formats et syst√®mes de coordonn√©es.</span></span>
<span id="cb35-239"><a href="#cb35-239" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb35-240"><a href="#cb35-240" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb35-241"><a href="#cb35-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-242"><a href="#cb35-242" aria-hidden="true" tabindex="-1"></a><span class="vs">::: columns</span></span>
<span id="cb35-243"><a href="#cb35-243" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="8%"}</span></span>
<span id="cb35-244"><a href="#cb35-244" aria-hidden="true" tabindex="-1"></a><span class="vs">![](fig/proj4.png)</span></span>
<span id="cb35-245"><a href="#cb35-245" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb35-246"><a href="#cb35-246" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="2%"}</span></span>
<span id="cb35-247"><a href="#cb35-247" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb35-248"><a href="#cb35-248" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="90%"}</span></span>
<span id="cb35-249"><a href="#cb35-249" aria-hidden="true" tabindex="-1"></a><span class="vs">[**`</span><span class="fu">proj4js</span><span class="vs">`**](http://proj4js.org/) est une biblioth√®que JavaScript permettant de transformer les coordonn√©es d'un syst√®me de coordonn√©es √† un autre, y compris les transformations de datum</span></span>
<span id="cb35-250"><a href="#cb35-250" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb35-251"><a href="#cb35-251" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb35-252"><a href="#cb35-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-253"><a href="#cb35-253" aria-hidden="true" tabindex="-1"></a><span class="vs">**Dataviz / cartographie**</span></span>
<span id="cb35-254"><a href="#cb35-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-255"><a href="#cb35-255" aria-hidden="true" tabindex="-1"></a><span class="vs">::: columns</span></span>
<span id="cb35-256"><a href="#cb35-256" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="8%"}</span></span>
<span id="cb35-257"><a href="#cb35-257" aria-hidden="true" tabindex="-1"></a><span class="vs">![](fig/plot.png)</span></span>
<span id="cb35-258"><a href="#cb35-258" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb35-259"><a href="#cb35-259" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="2%"}</span></span>
<span id="cb35-260"><a href="#cb35-260" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb35-261"><a href="#cb35-261" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="90%"}</span></span>
<span id="cb35-262"><a href="#cb35-262" aria-hidden="true" tabindex="-1"></a><span class="vs">[**`</span><span class="fu">plot</span><span class="vs">`**](https://observablehq.com/plot/) est la biblioth√®que de visualisation de donn√©e d√©velopp√©e par Observable (Mike Bostock et Philippe Rivi√®re). Au d√©part pens√©e pour la visualisation de donn√©es statistiques, elle permet aujourd'hui de r√©aliser des cartes. Plot est disponible par d√©faut dans les cellules {ojs}.</span></span>
<span id="cb35-263"><a href="#cb35-263" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb35-264"><a href="#cb35-264" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb35-265"><a href="#cb35-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-266"><a href="#cb35-266" aria-hidden="true" tabindex="-1"></a><span class="vs">::: columns</span></span>
<span id="cb35-267"><a href="#cb35-267" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="8%"}</span></span>
<span id="cb35-268"><a href="#cb35-268" aria-hidden="true" tabindex="-1"></a><span class="vs">![](fig/vega.png)</span></span>
<span id="cb35-269"><a href="#cb35-269" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb35-270"><a href="#cb35-270" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="2%"}</span></span>
<span id="cb35-271"><a href="#cb35-271" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb35-272"><a href="#cb35-272" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="90%"}</span></span>
<span id="cb35-273"><a href="#cb35-273" aria-hidden="true" tabindex="-1"></a><span class="vs">[**`</span>vega<span class="op">-</span><span class="fu">lite</span><span class="vs">`**](https://github.com/vega/vega-lite) est un outil de visualisation mettant en ≈ìuvre une grammaire graphique, similaire √† ggplot2. Cette biblioth√®que est disponible par d√©faut dans les cellules {ojs}.</span></span>
<span id="cb35-274"><a href="#cb35-274" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb35-275"><a href="#cb35-275" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb35-276"><a href="#cb35-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-277"><a href="#cb35-277" aria-hidden="true" tabindex="-1"></a><span class="vs">::: columns</span></span>
<span id="cb35-278"><a href="#cb35-278" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="8%"}</span></span>
<span id="cb35-279"><a href="#cb35-279" aria-hidden="true" tabindex="-1"></a><span class="vs">![](fig/bertin.png)</span></span>
<span id="cb35-280"><a href="#cb35-280" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb35-281"><a href="#cb35-281" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="2%"}</span></span>
<span id="cb35-282"><a href="#cb35-282" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb35-283"><a href="#cb35-283" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="90%"}</span></span>
<span id="cb35-284"><a href="#cb35-284" aria-hidden="true" tabindex="-1"></a><span class="vs">[**`</span><span class="fu">bertin</span><span class="vs">`**](https://github.com/neocarto/bertin) est une biblioth√®que √©crite en JavaScript qui permet de r√©aliser des cartes th√©matiques pour le web. Sa conception vise √† permettre aux utilisateurs de cr√©er rapidement des cartes th√©matiques interactives sans forcement conna√Ætre le langage JavaScript.</span></span>
<span id="cb35-285"><a href="#cb35-285" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb35-286"><a href="#cb35-286" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb35-287"><a href="#cb35-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-288"><a href="#cb35-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-289"><a href="#cb35-289" aria-hidden="true" tabindex="-1"></a><span class="vs">::: columns</span></span>
<span id="cb35-290"><a href="#cb35-290" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="8%"}</span></span>
<span id="cb35-291"><a href="#cb35-291" aria-hidden="true" tabindex="-1"></a><span class="vs">![](fig/gridviz.png)</span></span>
<span id="cb35-292"><a href="#cb35-292" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb35-293"><a href="#cb35-293" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="2%"}</span></span>
<span id="cb35-294"><a href="#cb35-294" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb35-295"><a href="#cb35-295" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="90%"}</span></span>
<span id="cb35-296"><a href="#cb35-296" aria-hidden="true" tabindex="-1"></a><span class="vs">[**`</span><span class="fu">Gridviz</span><span class="vs">`**](https://github.com/eurostat/gridviz) est une biblioth√®que JavaScript bas√©e sur WebGL d√©velopp√©e par Julien Gaffuri et Joe Davies. Elle permet de visualiser des donn√©es carroy√©es (ou tout ensemble de donn√©es tabulaires avec une position x/y) dans le navigateur dans une grande vari√©t√© de styles cartographiques. </span></span>
<span id="cb35-297"><a href="#cb35-297" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb35-298"><a href="#cb35-298" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb35-299"><a href="#cb35-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-300"><a href="#cb35-300" aria-hidden="true" tabindex="-1"></a><span class="vs">::: columns</span></span>
<span id="cb35-301"><a href="#cb35-301" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="8%"}</span></span>
<span id="cb35-302"><a href="#cb35-302" aria-hidden="true" tabindex="-1"></a><span class="vs">![](fig/logo-go-cart-wasm.png)</span></span>
<span id="cb35-303"><a href="#cb35-303" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb35-304"><a href="#cb35-304" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="2%"}</span></span>
<span id="cb35-305"><a href="#cb35-305" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb35-306"><a href="#cb35-306" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="90%"}</span></span>
<span id="cb35-307"><a href="#cb35-307" aria-hidden="true" tabindex="-1"></a><span class="vs">[**`</span>go<span class="op">-</span>cart<span class="op">-</span><span class="fu">wasm</span><span class="vs">`**](https://github.com/riatelab/go-cart-wasm) est une biblioth√®que JS/WASM permettant de r√©aliser des cartogrammes bas√©s sur le flux (comme d√©crit dans "Gastner, Seguy, and More (2018). </span></span>
<span id="cb35-308"><a href="#cb35-308" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb35-309"><a href="#cb35-309" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb35-310"><a href="#cb35-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-311"><a href="#cb35-311" aria-hidden="true" tabindex="-1"></a><span class="vs">### Cartographie interactive avec Observable JavaScript</span></span>
<span id="cb35-312"><a href="#cb35-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-313"><a href="#cb35-313" aria-hidden="true" tabindex="-1"></a><span class="vs">On souhaite √† pr√©sent r√©aliser une carte interactive √† l'√©chelle des municipalit√©s. </span></span>
<span id="cb35-314"><a href="#cb35-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-315"><a href="#cb35-315" aria-hidden="true" tabindex="-1"></a><span class="vs">Tout d'abord, on r√©cp√®re les donn√©es depuis R (**TODO**)</span></span>
<span id="cb35-316"><a href="#cb35-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-319"><a href="#cb35-319" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-320"><a href="#cb35-320" aria-hidden="true" tabindex="-1"></a>munic <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"geom/munic.geojson"</span>)<span class="op">.</span><span class="fu">json</span>()</span>
<span id="cb35-321"><a href="#cb35-321" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb35-322"><a href="#cb35-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-323"><a href="#cb35-323" aria-hidden="true" tabindex="-1"></a><span class="vs">Regardons la table attributaire</span></span>
<span id="cb35-324"><a href="#cb35-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-327"><a href="#cb35-327" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-328"><a href="#cb35-328" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">table</span>(munic<span class="op">.</span><span class="at">features</span><span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">properties</span>))</span>
<span id="cb35-329"><a href="#cb35-329" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb35-330"><a href="#cb35-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-331"><a href="#cb35-331" aria-hidden="true" tabindex="-1"></a><span class="vs">Comme leaflet est disponible dans les cellules {ojs}, on peut directement afficher les g√©om√©tries.</span></span>
<span id="cb35-332"><a href="#cb35-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-335"><a href="#cb35-335" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-336"><a href="#cb35-336" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb35-337"><a href="#cb35-337" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> container <span class="op">=</span> <span class="kw">yield</span> htl<span class="op">.</span><span class="fu">html</span><span class="vs">`&lt;div style="height: 500px;"&gt;`</span><span class="op">;</span></span>
<span id="cb35-338"><a href="#cb35-338" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> map <span class="op">=</span> L<span class="op">.</span><span class="fu">map</span>(container)<span class="op">;</span></span>
<span id="cb35-339"><a href="#cb35-339" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> layer <span class="op">=</span> L<span class="op">.</span><span class="fu">geoJSON</span>(munic)<span class="op">.</span><span class="fu">addTo</span>(map)<span class="op">;</span></span>
<span id="cb35-340"><a href="#cb35-340" aria-hidden="true" tabindex="-1"></a>  map<span class="op">.</span><span class="fu">fitBounds</span>(layer<span class="op">.</span><span class="fu">getBounds</span>()<span class="op">,</span> { <span class="dt">maxZoom</span><span class="op">:</span> <span class="dv">9</span> })<span class="op">;</span></span>
<span id="cb35-341"><a href="#cb35-341" aria-hidden="true" tabindex="-1"></a>  L<span class="op">.</span><span class="fu">tileLayer</span>(<span class="st">"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"</span><span class="op">,</span> {</span>
<span id="cb35-342"><a href="#cb35-342" aria-hidden="true" tabindex="-1"></a>    <span class="dt">attribution</span><span class="op">:</span></span>
<span id="cb35-343"><a href="#cb35-343" aria-hidden="true" tabindex="-1"></a>      <span class="st">"¬© &lt;a href=https://www.openstreetmap.org/copyright&gt;OpenStreetMap&lt;/a&gt; contributors"</span></span>
<span id="cb35-344"><a href="#cb35-344" aria-hidden="true" tabindex="-1"></a>  })<span class="op">.</span><span class="fu">addTo</span>(map)<span class="op">;</span></span>
<span id="cb35-345"><a href="#cb35-345" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-346"><a href="#cb35-346" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb35-347"><a href="#cb35-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-348"><a href="#cb35-348" aria-hidden="true" tabindex="-1"></a><span class="vs">Le fond de carte n'est pas assez simplifi√©. Donc on le simplifie et on le nettoie avec la bibioth√®que **`</span><span class="fu">geotoolbox</span><span class="vs">`**.</span></span>
<span id="cb35-349"><a href="#cb35-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-352"><a href="#cb35-352" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-353"><a href="#cb35-353" aria-hidden="true" tabindex="-1"></a>geo <span class="op">=</span> <span class="pp">require</span>(<span class="st">"geotoolbox"</span>)</span>
<span id="cb35-354"><a href="#cb35-354" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb35-355"><a href="#cb35-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-358"><a href="#cb35-358" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-359"><a href="#cb35-359" aria-hidden="true" tabindex="-1"></a>munic2 <span class="op">=</span> geo<span class="op">.</span><span class="fu">rewind</span>(geo<span class="op">.</span><span class="fu">simplify</span>(munic<span class="op">,</span> { <span class="dt">k</span><span class="op">:</span> <span class="fl">0.02</span> }))</span>
<span id="cb35-360"><a href="#cb35-360" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb35-361"><a href="#cb35-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-362"><a href="#cb35-362" aria-hidden="true" tabindex="-1"></a><span class="vs">**Cr√©ation de cartes th√©matiques**</span></span>
<span id="cb35-363"><a href="#cb35-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-364"><a href="#cb35-364" aria-hidden="true" tabindex="-1"></a><span class="vs">Pour cr√©er des cartes th√©matiques, on peut utiliser la biblioth√®que [**`</span><span class="fu">bertin</span><span class="vs">`**](https://github.com/neocarto/bertin)</span></span>
<span id="cb35-365"><a href="#cb35-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-368"><a href="#cb35-368" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-369"><a href="#cb35-369" aria-hidden="true" tabindex="-1"></a>bertin <span class="op">=</span> <span class="pp">require</span>(<span class="st">"bertin"</span>)</span>
<span id="cb35-370"><a href="#cb35-370" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb35-371"><a href="#cb35-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-372"><a href="#cb35-372" aria-hidden="true" tabindex="-1"></a><span class="vs">La fonction **`</span><span class="fu">draw</span><span class="vs">`** permet de r√©aliser n'importe quel type de carte. </span></span>
<span id="cb35-373"><a href="#cb35-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-374"><a href="#cb35-374" aria-hidden="true" tabindex="-1"></a><span class="vs">![](fig/bertin_code.png)</span></span>
<span id="cb35-375"><a href="#cb35-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-376"><a href="#cb35-376" aria-hidden="true" tabindex="-1"></a><span class="vs">Par d√©faut, la couche s'affiche simplement.</span></span>
<span id="cb35-377"><a href="#cb35-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-380"><a href="#cb35-380" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-381"><a href="#cb35-381" aria-hidden="true" tabindex="-1"></a>bertin<span class="op">.</span><span class="fu">draw</span>({<span class="dt">layers</span><span class="op">:</span>[{<span class="dt">geojson</span><span class="op">:</span> munic2<span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"#d18de0"</span>}]})</span>
<span id="cb35-382"><a href="#cb35-382" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb35-383"><a href="#cb35-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-384"><a href="#cb35-384" aria-hidden="true" tabindex="-1"></a><span class="vs">**Cartographie th√©matique**</span></span>
<span id="cb35-385"><a href="#cb35-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-386"><a href="#cb35-386" aria-hidden="true" tabindex="-1"></a><span class="vs">A pr√©sent, r√©alisons une carte de la population en 2022. Pour cela, on utilise le type **`</span><span class="fu">bubble</span><span class="vs">`**.</span></span>
<span id="cb35-387"><a href="#cb35-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-390"><a href="#cb35-390" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-391"><a href="#cb35-391" aria-hidden="true" tabindex="-1"></a>bertin<span class="op">.</span><span class="fu">draw</span>({</span>
<span id="cb35-392"><a href="#cb35-392" aria-hidden="true" tabindex="-1"></a>  <span class="dt">params</span><span class="op">:</span> { <span class="dt">margin</span><span class="op">:</span> [<span class="op">-</span><span class="dv">550</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">50</span><span class="op">,</span> <span class="dv">0</span>]}<span class="op">,</span> <span class="co">// marges [Haut, droite, bas, gauche]</span></span>
<span id="cb35-393"><a href="#cb35-393" aria-hidden="true" tabindex="-1"></a>  <span class="dt">layers</span><span class="op">:</span> [</span>
<span id="cb35-394"><a href="#cb35-394" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">type</span><span class="op">:</span> <span class="st">"header"</span><span class="op">,</span> <span class="dt">text</span><span class="op">:</span> <span class="st">"Population en 2022"</span><span class="op">,</span> <span class="dt">anchor</span><span class="op">:</span> <span class="st">"start"</span> }<span class="op">,</span> <span class="co">// Titre</span></span>
<span id="cb35-395"><a href="#cb35-395" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">type</span><span class="op">:</span> <span class="st">"minimap"</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="dv">30</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="dv">185</span><span class="op">,</span> <span class="dt">width</span><span class="op">:</span> <span class="dv">90</span><span class="op">,</span> <span class="dt">projection</span><span class="op">:</span><span class="st">"Polar"</span> }<span class="op">,</span> <span class="co">// Carte de localisation</span></span>
<span id="cb35-396"><a href="#cb35-396" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb35-397"><a href="#cb35-397" aria-hidden="true" tabindex="-1"></a>      <span class="dt">id</span> <span class="op">:</span> <span class="st">"bub"</span><span class="op">,</span> <span class="co">//  identifiant de la couche</span></span>
<span id="cb35-398"><a href="#cb35-398" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"bubble"</span><span class="op">,</span> <span class="co">// couche de symboles proportionnels</span></span>
<span id="cb35-399"><a href="#cb35-399" aria-hidden="true" tabindex="-1"></a>      <span class="dt">geojson</span><span class="op">:</span> munic2<span class="op">,</span> </span>
<span id="cb35-400"><a href="#cb35-400" aria-hidden="true" tabindex="-1"></a>      <span class="dt">values</span><span class="op">:</span> <span class="st">"POP_2022"</span><span class="op">,</span> <span class="co">// variable √† cartographier </span></span>
<span id="cb35-401"><a href="#cb35-401" aria-hidden="true" tabindex="-1"></a>      <span class="dt">k</span><span class="op">:</span> <span class="dv">30</span><span class="op">,</span> <span class="co">// Rayon du plus gros cercle</span></span>
<span id="cb35-402"><a href="#cb35-402" aria-hidden="true" tabindex="-1"></a>      <span class="dt">leg_x</span><span class="op">:</span> <span class="dv">500</span><span class="op">,</span></span>
<span id="cb35-403"><a href="#cb35-403" aria-hidden="true" tabindex="-1"></a>      <span class="dt">leg_y</span><span class="op">:</span> <span class="dv">130</span><span class="op">,</span></span>
<span id="cb35-404"><a href="#cb35-404" aria-hidden="true" tabindex="-1"></a>      <span class="dt">leg_round</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb35-405"><a href="#cb35-405" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fill</span><span class="op">:</span> <span class="st">"red"</span><span class="op">,</span></span>
<span id="cb35-406"><a href="#cb35-406" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fillOpacity</span><span class="op">:</span><span class="fl">0.5</span><span class="op">,</span></span>
<span id="cb35-407"><a href="#cb35-407" aria-hidden="true" tabindex="-1"></a>      <span class="dt">tooltip</span><span class="op">:</span> [<span class="st">"$MUS_NM_MUN"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">properties</span>[<span class="st">"POP_2022"</span>]] <span class="co">// infobulle</span></span>
<span id="cb35-408"><a href="#cb35-408" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb35-409"><a href="#cb35-409" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">geojson</span><span class="op">:</span> munic2<span class="op">,</span> <span class="dt">fill</span><span class="op">:</span><span class="st">"#CCC"</span>}<span class="op">,</span> <span class="co">// Couche des communes</span></span>
<span id="cb35-410"><a href="#cb35-410" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb35-411"><a href="#cb35-411" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb35-412"><a href="#cb35-412" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb35-413"><a href="#cb35-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-414"><a href="#cb35-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-415"><a href="#cb35-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-416"><a href="#cb35-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-417"><a href="#cb35-417" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.callout-caution}</span></span>
<span id="cb35-418"><a href="#cb35-418" aria-hidden="true" tabindex="-1"></a><span class="vs">## A vous de jouer - Rendez la carte interactive avec {ojs}</span></span>
<span id="cb35-419"><a href="#cb35-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-420"><a href="#cb35-420" aria-hidden="true" tabindex="-1"></a><span class="vs">Pour rendre la carte interactive, vous avez pouvez proposer des `</span><span class="fu">Inputs</span><span class="vs">` pour interagir avec l'utilisateur.</span></span>
<span id="cb35-421"><a href="#cb35-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-422"><a href="#cb35-422" aria-hidden="true" tabindex="-1"></a><span class="vs">Ajoutez un Input de type `</span><span class="fu">radio</span><span class="vs">` pour d√©finir la symbologie : [**`</span><span class="fu">bubble</span><span class="vs">`**](https://github.com/neocarto/bertin#bubble), [**`</span><span class="fu">square</span><span class="vs">`**](https://github.com/neocarto/bertin#square) et [**`</span><span class="fu">spikes</span><span class="vs">`**](https://github.com/neocarto/bertin#spikes)</span></span>
<span id="cb35-423"><a href="#cb35-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-424"><a href="#cb35-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-425"><a href="#cb35-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-426"><a href="#cb35-426" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span>js</span>
<span id="cb35-427"><a href="#cb35-427" aria-hidden="true" tabindex="-1"></a>viewof symbol <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">radio</span>([<span class="vs">`a`</span><span class="op">,</span> <span class="vs">`b`</span><span class="op">,</span> <span class="vs">`c`</span>]<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="vs">`label`</span><span class="op">,</span>  <span class="dt">value</span><span class="op">:</span> <span class="vs">`valeur par d√©faut`</span>})</span>
<span id="cb35-428"><a href="#cb35-428" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb35-429"><a href="#cb35-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-430"><a href="#cb35-430" aria-hidden="true" tabindex="-1"></a><span class="vs">Cr√©ez un slider pouyr faire varier la taille des symboles</span></span>
<span id="cb35-431"><a href="#cb35-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-432"><a href="#cb35-432" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span>js</span>
<span id="cb35-433"><a href="#cb35-433" aria-hidden="true" tabindex="-1"></a>viewof rayon <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="vs">`min`</span><span class="op">,</span> <span class="vs">`max`</span>]<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"label"</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">30</span> })</span>
<span id="cb35-434"><a href="#cb35-434" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb35-435"><a href="#cb35-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-436"><a href="#cb35-436" aria-hidden="true" tabindex="-1"></a><span class="vs">Modifiez la carte pr√©c√©dente pour prendre en compte ces valeurs.</span></span>
<span id="cb35-437"><a href="#cb35-437" aria-hidden="true" tabindex="-1"></a><span class="vs"> </span></span>
<span id="cb35-438"><a href="#cb35-438" aria-hidden="true" tabindex="-1"></a><span class="vs">Utilisez `</span><span class="co">//| echo: false` pour masquer le code.</span></span>
<span id="cb35-439"><a href="#cb35-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-440"><a href="#cb35-440" aria-hidden="true" tabindex="-1"></a>Pour en savoir plus sur <span class="fu">les</span> <span class="vs">`inputs`</span><span class="op">,</span> voir <span class="op">:</span> [@observablehq<span class="op">/</span>inputs](https<span class="op">:</span><span class="co">//observablehq.com/@observablehq/inputs)</span></span>
<span id="cb35-441"><a href="#cb35-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-442"><a href="#cb35-442" aria-hidden="true" tabindex="-1"></a><span class="op">:::</span></span>
<span id="cb35-443"><a href="#cb35-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-444"><a href="#cb35-444" aria-hidden="true" tabindex="-1"></a><span class="op">:::</span> {<span class="op">.</span><span class="at">callout</span><span class="op">-</span>tip collapse<span class="op">=</span><span class="st">"true"</span>}</span>
<span id="cb35-445"><a href="#cb35-445" aria-hidden="true" tabindex="-1"></a>## Solution</span>
<span id="cb35-446"><a href="#cb35-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-447"><a href="#cb35-447" aria-hidden="true" tabindex="-1"></a>Les Inputs</span>
<span id="cb35-448"><a href="#cb35-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-451"><a href="#cb35-451" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-452"><a href="#cb35-452" aria-hidden="true" tabindex="-1"></a><span class="vs">//| echo: true</span></span>
<span id="cb35-453"><a href="#cb35-453" aria-hidden="true" tabindex="-1"></a><span class="vs">//| eval: false</span></span>
<span id="cb35-454"><a href="#cb35-454" aria-hidden="true" tabindex="-1"></a><span class="vs">viewof symbol = Inputs.radio([`</span><span class="fu">bubble</span><span class="vs">`, `</span><span class="fu">square</span><span class="vs">`], { label: `</span><span class="fu">Symbol</span><span class="vs">`,  value: `</span><span class="fu">bubble</span><span class="vs">`})</span></span>
<span id="cb35-455"><a href="#cb35-455" aria-hidden="true" tabindex="-1"></a><span class="vs">viewof rayon = Inputs.range([1, 100], { label: "Rayon", step: 2, value: 30 })</span></span>
<span id="cb35-456"><a href="#cb35-456" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb35-457"><a href="#cb35-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-458"><a href="#cb35-458" aria-hidden="true" tabindex="-1"></a>Et la carte</span>
<span id="cb35-459"><a href="#cb35-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-462"><a href="#cb35-462" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-463"><a href="#cb35-463" aria-hidden="true" tabindex="-1"></a><span class="vs">//| echo: true</span></span>
<span id="cb35-464"><a href="#cb35-464" aria-hidden="true" tabindex="-1"></a><span class="vs">//| eval: false</span></span>
<span id="cb35-465"><a href="#cb35-465" aria-hidden="true" tabindex="-1"></a><span class="vs">bertin.draw({</span></span>
<span id="cb35-466"><a href="#cb35-466" aria-hidden="true" tabindex="-1"></a><span class="vs">  params: { margin: [-550, 0, 50, 0]},</span></span>
<span id="cb35-467"><a href="#cb35-467" aria-hidden="true" tabindex="-1"></a><span class="vs">  layers: [</span></span>
<span id="cb35-468"><a href="#cb35-468" aria-hidden="true" tabindex="-1"></a><span class="vs">    { type: "header", text: title, anchor: "start" }, // ICI</span></span>
<span id="cb35-469"><a href="#cb35-469" aria-hidden="true" tabindex="-1"></a><span class="vs">    { type: "minimap", x: 30, y: 185, width: 90, projection:"Polar" }, </span></span>
<span id="cb35-470"><a href="#cb35-470" aria-hidden="true" tabindex="-1"></a><span class="vs">    {</span></span>
<span id="cb35-471"><a href="#cb35-471" aria-hidden="true" tabindex="-1"></a><span class="vs">      type: symbol, // ICI </span></span>
<span id="cb35-472"><a href="#cb35-472" aria-hidden="true" tabindex="-1"></a><span class="vs">      geojson: munic2, </span></span>
<span id="cb35-473"><a href="#cb35-473" aria-hidden="true" tabindex="-1"></a><span class="vs">      values: "POP_2022", </span></span>
<span id="cb35-474"><a href="#cb35-474" aria-hidden="true" tabindex="-1"></a><span class="vs">      k: rayon, // ICI</span></span>
<span id="cb35-475"><a href="#cb35-475" aria-hidden="true" tabindex="-1"></a><span class="vs">      leg_x: 500,</span></span>
<span id="cb35-476"><a href="#cb35-476" aria-hidden="true" tabindex="-1"></a><span class="vs">      leg_y: 130,</span></span>
<span id="cb35-477"><a href="#cb35-477" aria-hidden="true" tabindex="-1"></a><span class="vs">      leg_round: 0,</span></span>
<span id="cb35-478"><a href="#cb35-478" aria-hidden="true" tabindex="-1"></a><span class="vs">      fill: "red",</span></span>
<span id="cb35-479"><a href="#cb35-479" aria-hidden="true" tabindex="-1"></a><span class="vs">      fillOpacity:0.5,</span></span>
<span id="cb35-480"><a href="#cb35-480" aria-hidden="true" tabindex="-1"></a><span class="vs">      tooltip: ["$MUS_NM_MUN", d =&gt; d.properties["POP_2022"]] </span></span>
<span id="cb35-481"><a href="#cb35-481" aria-hidden="true" tabindex="-1"></a><span class="vs">    },</span></span>
<span id="cb35-482"><a href="#cb35-482" aria-hidden="true" tabindex="-1"></a><span class="vs">    {geojson: munic2, fill:"#CCC"},</span></span>
<span id="cb35-483"><a href="#cb35-483" aria-hidden="true" tabindex="-1"></a><span class="vs">  ]</span></span>
<span id="cb35-484"><a href="#cb35-484" aria-hidden="true" tabindex="-1"></a><span class="vs">})</span></span>
<span id="cb35-485"><a href="#cb35-485" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb35-486"><a href="#cb35-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-489"><a href="#cb35-489" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-490"><a href="#cb35-490" aria-hidden="true" tabindex="-1"></a><span class="vs">//| echo: false</span></span>
<span id="cb35-491"><a href="#cb35-491" aria-hidden="true" tabindex="-1"></a><span class="vs">//| eval: true</span></span>
<span id="cb35-492"><a href="#cb35-492" aria-hidden="true" tabindex="-1"></a><span class="vs">viewof symbol = Inputs.radio([`</span><span class="fu">bubble</span><span class="vs">`, `</span><span class="fu">square</span><span class="vs">`], { label: `</span><span class="fu">Symbol</span><span class="vs">`,  value: `</span><span class="fu">bubble</span><span class="vs">`})</span></span>
<span id="cb35-493"><a href="#cb35-493" aria-hidden="true" tabindex="-1"></a><span class="vs">viewof rayon = Inputs.range([1, 100], { label: "Rayon", step: 2, value: 30 })</span></span>
<span id="cb35-494"><a href="#cb35-494" aria-hidden="true" tabindex="-1"></a><span class="vs">title = val == "AREA" ? "Superficie" : "Population en 2022"</span></span>
<span id="cb35-495"><a href="#cb35-495" aria-hidden="true" tabindex="-1"></a><span class="vs">bertin.draw({</span></span>
<span id="cb35-496"><a href="#cb35-496" aria-hidden="true" tabindex="-1"></a><span class="vs">  params: { margin: [-550, 0, 50, 0]},</span></span>
<span id="cb35-497"><a href="#cb35-497" aria-hidden="true" tabindex="-1"></a><span class="vs">  layers: [</span></span>
<span id="cb35-498"><a href="#cb35-498" aria-hidden="true" tabindex="-1"></a><span class="vs">    { type: "header", text: title, anchor: "start" },</span></span>
<span id="cb35-499"><a href="#cb35-499" aria-hidden="true" tabindex="-1"></a><span class="vs">    { type: "minimap", x: 30, y: 185, width: 90, projection:"Polar" }, </span></span>
<span id="cb35-500"><a href="#cb35-500" aria-hidden="true" tabindex="-1"></a><span class="vs">    {</span></span>
<span id="cb35-501"><a href="#cb35-501" aria-hidden="true" tabindex="-1"></a><span class="vs">      type: symbol, </span></span>
<span id="cb35-502"><a href="#cb35-502" aria-hidden="true" tabindex="-1"></a><span class="vs">      geojson: munic2, </span></span>
<span id="cb35-503"><a href="#cb35-503" aria-hidden="true" tabindex="-1"></a><span class="vs">      values: "POP_2022", </span></span>
<span id="cb35-504"><a href="#cb35-504" aria-hidden="true" tabindex="-1"></a><span class="vs">      k: rayon,</span></span>
<span id="cb35-505"><a href="#cb35-505" aria-hidden="true" tabindex="-1"></a><span class="vs">      leg_x: 500,</span></span>
<span id="cb35-506"><a href="#cb35-506" aria-hidden="true" tabindex="-1"></a><span class="vs">      leg_y: 130,</span></span>
<span id="cb35-507"><a href="#cb35-507" aria-hidden="true" tabindex="-1"></a><span class="vs">      leg_round: 0,</span></span>
<span id="cb35-508"><a href="#cb35-508" aria-hidden="true" tabindex="-1"></a><span class="vs">      fill: "red",</span></span>
<span id="cb35-509"><a href="#cb35-509" aria-hidden="true" tabindex="-1"></a><span class="vs">      fillOpacity:0.5,</span></span>
<span id="cb35-510"><a href="#cb35-510" aria-hidden="true" tabindex="-1"></a><span class="vs">      tooltip: ["$MUS_NM_MUN", d =&gt; d.properties["POP_2022"]] </span></span>
<span id="cb35-511"><a href="#cb35-511" aria-hidden="true" tabindex="-1"></a><span class="vs">    },</span></span>
<span id="cb35-512"><a href="#cb35-512" aria-hidden="true" tabindex="-1"></a><span class="vs">    {geojson: munic2, fill:"#CCC"},</span></span>
<span id="cb35-513"><a href="#cb35-513" aria-hidden="true" tabindex="-1"></a><span class="vs">  ]</span></span>
<span id="cb35-514"><a href="#cb35-514" aria-hidden="true" tabindex="-1"></a><span class="vs">})</span></span>
<span id="cb35-515"><a href="#cb35-515" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb35-516"><a href="#cb35-516" aria-hidden="true" tabindex="-1"></a><span class="op">:::</span></span>
<span id="cb35-517"><a href="#cb35-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-518"><a href="#cb35-518" aria-hidden="true" tabindex="-1"></a>A pr√©sent<span class="op">,</span> on souhaite colorier les cercles en fonction de l<span class="st">'indice de vitalit√© √©conomique. </span></span>
<span id="cb35-519"><a href="#cb35-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-520"><a href="#cb35-520" aria-hidden="true" tabindex="-1"></a><span class="op">:::</span> {<span class="op">.</span><span class="at">callout</span><span class="op">-</span>caution}</span>
<span id="cb35-521"><a href="#cb35-521" aria-hidden="true" tabindex="-1"></a>## A vous de jouer</span>
<span id="cb35-522"><a href="#cb35-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-523"><a href="#cb35-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-524"><a href="#cb35-524" aria-hidden="true" tabindex="-1"></a>Proposer la variable √† cartographier via une liste d√©roulante<span class="op">.</span></span>
<span id="cb35-525"><a href="#cb35-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-526"><a href="#cb35-526" aria-hidden="true" tabindex="-1"></a><span class="vs">```js</span></span>
<span id="cb35-527"><a href="#cb35-527" aria-hidden="true" tabindex="-1"></a><span class="vs">viewof val = Inputs.select(["A", "B"], {label: "Select one"})</span></span>
<span id="cb35-528"><a href="#cb35-528" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb35-529"><a href="#cb35-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-530"><a href="#cb35-530" aria-hidden="true" tabindex="-1"></a>Pour faire des variations de <span class="fu">couleurs</span> (i<span class="op">.</span><span class="at">e</span><span class="op">.</span> <span class="at">valeur</span>)<span class="op">,</span> on utilise le type <span class="op">**</span><span class="vs">`choro`</span><span class="op">**</span> √† l<span class="st">'int√©rieur de l'</span>attribut <span class="op">**</span><span class="vs">`fill`</span><span class="op">**</span> de la couche √† colorier<span class="op">.</span> <span class="at">Ici</span><span class="op">,</span> les cercles proportionnels<span class="op">.</span></span>
<span id="cb35-531"><a href="#cb35-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-532"><a href="#cb35-532" aria-hidden="true" tabindex="-1"></a><span class="vs">```js</span></span>
<span id="cb35-533"><a href="#cb35-533" aria-hidden="true" tabindex="-1"></a><span class="vs">fill : {type "choro", values: `</span>votre <span class="fu">variable</span><span class="vs">`, colors: "RdYlBu"}</span></span>
<span id="cb35-534"><a href="#cb35-534" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb35-535"><a href="#cb35-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-536"><a href="#cb35-536" aria-hidden="true" tabindex="-1"></a>Pour param√©trer<span class="op">,</span> voir <span class="op">:</span> [bertin#choropleth](https<span class="op">:</span><span class="co">//github.com/neocarto/bertin#choropleth) &amp; [bertin-js-chropoleth](https://observablehq.com/@neocartocnrs/bertin-js-chropoleth?collection=@neocartocnrs/bertin)</span></span>
<span id="cb35-537"><a href="#cb35-537" aria-hidden="true" tabindex="-1"></a><span class="op">:::</span></span>
<span id="cb35-538"><a href="#cb35-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-539"><a href="#cb35-539" aria-hidden="true" tabindex="-1"></a><span class="op">:::</span> {<span class="op">.</span><span class="at">callout</span><span class="op">-</span>tip collapse<span class="op">=</span><span class="st">"true"</span>}</span>
<span id="cb35-540"><a href="#cb35-540" aria-hidden="true" tabindex="-1"></a>## Solution</span>
<span id="cb35-541"><a href="#cb35-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-542"><a href="#cb35-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-545"><a href="#cb35-545" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-546"><a href="#cb35-546" aria-hidden="true" tabindex="-1"></a><span class="vs">viewof val = Inputs.select(["VIT_ECO", "REV_MED",   "TX_2564", "TAAM"], { label: "Variable" })</span></span>
<span id="cb35-547"><a href="#cb35-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-548"><a href="#cb35-548" aria-hidden="true" tabindex="-1"></a><span class="vs">bertin.draw({</span></span>
<span id="cb35-549"><a href="#cb35-549" aria-hidden="true" tabindex="-1"></a><span class="vs">  params: { margin: [-550, 0, 50, 0]},</span></span>
<span id="cb35-550"><a href="#cb35-550" aria-hidden="true" tabindex="-1"></a><span class="vs">  layers: [</span></span>
<span id="cb35-551"><a href="#cb35-551" aria-hidden="true" tabindex="-1"></a><span class="vs">    { type: "header", text: title, anchor: "start" },</span></span>
<span id="cb35-552"><a href="#cb35-552" aria-hidden="true" tabindex="-1"></a><span class="vs">    { type: "minimap", x: 30, y: 185, width: 90, projection:"Polar" }, </span></span>
<span id="cb35-553"><a href="#cb35-553" aria-hidden="true" tabindex="-1"></a><span class="vs">    {</span></span>
<span id="cb35-554"><a href="#cb35-554" aria-hidden="true" tabindex="-1"></a><span class="vs">      type: symbol, </span></span>
<span id="cb35-555"><a href="#cb35-555" aria-hidden="true" tabindex="-1"></a><span class="vs">      geojson: munic2, </span></span>
<span id="cb35-556"><a href="#cb35-556" aria-hidden="true" tabindex="-1"></a><span class="vs">      values: "POP_2020", </span></span>
<span id="cb35-557"><a href="#cb35-557" aria-hidden="true" tabindex="-1"></a><span class="vs">      k: rayon,</span></span>
<span id="cb35-558"><a href="#cb35-558" aria-hidden="true" tabindex="-1"></a><span class="vs">      leg_x: 500,</span></span>
<span id="cb35-559"><a href="#cb35-559" aria-hidden="true" tabindex="-1"></a><span class="vs">      leg_y: 130,</span></span>
<span id="cb35-560"><a href="#cb35-560" aria-hidden="true" tabindex="-1"></a><span class="vs">      leg_round: 0,</span></span>
<span id="cb35-561"><a href="#cb35-561" aria-hidden="true" tabindex="-1"></a><span class="vs">      fill: { // ICI</span></span>
<span id="cb35-562"><a href="#cb35-562" aria-hidden="true" tabindex="-1"></a><span class="vs">        type: "choro",</span></span>
<span id="cb35-563"><a href="#cb35-563" aria-hidden="true" tabindex="-1"></a><span class="vs">        values: val, // ICI</span></span>
<span id="cb35-564"><a href="#cb35-564" aria-hidden="true" tabindex="-1"></a><span class="vs">        colors: "RdYlBu",</span></span>
<span id="cb35-565"><a href="#cb35-565" aria-hidden="true" tabindex="-1"></a><span class="vs">        leg_x:680,</span></span>
<span id="cb35-566"><a href="#cb35-566" aria-hidden="true" tabindex="-1"></a><span class="vs">        leg_y:100,</span></span>
<span id="cb35-567"><a href="#cb35-567" aria-hidden="true" tabindex="-1"></a><span class="vs">        leg_round: 0</span></span>
<span id="cb35-568"><a href="#cb35-568" aria-hidden="true" tabindex="-1"></a><span class="vs">        },</span></span>
<span id="cb35-569"><a href="#cb35-569" aria-hidden="true" tabindex="-1"></a><span class="vs">      fillOpacity:0.8,</span></span>
<span id="cb35-570"><a href="#cb35-570" aria-hidden="true" tabindex="-1"></a><span class="vs">      tooltip: ["$MUS_NM_MUN", d =&gt; d.properties[val]] // ICI</span></span>
<span id="cb35-571"><a href="#cb35-571" aria-hidden="true" tabindex="-1"></a><span class="vs">    },</span></span>
<span id="cb35-572"><a href="#cb35-572" aria-hidden="true" tabindex="-1"></a><span class="vs">    {geojson: munic2, fill:"#CCC"},</span></span>
<span id="cb35-573"><a href="#cb35-573" aria-hidden="true" tabindex="-1"></a><span class="vs">  ]</span></span>
<span id="cb35-574"><a href="#cb35-574" aria-hidden="true" tabindex="-1"></a><span class="vs">})</span></span>
<span id="cb35-575"><a href="#cb35-575" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb35-576"><a href="#cb35-576" aria-hidden="true" tabindex="-1"></a><span class="op">:::</span></span>
<span id="cb35-577"><a href="#cb35-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-578"><a href="#cb35-578" aria-hidden="true" tabindex="-1"></a><span class="op">**</span>Cr√©ation de graphiques<span class="op">**</span></span>
<span id="cb35-579"><a href="#cb35-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-580"><a href="#cb35-580" aria-hidden="true" tabindex="-1"></a>Avec <span class="op">**</span><span class="vs">`{ojs}`</span><span class="op">**,</span> on va aussi pouvoir faire des graphiques avec la biblioth√®que <span class="op">**</span><span class="vs">`plot`</span><span class="op">**.</span></span>
<span id="cb35-581"><a href="#cb35-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-582"><a href="#cb35-582" aria-hidden="true" tabindex="-1"></a>Tout d<span class="st">'abord, on r√©cup√®re les noms des 20 communes les plus peupl√©es, class√©es par ordre d√©croissant de population.</span></span>
<span id="cb35-583"><a href="#cb35-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-586"><a href="#cb35-586" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-587"><a href="#cb35-587" aria-hidden="true" tabindex="-1"></a><span class="vs">communes = munic2.features</span></span>
<span id="cb35-588"><a href="#cb35-588" aria-hidden="true" tabindex="-1"></a><span class="vs">  .map((d) =&gt; d.properties)</span></span>
<span id="cb35-589"><a href="#cb35-589" aria-hidden="true" tabindex="-1"></a><span class="vs">  .sort((a, b) =&gt; d3.descending(a.POP_2022, b.POP_2022))</span></span>
<span id="cb35-590"><a href="#cb35-590" aria-hidden="true" tabindex="-1"></a><span class="vs">  .map((d) =&gt; d.MUS_NM_MUN)</span></span>
<span id="cb35-591"><a href="#cb35-591" aria-hidden="true" tabindex="-1"></a><span class="vs">  .slice(0, 20)</span></span>
<span id="cb35-592"><a href="#cb35-592" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb35-593"><a href="#cb35-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-596"><a href="#cb35-596" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-597"><a href="#cb35-597" aria-hidden="true" tabindex="-1"></a><span class="vs">//| echo: false</span></span>
<span id="cb35-598"><a href="#cb35-598" aria-hidden="true" tabindex="-1"></a><span class="vs">//| eval: true</span></span>
<span id="cb35-599"><a href="#cb35-599" aria-hidden="true" tabindex="-1"></a><span class="vs">communes</span></span>
<span id="cb35-600"><a href="#cb35-600" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb35-601"><a href="#cb35-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-602"><a href="#cb35-602" aria-hidden="true" tabindex="-1"></a>On met en forme les donn√©es<span class="op">.</span> </span>
<span id="cb35-603"><a href="#cb35-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-606"><a href="#cb35-606" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-607"><a href="#cb35-607" aria-hidden="true" tabindex="-1"></a><span class="vs">data = {</span></span>
<span id="cb35-608"><a href="#cb35-608" aria-hidden="true" tabindex="-1"></a><span class="vs">  let arr = [];</span></span>
<span id="cb35-609"><a href="#cb35-609" aria-hidden="true" tabindex="-1"></a><span class="vs">  communes.forEach((d) =&gt; {</span></span>
<span id="cb35-610"><a href="#cb35-610" aria-hidden="true" tabindex="-1"></a><span class="vs">    let tmp = munic2.features</span></span>
<span id="cb35-611"><a href="#cb35-611" aria-hidden="true" tabindex="-1"></a><span class="vs">      .map((d) =&gt; d.properties)</span></span>
<span id="cb35-612"><a href="#cb35-612" aria-hidden="true" tabindex="-1"></a><span class="vs">      .find((x) =&gt; x.MUS_NM_MUN == d);</span></span>
<span id="cb35-613"><a href="#cb35-613" aria-hidden="true" tabindex="-1"></a><span class="vs">    for (let i = 2001; i &lt;= 2022; i++) {</span></span>
<span id="cb35-614"><a href="#cb35-614" aria-hidden="true" tabindex="-1"></a><span class="vs">      arr.push({ year: i, pop: tmp["POP_" + i], com: d });</span></span>
<span id="cb35-615"><a href="#cb35-615" aria-hidden="true" tabindex="-1"></a><span class="vs">    }</span></span>
<span id="cb35-616"><a href="#cb35-616" aria-hidden="true" tabindex="-1"></a><span class="vs">  });</span></span>
<span id="cb35-617"><a href="#cb35-617" aria-hidden="true" tabindex="-1"></a><span class="vs">  return arr;</span></span>
<span id="cb35-618"><a href="#cb35-618" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb35-619"><a href="#cb35-619" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb35-620"><a href="#cb35-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-623"><a href="#cb35-623" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-624"><a href="#cb35-624" aria-hidden="true" tabindex="-1"></a><span class="vs">//| echo: false</span></span>
<span id="cb35-625"><a href="#cb35-625" aria-hidden="true" tabindex="-1"></a><span class="vs">//| eval: true</span></span>
<span id="cb35-626"><a href="#cb35-626" aria-hidden="true" tabindex="-1"></a><span class="vs">data</span></span>
<span id="cb35-627"><a href="#cb35-627" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb35-628"><a href="#cb35-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-629"><a href="#cb35-629" aria-hidden="true" tabindex="-1"></a>Puis on r√©alise le graphique <span class="fu">avec</span> <span class="vs">`plot`</span> en proposant de s√©lectionner une commune<span class="op">.</span></span>
<span id="cb35-630"><a href="#cb35-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-633"><a href="#cb35-633" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-634"><a href="#cb35-634" aria-hidden="true" tabindex="-1"></a><span class="vs">viewof commune = Inputs.select(communes, { label: "Commune" })</span></span>
<span id="cb35-635"><a href="#cb35-635" aria-hidden="true" tabindex="-1"></a><span class="vs">Plot.plot({</span></span>
<span id="cb35-636"><a href="#cb35-636" aria-hidden="true" tabindex="-1"></a><span class="vs">  grid: true,</span></span>
<span id="cb35-637"><a href="#cb35-637" aria-hidden="true" tabindex="-1"></a><span class="vs">  x: {</span></span>
<span id="cb35-638"><a href="#cb35-638" aria-hidden="true" tabindex="-1"></a><span class="vs">    label: "Ann√©es ‚Üí",</span></span>
<span id="cb35-639"><a href="#cb35-639" aria-hidden="true" tabindex="-1"></a><span class="vs">    tickFormat: ""</span></span>
<span id="cb35-640"><a href="#cb35-640" aria-hidden="true" tabindex="-1"></a><span class="vs">  },</span></span>
<span id="cb35-641"><a href="#cb35-641" aria-hidden="true" tabindex="-1"></a><span class="vs">  y: {</span></span>
<span id="cb35-642"><a href="#cb35-642" aria-hidden="true" tabindex="-1"></a><span class="vs">    label: `</span>‚Üë <span class="fu">Population</span> (${commune})<span class="vs">`</span></span>
<span id="cb35-643"><a href="#cb35-643" aria-hidden="true" tabindex="-1"></a><span class="vs">  },</span></span>
<span id="cb35-644"><a href="#cb35-644" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: { legend: true },</span></span>
<span id="cb35-645"><a href="#cb35-645" aria-hidden="true" tabindex="-1"></a><span class="vs">  marginLeft: 60,</span></span>
<span id="cb35-646"><a href="#cb35-646" aria-hidden="true" tabindex="-1"></a><span class="vs">  marks: [</span></span>
<span id="cb35-647"><a href="#cb35-647" aria-hidden="true" tabindex="-1"></a><span class="vs">    Plot.lineY(data.filter(d =&gt; d.com == commune), {</span></span>
<span id="cb35-648"><a href="#cb35-648" aria-hidden="true" tabindex="-1"></a><span class="vs">      x: "year",</span></span>
<span id="cb35-649"><a href="#cb35-649" aria-hidden="true" tabindex="-1"></a><span class="vs">      y: "pop",</span></span>
<span id="cb35-650"><a href="#cb35-650" aria-hidden="true" tabindex="-1"></a><span class="vs">      stroke: "red",</span></span>
<span id="cb35-651"><a href="#cb35-651" aria-hidden="true" tabindex="-1"></a><span class="vs">      strokeWidth: 2</span></span>
<span id="cb35-652"><a href="#cb35-652" aria-hidden="true" tabindex="-1"></a><span class="vs">    })</span></span>
<span id="cb35-653"><a href="#cb35-653" aria-hidden="true" tabindex="-1"></a><span class="vs">  ]</span></span>
<span id="cb35-654"><a href="#cb35-654" aria-hidden="true" tabindex="-1"></a><span class="vs">})</span></span>
<span id="cb35-655"><a href="#cb35-655" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb35-656"><a href="#cb35-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-657"><a href="#cb35-657" aria-hidden="true" tabindex="-1"></a><span class="op">**</span>Cartographie de donn√©es raster<span class="op">**</span></span>
<span id="cb35-658"><a href="#cb35-658" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>