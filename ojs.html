<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Timoth√©e Giraud, Nicolas Lambert, Matthieu Viry, Ronan Ysebaert (UAR RIATE, CNRS, Universit√© Paris Cit√©)">

<title>Articulation de diff√©rents langages (R, JavaScript et Python) pour la g√©ovisualisation avec Quarto</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="ojs_files/libs/clipboard/clipboard.min.js"></script>
<script src="ojs_files/libs/quarto-html/quarto.js"></script>
<script src="ojs_files/libs/quarto-html/popper.min.js"></script>
<script src="ojs_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="ojs_files/libs/quarto-html/anchor.min.js"></script>
<link href="ojs_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="ojs_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="ojs_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="ojs_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="ojs_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script type="module" src="ojs_files/libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="ojs_files/libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul class="collapse">
  <li><a href="#observable-javascript" id="toc-observable-javascript" class="nav-link active" data-scroll-target="#observable-javascript">Observable JavaScript</a></li>
  <li><a href="#a-vous-de-jouer" id="toc-a-vous-de-jouer" class="nav-link" data-scroll-target="#a-vous-de-jouer">A vous de jouer</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Articulation de diff√©rents langages (R, JavaScript et Python) pour la g√©ovisualisation avec Quarto</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
<p class="subtitle lead">Atelier Sageo, Qu√©bec, Juin 2023</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Timoth√©e Giraud, Nicolas Lambert, Matthieu Viry, Ronan Ysebaert (UAR RIATE, CNRS, Universit√© Paris Cit√©) </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="observable-javascript" class="level2">
<h2 class="anchored" data-anchor-id="observable-javascript">Observable JavaScript</h2>
<section id="observable-kezako" class="level3">
<h3 class="anchored" data-anchor-id="observable-kezako">Observable Kezako ?</h3>
<p>L‚Äô<b>Observable javascript {ojs}</b> est un ensemble d‚Äôam√©liorations apport√©es √† vanilla JavaScript cr√©√© par Mike Bostock (√©galement auteur de D3). Observable JS se distingue par son ex√©cution r√©active, qui convient particuli√®rement bien √† l‚Äôexploration et √† l‚Äôanalyse interactives des donn√©es.</p>
<p><img src="fig/d3.png" class="img-fluid" style="width:20.0%"> <img src="fig/arrow.png" class="img-fluid" style="width:20.0%"> <img src="fig/observable.png" class="img-fluid" style="width:20.0%"> <br> <strong>Observable</strong> est aussi une startup fond√©e par Mike Bostock et Melody Meckfessel, qui propose une plateforme 100% en ligne (<a href="https://observablehq.com">https://observablehq.com</a>) pour concevoir, partager et diffuser des visualisations de donn√©es.</p>
<p><img src="fig/frise.png" class="img-fluid"></p>
<p><strong>Observable</strong> c‚Äôest donc aussi C‚Äôest aussi une <a href="https://observablehq.com/">plateforme web</a> qui h√©berge des notebooks computationnels sur la visualisation de donn√©es.</p>
<p><img src="fig/notebookobs.png" class="img-fluid"></p>
<p>üëâ <strong>Objectif</strong> : faire collaborer une communaut√© autour de la visualisation de donn√©es.</p>
</section>
<section id="observable-dans-quarto" class="level3">
<h3 class="anchored" data-anchor-id="observable-dans-quarto">Observable dans Quarto</h3>
<p>Le runtime d‚ÄôObservable est Open Source et est utilis√© dans Quarto.</p>
<p>Dans Quarto, toutes les instructions s‚Äô√©crivent dans des chunks {ojs}</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>On peut param√©trer l‚Äôaffiche et/ou l‚Äôexecution du code avec <strong>//| echo</strong> et <strong>//| eval</strong>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">//| eval: true</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><em>NB : Contrairement aux chunks R et Python, le code s‚Äôexecute <em>just in time</em> dans le navigateur web une fois le notebook g√©n√©r√©. Seul l‚Äôexport html est donc pris en compte.</em></p>
</section>
<section id="principes" class="level3">
<h3 class="anchored" data-anchor-id="principes">Principes</h3>
<p>Le langage JavaScript n‚Äôa pas du √©t√© con√ßu pour l‚Äôanalyse de donn√©es. Mais, gros point fort, on a tous un navigateur web et JavaScript tourne sur toutes les machines. Le but : b√¢tir une √©volution du langage JavaScript pour en faire un langage adapt√© √† l‚Äôanalyse et la visualisation de donn√©es sur le web.</p>
<section id="des-biblioth√®ques-pr√©charg√©es" class="level4">
<h4 class="anchored" data-anchor-id="des-biblioth√®ques-pr√©charg√©es">üëâ Des biblioth√®ques pr√©charg√©es üìä</h4>
<p>OJS c‚Äôest du JavaScript + plein de biblioth√®ques pr√© charg√©es : <br></p>
<table class="table">
<thead>
<tr class="header">
<th>Symbol</th>
<th>Name</th>
<th>Version</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>_</td>
<td>Lodash</td>
<td>4.17.21</td>
</tr>
<tr class="even">
<td>aq</td>
<td>Arquero</td>
<td><span><span id="ojs-element-id-1"></span></span></td>
</tr>
<tr class="odd">
<td>Arrow</td>
<td>Apache Arrow</td>
<td>4.0.1</td>
</tr>
<tr class="even">
<td>d3</td>
<td>D3.js</td>
<td><span><span id="ojs-element-id-2"></span></span></td>
</tr>
<tr class="odd">
<td>dot</td>
<td>Graphviz</td>
<td>0.2.1</td>
</tr>
<tr class="even">
<td>htl</td>
<td>Hypertext Literal</td>
<td><span><span id="ojs-element-id-3"></span></span></td>
</tr>
<tr class="odd">
<td>Inputs</td>
<td>Observable Inputs</td>
<td><span><span id="ojs-element-id-4"></span></span></td>
</tr>
<tr class="even">
<td>L</td>
<td>Leaflet</td>
<td><span><span id="ojs-element-id-5"></span></span></td>
</tr>
<tr class="odd">
<td>mermaid</td>
<td>Mermaid</td>
<td>9.1.6</td>
</tr>
<tr class="even">
<td>Plot</td>
<td>Observable Plot</td>
<td><span><span id="ojs-element-id-6"></span></span></td>
</tr>
<tr class="odd">
<td>SQLite</td>
<td>SQL.js</td>
<td>1.7.0</td>
</tr>
<tr class="even">
<td>topojson</td>
<td>TopoJSON Client</td>
<td>3.1.0</td>
</tr>
<tr class="odd">
<td>vl</td>
<td>Vega, Vega-Lite</td>
<td>5.22.1, 5.2.0</td>
</tr>
</tbody>
</table>
</section>
<section id="chaque-d√©but-de-ligne-identifie-une-cellule-ojs" class="level4">
<h4 class="anchored" data-anchor-id="chaque-d√©but-de-ligne-identifie-une-cellule-ojs">üëâ Chaque d√©but de ligne identifie une cellule ojs üôã</h4>
<p>Chaque ligne d√©finit une variable et une cellule qui doit √™tre unique sur l‚Äôensemble du document.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="dv">10</span> <span class="co">// une cellule</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">20</span> <span class="co">// une cellule</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> a <span class="op">+</span> b <span class="co">// une cellule</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> { </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> a <span class="op">=</span> <span class="dv">10</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> b <span class="op">=</span> <span class="dv">30</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> a <span class="op">+</span> b </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>} <span class="co">// Une cellule</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="lordre-des-cellules-na-pas-dimportance" class="level4">
<h4 class="anchored" data-anchor-id="lordre-des-cellules-na-pas-dimportance">üëâ L‚Äôordre des cellules n‚Äôa pas d‚Äôimportance ü§Ø</h4>
<p>On peut donc √©crire √ßa</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> val1 <span class="op">*</span> val2</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>avant √ßa</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>val1 <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>val2 <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Le lien entre les cellules se fait de fa√ßon topologique et non de haut en bas.</p>
<p><img src="fig/topology.png" class="img-fluid"></p>
</section>
<section id="tout-est-r√©actif" class="level4">
<h4 class="anchored" data-anchor-id="tout-est-r√©actif">üëâ Tout est r√©actif üî•</h4>
<p>D√®s lors qu‚Äôune cellule est modifi√©e, les cellules qui en d√©pendent sont modifi√©es √©galement.</p>
<p>Pour modifier la valeutr d‚Äôune c√©llule, on utilise des <strong><code>Inputs</code></strong> (des composants propos√©s par OJS pour explorer les donn√©es) avec le mot cl√© <strong><code>viewof</code></strong>. Voir : https://observablehq.com/<span class="citation" data-cites="observablehq/inputs">@observablehq/inputs</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" data-startfrom="126" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 125;"><span id="cb8-126"><a href="#cb8-126" aria-hidden="true" tabindex="-1"></a>viewof x <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">255</span>]<span class="op">,</span> {<span class="dt">step</span><span class="op">:</span> <span class="dv">1</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" data-startfrom="130" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 129;"><span id="cb9-130"><a href="#cb9-130" aria-hidden="true" tabindex="-1"></a>viewof y <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">text</span>({<span class="dt">value</span><span class="op">:</span> <span class="dv">30</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" data-startfrom="134" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 133;"><span id="cb10-134"><a href="#cb10-134" aria-hidden="true" tabindex="-1"></a>viewof z <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">radio</span>([<span class="dv">10</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">1000</span>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="dv">10</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" data-startfrom="138" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 137;"><span id="cb11-138"><a href="#cb11-138" aria-hidden="true" tabindex="-1"></a>x <span class="op">*</span> y <span class="op">*</span> z</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-4" data-nodetype="expression">

</div>
</div>
</div>
<p>Ce syst√®me est pratique pour modifier des visualisations de donn√©es.</p>
<p>Ici, un exemple avec un simple cercle dessin√© en svg.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" data-startfrom="147" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 146;"><span id="cb12-147"><a href="#cb12-147" aria-hidden="true" tabindex="-1"></a>viewof color <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">color</span>({ <span class="dt">label</span><span class="op">:</span> <span class="st">"Couleur"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">"#4ab58c"</span> })</span>
<span id="cb12-148"><a href="#cb12-148" aria-hidden="true" tabindex="-1"></a>viewof radius <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">1</span><span class="op">,</span> <span class="dv">50</span>]<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"Rayon"</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">100</span> })</span>
<span id="cb12-149"><a href="#cb12-149" aria-hidden="true" tabindex="-1"></a>viewof position <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">50</span><span class="op">,</span> <span class="dv">950</span>]<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"Position"</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">50</span> })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-3" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" data-startfrom="152" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 151;"><span id="cb13-152"><a href="#cb13-152" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`&lt;svg viewBox="0 0 1000 100" xmlns="http://www.w3.org/2000/svg"&gt;</span></span>
<span id="cb13-153"><a href="#cb13-153" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;circle cx=</span><span class="sc">${</span>position<span class="sc">}</span><span class="vs"> cy="50" r=</span><span class="sc">${</span>radius<span class="sc">}</span><span class="vs"> fill="</span><span class="sc">${</span>color<span class="sc">}</span><span class="vs">"/&gt;</span></span>
<span id="cb13-154"><a href="#cb13-154" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/svg&gt;`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-6" data-nodetype="expression">

</div>
</div>
</div>
</section>
</section>
<section id="l√©cosyst√®me-spatial-avec-ojs" class="level3">
<h3 class="anchored" data-anchor-id="l√©cosyst√®me-spatial-avec-ojs">l‚Äô√©cosyst√®me spatial avec Ojs</h3>
<p>L‚Äô√©cosyst√®me spatial de JavaScript est moins √©toff√© que ce qu‚Äôon peut trouver en Python ou en R. Mais on trouve quand m√™me des choses int√©ressantes qui permettent de faire de la g√©omatique directement dans le navigateur web. Voici quelques exemples.</p>
<p><strong>Les fonctionnalit√©s spatiales de <code>d3.js</code></strong></p>
<div class="columns">
<div class="column" style="width:8%;">
<p><img src="fig/d3.png" class="img-fluid"></p>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:90%;">
<p><a href="https://github.com/d3/d3-geo"><strong><code>d3-geo</code></strong></a> est le module spatial de d3. Il permet de g√©rer les projections cartographiques, les formes sph√©riques et la trigonom√©trie sph√©rique. Voir aussi <a href="https://github.com/d3/d3-geo-projection"><strong><code>d3-geo-projection</code></strong></a>. <a href="https://github.com/d3/d3-delaunay"><strong><code>d3-delaunay</code></strong></a> est une biblioth√®que rapide pour calculer le diagramme de Vorono√Ø d‚Äôun ensemble de points bidimensionnels. Elle est bas√©e sur Delaunator, une biblioth√®que rapide pour calculer la triangulation de Delaunay en utilisant des algorithmes de balayage. Le diagramme de Vorono√Ø est construit en reliant les circonf√©rences des triangles adjacents dans la triangulation de Delaunay. <a href="https://github.com/Fil/d3-geo-voronoi"><strong><code>d3-geo-voronoi</code></strong></a> est une adaptation de d3-delaunay sur la sph√®re.</p>
</div>
</div>
<div class="columns">
<div class="column" style="width:8%;">
<p><img src="fig/topojson.svg" class="img-fluid"></p>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:90%;">
<p><a href="https://github.com/topojson/topojson"><strong><code>TopoJSON</code></strong></a> est une extension de GeoJSON. La librairie permet de r√©aliser des op√©rations SIG bas√©es sur la topologie (agr√©gation, voisins, simplification, etc.)</p>
</div>
</div>
<p><strong>Les biblioth√®ques SIG</strong></p>
<div class="columns">
<div class="column" style="width:8%;">
<p><img src="fig/turf.png" class="img-fluid"></p>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:90%;">
<p><a href="https://turfjs.org/"><strong><code>turf</code></strong></a> est une biblioth√®que JavaScript pour l‚Äôanalyse spatiale (de type SIG). Elle comprend les op√©rations spatiales traditionnelles, des fonctions d‚Äôaide pour la cr√©ation de donn√©es GeoJSON, ainsi que des outils de classification des donn√©es et de statistiques. L‚Äôavantage de turf est d‚Äô√™tre modulaire. On ne charge que ce dont on a besoin.</p>
</div>
</div>
<div class="columns">
<div class="column" style="width:8%;">
<p><img src="fig/spljs.jpg" class="img-fluid"></p>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:90%;">
<p><a href="https://turfjs.org/"><strong><code>spl.js</code></strong></a> est une impl√©mentation de SpatiaLite (et de ses amis : sqlite, geos, proj, rttopo) pour le navigateur.</p>
</div>
</div>
<div class="columns">
<div class="column" style="width:8%;">
<p><img src="fig/geotoolbox.svg" class="img-fluid"></p>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:90%;">
<p><a href="https://github.com/neocarto/geotoolbox"><strong><code>geotoolbox</code></strong></a> est un outil javascript pour les g√©ographes bas√© sur d3geo, topojson et jsts. Il permet de traiter simplement les propri√©t√©s geojson et fournit plusieurs op√©rations SIG utiles pour la cartographie th√©matique.</p>
</div>
</div>
<div class="columns">
<div class="column" style="width:8%;">
<p><img src="fig/gdal.png" class="img-fluid"></p>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:90%;">
<p><a href="https://github.com/bugra9/gdal3.js"><strong><code>Gdals3.js</code></strong></a> est un portage des applications Gdal (gdal_translate, ogr2ogr, gdal_rasterize, gdalwarp, gdaltransform) vers Webassembly. Il permet de convertir des donn√©es g√©ospatiales matricielles et vectorielles dans divers formats et syst√®mes de coordonn√©es.</p>
</div>
</div>
<div class="columns">
<div class="column" style="width:8%;">
<p><img src="fig/proj4.png" class="img-fluid"></p>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:90%;">
<p><a href="http://proj4js.org/"><strong><code>proj4js</code></strong></a> est une biblioth√®que JavaScript permettant de transformer les coordonn√©es d‚Äôun syst√®me de coordonn√©es √† un autre, y compris les transformations de datum</p>
</div>
</div>
<p><strong>Dataviz / cartographie</strong></p>
<div class="columns">
<div class="column" style="width:8%;">
<p><img src="fig/plot.png" class="img-fluid"></p>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:90%;">
<p><a href="https://observablehq.com/plot/"><strong><code>plot</code></strong></a> est la biblioth√®que de visualisation de donn√©e d√©velopp√©e par Observable (Mike Bostock et Philippe Rivi√®re). Au d√©part pens√©e pour la visualisation de donn√©es statistiques, elle permet aujourd‚Äôhui de r√©aliser des cartes. Plot est disponible par d√©faut dans les cellules {ojs}.</p>
</div>
</div>
<div class="columns">
<div class="column" style="width:8%;">
<p><img src="fig/vega.png" class="img-fluid"></p>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:90%;">
<p><a href="https://github.com/vega/vega-lite"><strong><code>vega-lite</code></strong></a> est un outil de visualisation mettant en ≈ìuvre une grammaire graphique, similaire √† ggplot2. Cette biblioth√®que est disponible par d√©faut dans les cellules {ojs}.</p>
</div>
</div>
<div class="columns">
<div class="column" style="width:8%;">
<p><img src="fig/bertin.png" class="img-fluid"></p>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:90%;">
<p><a href="https://github.com/neocarto/bertin"><strong><code>bertin</code></strong></a> est une biblioth√®que √©crite en JavaScript qui permet de r√©aliser des cartes th√©matiques pour le web. Sa conception vise √† permettre aux utilisateurs de cr√©er rapidement des cartes th√©matiques interactives sans forcement conna√Ætre le langage JavaScript.</p>
</div>
</div>
<div class="columns">
<div class="column" style="width:8%;">
<p><img src="fig/gridviz.png" class="img-fluid"></p>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:90%;">
<p><a href="https://github.com/eurostat/gridviz"><strong><code>Gridviz</code></strong></a> est une biblioth√®que JavaScript bas√©e sur WebGL d√©velopp√©e par Julien Gaffuri et Joe Davies. Elle permet de visualiser des donn√©es carroy√©es (ou tout ensemble de donn√©es tabulaires avec une position x/y) dans le navigateur dans une grande vari√©t√© de styles cartographiques.</p>
</div>
</div>
<div class="columns">
<div class="column" style="width:8%;">
<p><img src="fig/logo-go-cart-wasm.png" class="img-fluid"></p>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:90%;">
<p><a href="https://github.com/riatelab/go-cart-wasm"><strong><code>go-cart-wasm</code></strong></a> est une biblioth√®que JS/WASM permettant de r√©aliser des cartogrammes bas√©s sur le flux (comme d√©crit dans ‚ÄúGastner, Seguy, and More (2018).</p>
</div>
</div>
</section>
<section id="importer-des-donn√©es" class="level3">
<h3 class="anchored" data-anchor-id="importer-des-donn√©es">Importer des donn√©es</h3>
<p>Pour importer des donn√©es en <strong><code>{ojs}</code></strong>, on utilise l‚Äôinstruction <strong><code>FileAttachment()</code></strong></p>
<p>Pour un fichier JSON</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>mrc <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"geom/mrc.geojson"</span>)<span class="op">.</span><span class="fu">json</span>()</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>munic <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"geom/munic.geojson"</span>)<span class="op">.</span><span class="fu">json</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Pour un fichier csv</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">FileAttachment</span>(<span class="st">"data.csv"</span>)<span class="op">.</span><span class="fu">csv</span>({<span class="dt">typed</span><span class="op">:</span> <span class="kw">true</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>On peut aussi r√©cup√©rer des donn√©es depuis R ou Python avec l‚Äôinstruction <strong><code>ojs_define</code></strong></p>
<div class="cell" data-eval="false">
<div class="sourceCode cell-code" id="cb16" data-startfrom="325" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 324;"><span id="cb16-325"><a href="#cb16-325" aria-hidden="true" tabindex="-1"></a>mrc <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"geom/mrc.geojson"</span>)<span class="op">.</span><span class="fu">json</span>()</span>
<span id="cb16-326"><a href="#cb16-326" aria-hidden="true" tabindex="-1"></a>munic <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"geom/munic.geojson"</span>)<span class="op">.</span><span class="fu">json</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-2" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell" data-eval="true">
<div class="sourceCode cell-code hidden" id="cb17" data-startfrom="334" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 333;"><span id="cb17-334"><a href="#cb17-334" aria-hidden="true" tabindex="-1"></a>tmp <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"geom/munic.geojson"</span>)<span class="op">.</span><span class="fu">json</span>()</span>
<span id="cb17-335"><a href="#cb17-335" aria-hidden="true" tabindex="-1"></a>munic <span class="op">=</span>  geo<span class="op">.</span><span class="fu">rewind</span>(geo<span class="op">.</span><span class="fu">simplify</span>(tmp<span class="op">,</span> {<span class="dt">k</span><span class="op">:</span><span class="fl">0.1</span>}))</span>
<span id="cb17-336"><a href="#cb17-336" aria-hidden="true" tabindex="-1"></a>tmp2 <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"geom/mrc.geojson"</span>)<span class="op">.</span><span class="fu">json</span>()</span>
<span id="cb17-337"><a href="#cb17-337" aria-hidden="true" tabindex="-1"></a>mrc <span class="op">=</span>  geo<span class="op">.</span><span class="fu">rewind</span>(geo<span class="op">.</span><span class="fu">simplify</span>(tmp2<span class="op">,</span> {<span class="dt">k</span><span class="op">:</span><span class="fl">0.1</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-8-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-8-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-8-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-8-4" data-nodetype="declaration">

</div>
</div>
</div>
</div>
</section>
<section id="visualiser-les-donn√©es-stats" class="level3">
<h3 class="anchored" data-anchor-id="visualiser-les-donn√©es-stats">Visualiser les donn√©es stats</h3>
<p>Pour regarder la table attributaire, on utilise <strong><code>Inputs.table()</code></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" data-startfrom="345" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 344;"><span id="cb18-345"><a href="#cb18-345" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">table</span>(munic<span class="op">.</span><span class="at">features</span><span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">properties</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-9" data-nodetype="expression">

</div>
</div>
</div>
<p>Avec <strong><code>{ojs}</code></strong>, on va aussi pouvoir faire des graphiques avec la biblioth√®que <strong><code>plot</code></strong>. Pour cela, on fait quelques manipulations de donn√©es.</p>
<p>Tout d‚Äôabord, on r√©cup√®re les noms des 20 communes les plus peupl√©es, class√©es par ordre d√©croissant de population.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19" data-startfrom="353" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 352;"><span id="cb19-353"><a href="#cb19-353" aria-hidden="true" tabindex="-1"></a>communes <span class="op">=</span> munic<span class="op">.</span><span class="at">features</span></span>
<span id="cb19-354"><a href="#cb19-354" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">properties</span>)</span>
<span id="cb19-355"><a href="#cb19-355" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">sort</span>((a<span class="op">,</span> b) <span class="kw">=&gt;</span> d3<span class="op">.</span><span class="fu">descending</span>(a<span class="op">.</span><span class="at">POP_2022</span><span class="op">,</span> b<span class="op">.</span><span class="at">POP_2022</span>))</span>
<span id="cb19-356"><a href="#cb19-356" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">MUS_NM_MUN</span>)</span>
<span id="cb19-357"><a href="#cb19-357" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-10" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell" data-eval="true">
<div class="sourceCode cell-code hidden" id="cb20" data-startfrom="363" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 362;"><span id="cb20-363"><a href="#cb20-363" aria-hidden="true" tabindex="-1"></a>communes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-11" data-nodetype="expression">

</div>
</div>
</div>
<p>On met en forme les donn√©es.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21" data-startfrom="369" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 368;"><span id="cb21-369"><a href="#cb21-369" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> {</span>
<span id="cb21-370"><a href="#cb21-370" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> arr <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb21-371"><a href="#cb21-371" aria-hidden="true" tabindex="-1"></a>  communes<span class="op">.</span><span class="fu">forEach</span>((d) <span class="kw">=&gt;</span> {</span>
<span id="cb21-372"><a href="#cb21-372" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> tmp <span class="op">=</span> munic<span class="op">.</span><span class="at">features</span></span>
<span id="cb21-373"><a href="#cb21-373" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">properties</span>)</span>
<span id="cb21-374"><a href="#cb21-374" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">find</span>((x) <span class="kw">=&gt;</span> x<span class="op">.</span><span class="at">MUS_NM_MUN</span> <span class="op">==</span> d)<span class="op">;</span></span>
<span id="cb21-375"><a href="#cb21-375" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">2001</span><span class="op">;</span> i <span class="op">&lt;=</span> <span class="dv">2022</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb21-376"><a href="#cb21-376" aria-hidden="true" tabindex="-1"></a>      arr<span class="op">.</span><span class="fu">push</span>({ <span class="dt">year</span><span class="op">:</span> i<span class="op">,</span> <span class="dt">pop</span><span class="op">:</span> tmp[<span class="st">"POP_"</span> <span class="op">+</span> i]<span class="op">,</span> <span class="dt">com</span><span class="op">:</span> d })<span class="op">;</span></span>
<span id="cb21-377"><a href="#cb21-377" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb21-378"><a href="#cb21-378" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb21-379"><a href="#cb21-379" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> arr<span class="op">;</span></span>
<span id="cb21-380"><a href="#cb21-380" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-12" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell" data-eval="true">
<div class="sourceCode cell-code hidden" id="cb22" data-startfrom="386" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 385;"><span id="cb22-386"><a href="#cb22-386" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">table</span>(data<span class="op">,</span> {<span class="dt">width</span><span class="op">:</span><span class="dv">250</span><span class="op">,</span> <span class="dt">height</span><span class="op">:</span><span class="dv">250</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-13" data-nodetype="expression">

</div>
</div>
</div>
<p>Puis on r√©alise le graphique avec <code>plot</code> en proposant de s√©lectionner une commune.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23" data-startfrom="393" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 392;"><span id="cb23-393"><a href="#cb23-393" aria-hidden="true" tabindex="-1"></a>viewof commune <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">select</span>(communes<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"Commune"</span> })</span>
<span id="cb23-394"><a href="#cb23-394" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb23-395"><a href="#cb23-395" aria-hidden="true" tabindex="-1"></a>  <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb23-396"><a href="#cb23-396" aria-hidden="true" tabindex="-1"></a>  <span class="dt">x</span><span class="op">:</span> {</span>
<span id="cb23-397"><a href="#cb23-397" aria-hidden="true" tabindex="-1"></a>    <span class="dt">label</span><span class="op">:</span> <span class="st">"Ann√©es ‚Üí"</span><span class="op">,</span></span>
<span id="cb23-398"><a href="#cb23-398" aria-hidden="true" tabindex="-1"></a>    <span class="dt">tickFormat</span><span class="op">:</span> <span class="st">""</span></span>
<span id="cb23-399"><a href="#cb23-399" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb23-400"><a href="#cb23-400" aria-hidden="true" tabindex="-1"></a>  <span class="dt">y</span><span class="op">:</span> {</span>
<span id="cb23-401"><a href="#cb23-401" aria-hidden="true" tabindex="-1"></a>    <span class="dt">label</span><span class="op">:</span> <span class="vs">`‚Üë Population (</span><span class="sc">${</span>commune<span class="sc">}</span><span class="vs">)`</span></span>
<span id="cb23-402"><a href="#cb23-402" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb23-403"><a href="#cb23-403" aria-hidden="true" tabindex="-1"></a>  <span class="dt">color</span><span class="op">:</span> { <span class="dt">legend</span><span class="op">:</span> <span class="kw">true</span> }<span class="op">,</span></span>
<span id="cb23-404"><a href="#cb23-404" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marginLeft</span><span class="op">:</span> <span class="dv">60</span><span class="op">,</span></span>
<span id="cb23-405"><a href="#cb23-405" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb23-406"><a href="#cb23-406" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">lineY</span>(data<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">com</span> <span class="op">==</span> commune)<span class="op">,</span> {</span>
<span id="cb23-407"><a href="#cb23-407" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span></span>
<span id="cb23-408"><a href="#cb23-408" aria-hidden="true" tabindex="-1"></a>      <span class="dt">y</span><span class="op">:</span> <span class="st">"pop"</span><span class="op">,</span></span>
<span id="cb23-409"><a href="#cb23-409" aria-hidden="true" tabindex="-1"></a>      <span class="dt">stroke</span><span class="op">:</span> <span class="st">"red"</span><span class="op">,</span></span>
<span id="cb23-410"><a href="#cb23-410" aria-hidden="true" tabindex="-1"></a>      <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">2</span></span>
<span id="cb23-411"><a href="#cb23-411" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb23-412"><a href="#cb23-412" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb23-413"><a href="#cb23-413" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-14-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-14-2" data-nodetype="expression">

</div>
</div>
</div>
</div>
</section>
<section id="visualiser-les-g√©m√©tries" class="level3">
<h3 class="anchored" data-anchor-id="visualiser-les-g√©m√©tries">Visualiser les g√©m√©tries</h3>
<p>Comme leaflet est disponible dans les cellules {ojs}, on peut directement afficher les g√©om√©tries.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24" data-startfrom="420" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 419;"><span id="cb24-420"><a href="#cb24-420" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb24-421"><a href="#cb24-421" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> container <span class="op">=</span> <span class="kw">yield</span> htl<span class="op">.</span><span class="fu">html</span><span class="vs">`&lt;div style="height: 500px;"&gt;`</span><span class="op">;</span></span>
<span id="cb24-422"><a href="#cb24-422" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> map <span class="op">=</span> L<span class="op">.</span><span class="fu">map</span>(container)<span class="op">;</span></span>
<span id="cb24-423"><a href="#cb24-423" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> layer <span class="op">=</span> L<span class="op">.</span><span class="fu">geoJSON</span>(mrc)<span class="op">.</span><span class="fu">addTo</span>(map)<span class="op">;</span></span>
<span id="cb24-424"><a href="#cb24-424" aria-hidden="true" tabindex="-1"></a>  map<span class="op">.</span><span class="fu">fitBounds</span>(layer<span class="op">.</span><span class="fu">getBounds</span>()<span class="op">,</span> { <span class="dt">maxZoom</span><span class="op">:</span> <span class="dv">9</span> })<span class="op">;</span></span>
<span id="cb24-425"><a href="#cb24-425" aria-hidden="true" tabindex="-1"></a>  L<span class="op">.</span><span class="fu">tileLayer</span>(<span class="st">"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"</span><span class="op">,</span> {</span>
<span id="cb24-426"><a href="#cb24-426" aria-hidden="true" tabindex="-1"></a>    <span class="dt">attribution</span><span class="op">:</span></span>
<span id="cb24-427"><a href="#cb24-427" aria-hidden="true" tabindex="-1"></a>      <span class="st">"¬© &lt;a href=https://www.openstreetmap.org/copyright&gt;OpenStreetMap&lt;/a&gt; contributors"</span></span>
<span id="cb24-428"><a href="#cb24-428" aria-hidden="true" tabindex="-1"></a>  })<span class="op">.</span><span class="fu">addTo</span>(map)<span class="op">;</span></span>
<span id="cb24-429"><a href="#cb24-429" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-15" data-nodetype="expression">

</div>
</div>
</div>
<p>On peut √©galement afficher la carte simplement avec la biblioth√®que <a href="https://github.com/neocarto/bertin"><strong><code>bertin</code></strong></a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25" data-startfrom="435" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 434;"><span id="cb25-435"><a href="#cb25-435" aria-hidden="true" tabindex="-1"></a>bertin <span class="op">=</span> <span class="pp">require</span>(<span class="st">"bertin"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-16" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26" data-startfrom="439" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 438;"><span id="cb26-439"><a href="#cb26-439" aria-hidden="true" tabindex="-1"></a>bertin<span class="op">.</span><span class="fu">quickdraw</span>(mrc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-17" data-nodetype="expression">

</div>
</div>
</div>
</section>
<section id="un-peu-de-sig" class="level3">
<h3 class="anchored" data-anchor-id="un-peu-de-sig">Un peu de SIG</h3>
<p>La bibioth√®que <strong><code>geotoolbox</code></strong> permet de faire facilement differentes operations SIG.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27" data-startfrom="447" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 446;"><span id="cb27-447"><a href="#cb27-447" aria-hidden="true" tabindex="-1"></a>geo <span class="op">=</span> <span class="pp">require</span>(<span class="st">"geotoolbox"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-18" data-nodetype="declaration">

</div>
</div>
</div>
<ul>
<li><strong>Simplification</strong></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb28" data-startfrom="455" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 454;"><span id="cb28-455"><a href="#cb28-455" aria-hidden="true" tabindex="-1"></a>viewof simpl <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="fl">0.0001</span><span class="op">,</span> <span class="fl">0.2</span>]<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"Simplification"</span><span class="op">,</span>  <span class="dt">value</span><span class="op">:</span> <span class="fl">0.1</span> })</span>
<span id="cb28-456"><a href="#cb28-456" aria-hidden="true" tabindex="-1"></a>mrc2 <span class="op">=</span> geo<span class="op">.</span><span class="fu">simplify</span>(mrc<span class="op">,</span> { <span class="dt">k</span><span class="op">:</span> simpl })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-19-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-19-2" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb29" data-startfrom="460" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 459;"><span id="cb29-460"><a href="#cb29-460" aria-hidden="true" tabindex="-1"></a>bertin<span class="op">.</span><span class="fu">draw</span>({<span class="dt">params</span><span class="op">:</span>{<span class="dt">extent</span><span class="op">:</span> munic}<span class="op">,</span><span class="dt">layers</span><span class="op">:</span>[{<span class="dt">geojson</span><span class="op">:</span> mrc2<span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span><span class="st">"black"</span><span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span><span class="fl">1.5</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span><span class="st">"white"</span><span class="op">,</span> <span class="dt">rewind</span><span class="op">:</span> <span class="kw">true</span>}]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-20" data-nodetype="expression">

</div>
</div>
</div>
<ul>
<li><strong>Centroid</strong></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb30" data-startfrom="466" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 465;"><span id="cb30-466"><a href="#cb30-466" aria-hidden="true" tabindex="-1"></a>ctr <span class="op">=</span> geo<span class="op">.</span><span class="fu">centroid</span>(mrc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-21" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb31" data-startfrom="470" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 469;"><span id="cb31-470"><a href="#cb31-470" aria-hidden="true" tabindex="-1"></a>bertin<span class="op">.</span><span class="fu">draw</span>({<span class="dt">params</span><span class="op">:</span>{<span class="dt">extent</span><span class="op">:</span> mrc}<span class="op">,</span> <span class="dt">layers</span><span class="op">:</span>[{<span class="dt">geojson</span><span class="op">:</span> ctr<span class="op">,</span> <span class="dt">fill</span><span class="op">:</span><span class="st">"red"</span>}<span class="op">,</span>{<span class="dt">geojson</span><span class="op">:</span> mrc<span class="op">,</span> <span class="dt">fill</span><span class="op">:</span><span class="st">"#CCC"</span>}<span class="op">,</span> ]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-22" data-nodetype="expression">

</div>
</div>
</div>
<ul>
<li><strong>Buffer</strong></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb32" data-startfrom="477" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 476;"><span id="cb32-477"><a href="#cb32-477" aria-hidden="true" tabindex="-1"></a>quebec <span class="op">=</span> geo<span class="op">.</span><span class="fu">filter</span>(mrc<span class="op">,</span> (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">MUS_CO_MRC</span> <span class="op">==</span> <span class="st">"23"</span>)</span>
<span id="cb32-478"><a href="#cb32-478" aria-hidden="true" tabindex="-1"></a>buff <span class="op">=</span> geo<span class="op">.</span><span class="fu">buffer</span>(quebec<span class="op">,</span> { <span class="dt">dist</span><span class="op">:</span> distance})</span>
<span id="cb32-479"><a href="#cb32-479" aria-hidden="true" tabindex="-1"></a>ctr2 <span class="op">=</span> geo<span class="op">.</span><span class="fu">clip</span>(ctr<span class="op">,</span> {<span class="dt">clip</span><span class="op">:</span> buff})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-23-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-23-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-23-3" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb33" data-startfrom="484" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 483;"><span id="cb33-484"><a href="#cb33-484" aria-hidden="true" tabindex="-1"></a>viewof distance <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">500</span>]<span class="op">,</span> {</span>
<span id="cb33-485"><a href="#cb33-485" aria-hidden="true" tabindex="-1"></a>  <span class="dt">label</span><span class="op">:</span> <span class="st">"Distance"</span><span class="op">,</span></span>
<span id="cb33-486"><a href="#cb33-486" aria-hidden="true" tabindex="-1"></a>  <span class="dt">value</span><span class="op">:</span> <span class="dv">300</span><span class="op">,</span></span>
<span id="cb33-487"><a href="#cb33-487" aria-hidden="true" tabindex="-1"></a>  <span class="dt">step</span><span class="op">:</span> <span class="dv">10</span></span>
<span id="cb33-488"><a href="#cb33-488" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb33-489"><a href="#cb33-489" aria-hidden="true" tabindex="-1"></a>bertin<span class="op">.</span><span class="fu">draw</span>({<span class="dt">layers</span><span class="op">:</span>[{<span class="dt">geojson</span><span class="op">:</span> quebec<span class="op">,</span> <span class="dt">fill</span><span class="op">:</span><span class="st">"red"</span>}<span class="op">,</span> {<span class="dt">geojson</span><span class="op">:</span> ctr2<span class="op">,</span> <span class="dt">fill</span><span class="op">:</span><span class="st">"red"</span>}<span class="op">,</span> {<span class="dt">geojson</span><span class="op">:</span> buff<span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span><span class="st">"red"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"none"</span><span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span><span class="dv">2</span>}<span class="op">,</span>{<span class="dt">geojson</span><span class="op">:</span> mrc<span class="op">,</span> <span class="dt">fill</span><span class="op">:</span><span class="st">"#CCC"</span>}<span class="op">,</span> ]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-24-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-24-2" data-nodetype="expression">

</div>
</div>
</div>
</div>
<p><strong>Cr√©ation de cartes th√©matiques</strong></p>
<p>Pour cr√©er des cartes th√©matiques, on peut utiliser la biblioth√®que <a href="https://github.com/neocarto/bertin"><strong><code>bertin</code></strong></a></p>
<p>La fonction <strong><code>draw</code></strong> permet de r√©aliser n‚Äôimporte quel type de carte.</p>
<p><img src="fig/bertin_code.png" class="img-fluid"></p>
<p>Par d√©faut, la couche s‚Äôaffiche simplement.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34" data-startfrom="503" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 502;"><span id="cb34-503"><a href="#cb34-503" aria-hidden="true" tabindex="-1"></a>bertin<span class="op">.</span><span class="fu">draw</span>({<span class="dt">layers</span><span class="op">:</span>[{<span class="dt">geojson</span><span class="op">:</span> munic<span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"#d18de0"</span>}]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-25" data-nodetype="expression">

</div>
</div>
</div>
<p>On peut ajouter l‚Äôattrubut <strong><code>tooltip</code></strong> pour afficher des infobulles.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35" data-startfrom="509" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 508;"><span id="cb35-509"><a href="#cb35-509" aria-hidden="true" tabindex="-1"></a>bertin<span class="op">.</span><span class="fu">draw</span>({</span>
<span id="cb35-510"><a href="#cb35-510" aria-hidden="true" tabindex="-1"></a>  <span class="dt">layers</span><span class="op">:</span>[</span>
<span id="cb35-511"><a href="#cb35-511" aria-hidden="true" tabindex="-1"></a>    { </span>
<span id="cb35-512"><a href="#cb35-512" aria-hidden="true" tabindex="-1"></a>      <span class="dt">geojson</span><span class="op">:</span> munic<span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"#d18de0"</span><span class="op">,</span></span>
<span id="cb35-513"><a href="#cb35-513" aria-hidden="true" tabindex="-1"></a>      <span class="dt">tooltip</span><span class="op">:</span> <span class="st">"$MUS_NM_MUN"</span></span>
<span id="cb35-514"><a href="#cb35-514" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb35-515"><a href="#cb35-515" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb35-516"><a href="#cb35-516" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-26" data-nodetype="expression">

</div>
</div>
</div>
<p><strong>Cartographie th√©matique</strong></p>
<p>A pr√©sent, r√©alisons une carte de la population en 2022. Pour cela, on utilise le type <strong><code>bubble</code></strong>.</p>
<p>Par d√©faut, √ßa donne ceci :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36" data-startfrom="526" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 525;"><span id="cb36-526"><a href="#cb36-526" aria-hidden="true" tabindex="-1"></a>bertin<span class="op">.</span><span class="fu">draw</span>({</span>
<span id="cb36-527"><a href="#cb36-527" aria-hidden="true" tabindex="-1"></a>    <span class="dt">layers</span><span class="op">:</span> [</span>
<span id="cb36-528"><a href="#cb36-528" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb36-529"><a href="#cb36-529" aria-hidden="true" tabindex="-1"></a>        <span class="dt">type</span><span class="op">:</span> <span class="st">"bubble"</span><span class="op">,</span></span>
<span id="cb36-530"><a href="#cb36-530" aria-hidden="true" tabindex="-1"></a>        <span class="dt">geojson</span><span class="op">:</span> munic<span class="op">,</span> </span>
<span id="cb36-531"><a href="#cb36-531" aria-hidden="true" tabindex="-1"></a>        <span class="dt">values</span><span class="op">:</span> <span class="st">"POP_2022"</span><span class="op">,</span> </span>
<span id="cb36-532"><a href="#cb36-532" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fill</span><span class="op">:</span><span class="st">"red"</span></span>
<span id="cb36-533"><a href="#cb36-533" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb36-534"><a href="#cb36-534" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb36-535"><a href="#cb36-535" aria-hidden="true" tabindex="-1"></a>        <span class="dt">geojson</span><span class="op">:</span> munic<span class="op">,</span></span>
<span id="cb36-536"><a href="#cb36-536" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fill</span><span class="op">:</span> <span class="st">"#CCC"</span></span>
<span id="cb36-537"><a href="#cb36-537" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span> </span>
<span id="cb36-538"><a href="#cb36-538" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb36-539"><a href="#cb36-539" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-27" data-nodetype="expression">

</div>
</div>
</div>
<p>Et en param√©trant un peu, on obtient ceci.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37" data-startfrom="546" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 545;"><span id="cb37-546"><a href="#cb37-546" aria-hidden="true" tabindex="-1"></a>bertin<span class="op">.</span><span class="fu">draw</span>({</span>
<span id="cb37-547"><a href="#cb37-547" aria-hidden="true" tabindex="-1"></a>  <span class="dt">params</span><span class="op">:</span> { <span class="dt">extent</span><span class="op">:</span> [[<span class="op">-</span><span class="dv">79</span><span class="op">,</span> <span class="fl">44.5</span>]<span class="op">,</span> [<span class="op">-</span><span class="dv">66</span><span class="op">,</span> <span class="dv">51</span>]]}<span class="op">,</span></span>
<span id="cb37-548"><a href="#cb37-548" aria-hidden="true" tabindex="-1"></a>  <span class="dt">layers</span><span class="op">:</span> [</span>
<span id="cb37-549"><a href="#cb37-549" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">type</span><span class="op">:</span> <span class="st">"header"</span><span class="op">,</span> <span class="dt">text</span><span class="op">:</span> <span class="st">"Population en 2022"</span><span class="op">,</span> <span class="dt">anchor</span><span class="op">:</span> <span class="st">"start"</span> }<span class="op">,</span> <span class="co">// Titre</span></span>
<span id="cb37-550"><a href="#cb37-550" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">type</span><span class="op">:</span> <span class="st">"minimap"</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dt">width</span><span class="op">:</span> <span class="dv">160</span> }<span class="op">,</span> </span>
<span id="cb37-551"><a href="#cb37-551" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb37-552"><a href="#cb37-552" aria-hidden="true" tabindex="-1"></a>      <span class="dt">id</span> <span class="op">:</span> <span class="st">"bub"</span><span class="op">,</span> <span class="co">//  identifiant de la couche</span></span>
<span id="cb37-553"><a href="#cb37-553" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"bubble"</span><span class="op">,</span> <span class="co">// couche de symboles proportionnels</span></span>
<span id="cb37-554"><a href="#cb37-554" aria-hidden="true" tabindex="-1"></a>      <span class="dt">geojson</span><span class="op">:</span> munic<span class="op">,</span> </span>
<span id="cb37-555"><a href="#cb37-555" aria-hidden="true" tabindex="-1"></a>      <span class="dt">values</span><span class="op">:</span> <span class="st">"POP_2022"</span><span class="op">,</span> <span class="co">// variable √† cartographier </span></span>
<span id="cb37-556"><a href="#cb37-556" aria-hidden="true" tabindex="-1"></a>      <span class="dt">k</span><span class="op">:</span> <span class="dv">50</span><span class="op">,</span> <span class="co">// Rayon du plus gros cercle</span></span>
<span id="cb37-557"><a href="#cb37-557" aria-hidden="true" tabindex="-1"></a>      <span class="dt">leg_x</span><span class="op">:</span> <span class="dv">740</span><span class="op">,</span></span>
<span id="cb37-558"><a href="#cb37-558" aria-hidden="true" tabindex="-1"></a>      <span class="dt">leg_y</span><span class="op">:</span> <span class="dv">350</span><span class="op">,</span></span>
<span id="cb37-559"><a href="#cb37-559" aria-hidden="true" tabindex="-1"></a>      <span class="dt">leg_round</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb37-560"><a href="#cb37-560" aria-hidden="true" tabindex="-1"></a>      <span class="dt">leg_title</span><span class="op">:</span> <span class="st">"Nombre d'habitants"</span><span class="op">,</span></span>
<span id="cb37-561"><a href="#cb37-561" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fill</span><span class="op">:</span> <span class="st">"red"</span><span class="op">,</span></span>
<span id="cb37-562"><a href="#cb37-562" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fillOpacity</span><span class="op">:</span><span class="fl">0.5</span><span class="op">,</span></span>
<span id="cb37-563"><a href="#cb37-563" aria-hidden="true" tabindex="-1"></a>      <span class="dt">tooltip</span><span class="op">:</span> [<span class="st">"$MUS_NM_MUN"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">properties</span>[<span class="st">"POP_2022"</span>] <span class="op">+</span> <span class="st">" habitants"</span>] <span class="co">// infobulle</span></span>
<span id="cb37-564"><a href="#cb37-564" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb37-565"><a href="#cb37-565" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">geojson</span><span class="op">:</span> munic<span class="op">,</span> <span class="dt">fill</span><span class="op">:</span><span class="st">"#CCC"</span>}<span class="op">,</span> <span class="co">// Couche des communes</span></span>
<span id="cb37-566"><a href="#cb37-566" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">type</span><span class="op">:</span><span class="st">"scalebar"</span>}</span>
<span id="cb37-567"><a href="#cb37-567" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb37-568"><a href="#cb37-568" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-28" data-nodetype="expression">

</div>
</div>
</div>
<p>On peut facilement combiner cette couche de cercles avec un une carte choropl√®the.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38" data-startfrom="575" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 574;"><span id="cb38-575"><a href="#cb38-575" aria-hidden="true" tabindex="-1"></a>bertin<span class="op">.</span><span class="fu">draw</span>({</span>
<span id="cb38-576"><a href="#cb38-576" aria-hidden="true" tabindex="-1"></a>  <span class="dt">params</span><span class="op">:</span> { <span class="dt">extent</span><span class="op">:</span> [[<span class="op">-</span><span class="dv">79</span><span class="op">,</span> <span class="fl">44.5</span>]<span class="op">,</span> [<span class="op">-</span><span class="dv">66</span><span class="op">,</span> <span class="dv">51</span>]]}<span class="op">,</span></span>
<span id="cb38-577"><a href="#cb38-577" aria-hidden="true" tabindex="-1"></a>  <span class="dt">layers</span><span class="op">:</span> [</span>
<span id="cb38-578"><a href="#cb38-578" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">type</span><span class="op">:</span> <span class="st">"header"</span><span class="op">,</span> <span class="dt">text</span><span class="op">:</span> <span class="st">"Population en 2022"</span><span class="op">,</span> <span class="dt">anchor</span><span class="op">:</span> <span class="st">"start"</span> }<span class="op">,</span> <span class="co">// Titre</span></span>
<span id="cb38-579"><a href="#cb38-579" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">type</span><span class="op">:</span> <span class="st">"minimap"</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dt">width</span><span class="op">:</span> <span class="dv">160</span> }<span class="op">,</span> </span>
<span id="cb38-580"><a href="#cb38-580" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb38-581"><a href="#cb38-581" aria-hidden="true" tabindex="-1"></a>      <span class="dt">id</span> <span class="op">:</span> <span class="st">"bub"</span><span class="op">,</span> </span>
<span id="cb38-582"><a href="#cb38-582" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"bubble"</span><span class="op">,</span> </span>
<span id="cb38-583"><a href="#cb38-583" aria-hidden="true" tabindex="-1"></a>      <span class="dt">geojson</span><span class="op">:</span> munic<span class="op">,</span> </span>
<span id="cb38-584"><a href="#cb38-584" aria-hidden="true" tabindex="-1"></a>      <span class="dt">values</span><span class="op">:</span> <span class="st">"POP_2022"</span><span class="op">,</span> </span>
<span id="cb38-585"><a href="#cb38-585" aria-hidden="true" tabindex="-1"></a>      <span class="dt">k</span><span class="op">:</span> <span class="dv">50</span><span class="op">,</span> </span>
<span id="cb38-586"><a href="#cb38-586" aria-hidden="true" tabindex="-1"></a>      <span class="dt">leg_x</span><span class="op">:</span> <span class="dv">690</span><span class="op">,</span></span>
<span id="cb38-587"><a href="#cb38-587" aria-hidden="true" tabindex="-1"></a>      <span class="dt">leg_y</span><span class="op">:</span> <span class="dv">370</span><span class="op">,</span></span>
<span id="cb38-588"><a href="#cb38-588" aria-hidden="true" tabindex="-1"></a>      <span class="dt">leg_round</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb38-589"><a href="#cb38-589" aria-hidden="true" tabindex="-1"></a>      <span class="dt">leg_title</span><span class="op">:</span> <span class="st">"Nombre d'habitants"</span><span class="op">,</span></span>
<span id="cb38-590"><a href="#cb38-590" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fill</span><span class="op">:</span> <span class="st">"white"</span><span class="op">,</span></span>
<span id="cb38-591"><a href="#cb38-591" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fillOpacity</span><span class="op">:</span><span class="fl">0.2</span><span class="op">,</span></span>
<span id="cb38-592"><a href="#cb38-592" aria-hidden="true" tabindex="-1"></a>      <span class="dt">stroke</span><span class="op">:</span><span class="st">"black"</span><span class="op">,</span></span>
<span id="cb38-593"><a href="#cb38-593" aria-hidden="true" tabindex="-1"></a>      <span class="dt">strokeWidth</span><span class="op">:</span><span class="fl">1.4</span><span class="op">,</span></span>
<span id="cb38-594"><a href="#cb38-594" aria-hidden="true" tabindex="-1"></a>      <span class="dt">tooltip</span><span class="op">:</span> [<span class="st">"$MUS_NM_MUN"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">properties</span>[<span class="st">"POP_2022"</span>] <span class="op">+</span> <span class="st">" habitants"</span>] </span>
<span id="cb38-595"><a href="#cb38-595" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb38-596"><a href="#cb38-596" aria-hidden="true" tabindex="-1"></a>    { </span>
<span id="cb38-597"><a href="#cb38-597" aria-hidden="true" tabindex="-1"></a>      <span class="dt">geojson</span><span class="op">:</span> munic<span class="op">,</span></span>
<span id="cb38-598"><a href="#cb38-598" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fill</span><span class="op">:</span> {</span>
<span id="cb38-599"><a href="#cb38-599" aria-hidden="true" tabindex="-1"></a>            <span class="dt">type</span><span class="op">:</span> <span class="st">"choro"</span><span class="op">,</span></span>
<span id="cb38-600"><a href="#cb38-600" aria-hidden="true" tabindex="-1"></a>            <span class="dt">values</span><span class="op">:</span> <span class="st">"VIT_ECO"</span><span class="op">,</span> </span>
<span id="cb38-601"><a href="#cb38-601" aria-hidden="true" tabindex="-1"></a>            <span class="dt">colors</span><span class="op">:</span> <span class="st">"RdYlBu"</span><span class="op">,</span></span>
<span id="cb38-602"><a href="#cb38-602" aria-hidden="true" tabindex="-1"></a>            <span class="dt">leg_x</span><span class="op">:</span><span class="dv">870</span><span class="op">,</span></span>
<span id="cb38-603"><a href="#cb38-603" aria-hidden="true" tabindex="-1"></a>            <span class="dt">leg_y</span><span class="op">:</span><span class="dv">315</span><span class="op">,</span></span>
<span id="cb38-604"><a href="#cb38-604" aria-hidden="true" tabindex="-1"></a>            <span class="dt">leg_title</span><span class="op">:</span> <span class="st">"Indice de</span><span class="sc">\n</span><span class="st">vitalit√©</span><span class="sc">\n</span><span class="st">√©conomique"</span><span class="op">,</span></span>
<span id="cb38-605"><a href="#cb38-605" aria-hidden="true" tabindex="-1"></a>            <span class="dt">leg_round</span><span class="op">:</span> <span class="dv">2</span></span>
<span id="cb38-606"><a href="#cb38-606" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb38-607"><a href="#cb38-607" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span> <span class="co">// Couche des communes</span></span>
<span id="cb38-608"><a href="#cb38-608" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">type</span><span class="op">:</span><span class="st">"scalebar"</span>}</span>
<span id="cb38-609"><a href="#cb38-609" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb38-610"><a href="#cb38-610" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-29" data-nodetype="expression">

</div>
</div>
</div>
<p>On peut aussi colorier les cercles</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39" data-startfrom="616" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 615;"><span id="cb39-616"><a href="#cb39-616" aria-hidden="true" tabindex="-1"></a>bertin<span class="op">.</span><span class="fu">draw</span>({</span>
<span id="cb39-617"><a href="#cb39-617" aria-hidden="true" tabindex="-1"></a>  <span class="dt">params</span><span class="op">:</span> { <span class="dt">extent</span><span class="op">:</span> [[<span class="op">-</span><span class="dv">79</span><span class="op">,</span> <span class="fl">44.5</span>]<span class="op">,</span> [<span class="op">-</span><span class="dv">66</span><span class="op">,</span> <span class="dv">51</span>]]}<span class="op">,</span></span>
<span id="cb39-618"><a href="#cb39-618" aria-hidden="true" tabindex="-1"></a>  <span class="dt">layers</span><span class="op">:</span> [</span>
<span id="cb39-619"><a href="#cb39-619" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">type</span><span class="op">:</span> <span class="st">"header"</span><span class="op">,</span> <span class="dt">text</span><span class="op">:</span> <span class="st">"Population en 2022"</span><span class="op">,</span> <span class="dt">anchor</span><span class="op">:</span> <span class="st">"start"</span> }<span class="op">,</span> <span class="co">// Titre</span></span>
<span id="cb39-620"><a href="#cb39-620" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">type</span><span class="op">:</span> <span class="st">"minimap"</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dt">width</span><span class="op">:</span> <span class="dv">160</span> }<span class="op">,</span> </span>
<span id="cb39-621"><a href="#cb39-621" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb39-622"><a href="#cb39-622" aria-hidden="true" tabindex="-1"></a>      <span class="dt">id</span> <span class="op">:</span> <span class="st">"bub"</span><span class="op">,</span> </span>
<span id="cb39-623"><a href="#cb39-623" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"bubble"</span><span class="op">,</span> </span>
<span id="cb39-624"><a href="#cb39-624" aria-hidden="true" tabindex="-1"></a>      <span class="dt">geojson</span><span class="op">:</span> munic<span class="op">,</span> </span>
<span id="cb39-625"><a href="#cb39-625" aria-hidden="true" tabindex="-1"></a>      <span class="dt">values</span><span class="op">:</span> <span class="st">"POP_2022"</span><span class="op">,</span> </span>
<span id="cb39-626"><a href="#cb39-626" aria-hidden="true" tabindex="-1"></a>      <span class="dt">k</span><span class="op">:</span> <span class="dv">50</span><span class="op">,</span> </span>
<span id="cb39-627"><a href="#cb39-627" aria-hidden="true" tabindex="-1"></a>      <span class="dt">leg_x</span><span class="op">:</span> <span class="dv">690</span><span class="op">,</span></span>
<span id="cb39-628"><a href="#cb39-628" aria-hidden="true" tabindex="-1"></a>      <span class="dt">leg_y</span><span class="op">:</span> <span class="dv">370</span><span class="op">,</span></span>
<span id="cb39-629"><a href="#cb39-629" aria-hidden="true" tabindex="-1"></a>      <span class="dt">leg_round</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb39-630"><a href="#cb39-630" aria-hidden="true" tabindex="-1"></a>      <span class="dt">leg_title</span><span class="op">:</span> <span class="st">"Nombre d'habitants"</span><span class="op">,</span></span>
<span id="cb39-631"><a href="#cb39-631" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fill</span><span class="op">:</span> {</span>
<span id="cb39-632"><a href="#cb39-632" aria-hidden="true" tabindex="-1"></a>            <span class="dt">type</span><span class="op">:</span> <span class="st">"choro"</span><span class="op">,</span></span>
<span id="cb39-633"><a href="#cb39-633" aria-hidden="true" tabindex="-1"></a>            <span class="dt">values</span><span class="op">:</span> <span class="st">"VIT_ECO"</span><span class="op">,</span> </span>
<span id="cb39-634"><a href="#cb39-634" aria-hidden="true" tabindex="-1"></a>            <span class="dt">colors</span><span class="op">:</span> <span class="st">"RdYlBu"</span><span class="op">,</span></span>
<span id="cb39-635"><a href="#cb39-635" aria-hidden="true" tabindex="-1"></a>            <span class="dt">leg_x</span><span class="op">:</span><span class="dv">870</span><span class="op">,</span></span>
<span id="cb39-636"><a href="#cb39-636" aria-hidden="true" tabindex="-1"></a>            <span class="dt">leg_y</span><span class="op">:</span><span class="dv">315</span><span class="op">,</span></span>
<span id="cb39-637"><a href="#cb39-637" aria-hidden="true" tabindex="-1"></a>            <span class="dt">leg_title</span><span class="op">:</span> <span class="st">"Indice de</span><span class="sc">\n</span><span class="st">vitalit√©</span><span class="sc">\n</span><span class="st">√©conomique"</span><span class="op">,</span></span>
<span id="cb39-638"><a href="#cb39-638" aria-hidden="true" tabindex="-1"></a>            <span class="dt">leg_round</span><span class="op">:</span> <span class="dv">2</span></span>
<span id="cb39-639"><a href="#cb39-639" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb39-640"><a href="#cb39-640" aria-hidden="true" tabindex="-1"></a>      <span class="dt">tooltip</span><span class="op">:</span> [<span class="st">"$MUS_NM_MUN"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">properties</span>[<span class="st">"POP_2022"</span>] <span class="op">+</span> <span class="st">" habitants"</span>] </span>
<span id="cb39-641"><a href="#cb39-641" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb39-642"><a href="#cb39-642" aria-hidden="true" tabindex="-1"></a>    { </span>
<span id="cb39-643"><a href="#cb39-643" aria-hidden="true" tabindex="-1"></a>      <span class="dt">geojson</span><span class="op">:</span> munic<span class="op">,</span></span>
<span id="cb39-644"><a href="#cb39-644" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fill</span><span class="op">:</span> <span class="st">"#CCC"</span></span>
<span id="cb39-645"><a href="#cb39-645" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span> <span class="co">// Couche des communes</span></span>
<span id="cb39-646"><a href="#cb39-646" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">type</span><span class="op">:</span><span class="st">"scalebar"</span>}</span>
<span id="cb39-647"><a href="#cb39-647" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb39-648"><a href="#cb39-648" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-30" data-nodetype="expression">

</div>
</div>
</div>
<p>On peut utiliser les <strong><code>Inputs</code></strong> pour tester des visualisations, explorer les donn√©es ou proposer des interactions √† un utilisatuer.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40" data-startfrom="658" data-source-offset="-10"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 657;"><span id="cb40-658"><a href="#cb40-658" aria-hidden="true" tabindex="-1"></a>viewof symbology <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">radio</span>([<span class="st">"bubble"</span><span class="op">,</span> <span class="st">"square"</span><span class="op">,</span> <span class="st">"spikes"</span><span class="op">,</span> <span class="st">"smooth"</span><span class="op">,</span> <span class="st">"dotdensity"</span>]<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"symbologie"</span><span class="op">,</span>   <span class="dt">value</span><span class="op">:</span> <span class="st">"bubble"</span>})</span>
<span id="cb40-659"><a href="#cb40-659" aria-hidden="true" tabindex="-1"></a>viewof r <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>]<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"taille"</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">50</span><span class="op">,</span> <span class="dt">disabled</span> <span class="op">:</span> [<span class="st">"bubble"</span><span class="op">,</span> <span class="st">"square"</span><span class="op">,</span> <span class="st">"spikes"</span>]<span class="op">.</span><span class="fu">includes</span>(symbology) <span class="op">?</span> <span class="kw">false</span><span class="op">:</span> <span class="kw">true</span>})</span>
<span id="cb40-660"><a href="#cb40-660" aria-hidden="true" tabindex="-1"></a>viewof toggle <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">toggle</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">"dorling"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="dt">disabled</span> <span class="op">:</span> [<span class="st">"bubble"</span><span class="op">,</span> <span class="st">"square"</span><span class="op">,</span> <span class="st">"dotdensity"</span>]<span class="op">.</span><span class="fu">includes</span>(symbology) <span class="op">?</span> <span class="kw">false</span><span class="op">:</span> <span class="kw">true</span>})</span>
<span id="cb40-661"><a href="#cb40-661" aria-hidden="true" tabindex="-1"></a>viewof thresholds <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">5</span><span class="op">,</span> <span class="dv">50</span>]<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"thresholds"</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">23</span><span class="op">,</span> <span class="dt">disabled</span> <span class="op">:</span> symbology <span class="op">==</span> <span class="st">"smooth"</span> <span class="op">?</span> <span class="kw">false</span> <span class="op">:</span> <span class="kw">true</span>})</span>
<span id="cb40-662"><a href="#cb40-662" aria-hidden="true" tabindex="-1"></a>viewof bandwidth <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">5</span><span class="op">,</span> <span class="dv">50</span>]<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"bandwidth"</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">27</span><span class="op">,</span> <span class="dt">disabled</span> <span class="op">:</span> symbology <span class="op">==</span> <span class="st">"smooth"</span> <span class="op">?</span> <span class="kw">false</span> <span class="op">:</span> <span class="kw">true</span> })</span>
<span id="cb40-663"><a href="#cb40-663" aria-hidden="true" tabindex="-1"></a>viewof filterpop <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">1000</span><span class="op">,</span> <span class="dv">100000</span>]<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"POP &gt;= "</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">1000</span>})</span>
<span id="cb40-664"><a href="#cb40-664" aria-hidden="true" tabindex="-1"></a><span class="co">// Carte</span></span>
<span id="cb40-665"><a href="#cb40-665" aria-hidden="true" tabindex="-1"></a>bertin<span class="op">.</span><span class="fu">draw</span>({</span>
<span id="cb40-666"><a href="#cb40-666" aria-hidden="true" tabindex="-1"></a>    <span class="dt">params</span><span class="op">:</span> { <span class="dt">extent</span><span class="op">:</span> [[<span class="op">-</span><span class="dv">79</span><span class="op">,</span> <span class="fl">44.5</span>]<span class="op">,</span> [<span class="op">-</span><span class="dv">66</span><span class="op">,</span> <span class="dv">51</span>]]}<span class="op">,</span></span>
<span id="cb40-667"><a href="#cb40-667" aria-hidden="true" tabindex="-1"></a>    <span class="dt">layers</span><span class="op">:</span> [</span>
<span id="cb40-668"><a href="#cb40-668" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb40-669"><a href="#cb40-669" aria-hidden="true" tabindex="-1"></a>        <span class="dt">type</span><span class="op">:</span> symbology<span class="op">,</span></span>
<span id="cb40-670"><a href="#cb40-670" aria-hidden="true" tabindex="-1"></a>        <span class="dt">geojson</span><span class="op">:</span> geo<span class="op">.</span><span class="fu">filter</span>(munic<span class="op">,</span> (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">POP_2022</span> <span class="op">&gt;=</span> filterpop)<span class="op">,</span> </span>
<span id="cb40-671"><a href="#cb40-671" aria-hidden="true" tabindex="-1"></a>        <span class="dt">values</span><span class="op">:</span> <span class="st">"POP_2022"</span><span class="op">,</span> </span>
<span id="cb40-672"><a href="#cb40-672" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fill</span><span class="op">:</span> symbology <span class="op">==</span> <span class="st">"smooth"</span> <span class="op">?</span> <span class="st">"RdYlGn"</span> <span class="op">:</span> <span class="st">"red"</span><span class="op">,</span></span>
<span id="cb40-673"><a href="#cb40-673" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fillOpacity</span><span class="op">:</span><span class="fl">0.7</span><span class="op">,</span></span>
<span id="cb40-674"><a href="#cb40-674" aria-hidden="true" tabindex="-1"></a>        <span class="dt">dorling</span><span class="op">:</span> toggle<span class="op">,</span></span>
<span id="cb40-675"><a href="#cb40-675" aria-hidden="true" tabindex="-1"></a>        <span class="dt">k</span><span class="op">:</span> r<span class="op">,</span></span>
<span id="cb40-676"><a href="#cb40-676" aria-hidden="true" tabindex="-1"></a>        thresholds<span class="op">,</span></span>
<span id="cb40-677"><a href="#cb40-677" aria-hidden="true" tabindex="-1"></a>        bandwidth<span class="op">,</span></span>
<span id="cb40-678"><a href="#cb40-678" aria-hidden="true" tabindex="-1"></a>        <span class="dt">symbol_size</span><span class="op">:</span><span class="dv">25</span><span class="op">,</span></span>
<span id="cb40-679"><a href="#cb40-679" aria-hidden="true" tabindex="-1"></a>        <span class="dt">w</span><span class="op">:</span><span class="dv">15</span><span class="op">,</span></span>
<span id="cb40-680"><a href="#cb40-680" aria-hidden="true" tabindex="-1"></a>        <span class="dt">symbol_shift</span> <span class="op">:</span> toggle <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb40-681"><a href="#cb40-681" aria-hidden="true" tabindex="-1"></a>        <span class="dt">stroke</span> <span class="op">:</span> symbology <span class="op">==</span> <span class="st">"spikes"</span> <span class="op">?</span> <span class="st">"red"</span> <span class="op">:</span> <span class="st">"white"</span><span class="op">,</span></span>
<span id="cb40-682"><a href="#cb40-682" aria-hidden="true" tabindex="-1"></a>        <span class="dt">tooltip</span><span class="op">:</span> [<span class="st">"$MUS_NM_MUN"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">properties</span>[<span class="st">"POP_2022"</span>] <span class="op">+</span> <span class="st">" habitants"</span>] </span>
<span id="cb40-683"><a href="#cb40-683" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb40-684"><a href="#cb40-684" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb40-685"><a href="#cb40-685" aria-hidden="true" tabindex="-1"></a>        <span class="dt">geojson</span><span class="op">:</span> munic<span class="op">,</span></span>
<span id="cb40-686"><a href="#cb40-686" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fill</span><span class="op">:</span> <span class="st">"#CCC"</span><span class="op">,</span></span>
<span id="cb40-687"><a href="#cb40-687" aria-hidden="true" tabindex="-1"></a>        <span class="dt">stroke</span> <span class="op">:</span> toggle <span class="op">?</span> <span class="st">"#CCC"</span> <span class="op">:</span> <span class="st">"white"</span></span>
<span id="cb40-688"><a href="#cb40-688" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span> </span>
<span id="cb40-689"><a href="#cb40-689" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb40-690"><a href="#cb40-690" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-31-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-31-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-31-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-31-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-31-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-31-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-31-7" data-nodetype="expression">

</div>
</div>
</div>
</div>
</section>
</section>
<section id="a-vous-de-jouer" class="level2">
<h2 class="anchored" data-anchor-id="a-vous-de-jouer">A vous de jouer</h2>
<div class="callout-caution callout callout-style-simple callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
faire des cartes avec {ojs}
</div>
</div>
<div class="callout-body-container callout-body">
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Objectif
</div>
</div>
<div class="callout-body-container callout-body">
<p>R√©aliser comme ci-dessous, une carte <a href="http://geoconfluences.ens-lyon.fr/glossaire/choroplethe-choroisoplethe">choropl√®the</a> sur une r√©gion du Qu√©bec que l‚Äôon peut selectionner dans une liste d√©roulante.</p>
<div class="cell" data-eval="true">
<div class="sourceCode cell-code hidden" id="cb41" data-startfrom="708" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 707;"><span id="cb41-708"><a href="#cb41-708" aria-hidden="true" tabindex="-1"></a>viewof myregion <span class="op">=</span>  Inputs<span class="op">.</span><span class="fu">select</span>([<span class="st">"Estrie"</span><span class="op">,</span><span class="st">"Capitale-Nationale"</span><span class="op">,</span><span class="st">"Bas-Saint-Laurent"</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Choisissez une r√©gion"</span>})</span>
<span id="cb41-709"><a href="#cb41-709" aria-hidden="true" tabindex="-1"></a>myreg <span class="op">=</span> bertin<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="fu">subset</span>({</span>
<span id="cb41-710"><a href="#cb41-710" aria-hidden="true" tabindex="-1"></a>    <span class="dt">geojson</span><span class="op">:</span> munic<span class="op">,</span></span>
<span id="cb41-711"><a href="#cb41-711" aria-hidden="true" tabindex="-1"></a>    <span class="dt">field</span><span class="op">:</span> <span class="st">"MUS_NM_REG"</span><span class="op">,</span></span>
<span id="cb41-712"><a href="#cb41-712" aria-hidden="true" tabindex="-1"></a>    <span class="dt">selection</span><span class="op">:</span>   [myregion]</span>
<span id="cb41-713"><a href="#cb41-713" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb41-714"><a href="#cb41-714" aria-hidden="true" tabindex="-1"></a>bertin<span class="op">.</span><span class="fu">draw</span>({ <span class="dt">layers</span><span class="op">:</span> [{<span class="dt">type</span><span class="op">:</span><span class="st">"header"</span><span class="op">,</span> <span class="dt">text</span><span class="op">:</span> <span class="vs">`Les actifs (</span><span class="sc">${</span>myregion<span class="sc">}</span><span class="vs">)`</span>}<span class="op">,</span>{<span class="dt">type</span><span class="op">:</span><span class="st">"scalebar"</span>}<span class="op">,</span>{ <span class="dt">geojson</span><span class="op">:</span> myreg<span class="op">,</span> <span class="dt">rewind</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> {<span class="dt">type</span><span class="op">:</span><span class="st">"choro"</span><span class="op">,</span> <span class="dt">values</span><span class="op">:</span> <span class="st">"TX_2564"</span><span class="op">,</span> <span class="dt">colors</span><span class="op">:</span> <span class="st">"RdYlGn"</span><span class="op">,</span> <span class="dt">leg_x</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="dt">leg_y</span><span class="op">:</span><span class="dv">2</span><span class="op">,</span> <span class="dt">leg_title</span><span class="op">:</span><span class="st">"Taux d'actifs"</span><span class="op">,</span> <span class="dt">leg_round</span><span class="op">:</span><span class="dv">1</span>}<span class="op">,</span> <span class="dt">tooltip</span><span class="op">:</span>[<span class="st">"$MUS_NM_MUN"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="st">"Taux d'actifs :"</span> <span class="op">+</span> d<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">TX_2564</span> <span class="op">+</span> <span class="st">"%"</span>]}] })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-32-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-32-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-32-3" data-nodetype="expression">

</div>
</div>
</div>
</div>
</div>
</div>
<p><strong>A vous de jouer</strong></p>
<ul>
<li>Chargez la biblioth√®que <a href="https://github.com/neocarto/bertin"><code>bertin</code></a></li>
<li>Importez la couche <code>munic.geojson</code></li>
</ul>
<div class="callout-tip callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Besoin d‚Äôaide ?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Pour importer des donn√©es au format JSON en Observable JavaScript, on utilise l‚Äôinstruction <code>FileAttachment()</code></p>
</div>
</div>
</div>
<ul>
<li>Afficher le fond de carte avec la fonction <a href="https://github.com/neocarto/bertin#drawing-a-map"><code>draw</code></a></li>
</ul>
<div class="callout-tip callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Besoin d‚Äôaide ?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>La fonction draw prend en entr√©e un objet qui a la structure suivante :</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>bertin<span class="op">.</span><span class="fu">draw</span>({</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">layers</span><span class="op">:</span> [{<span class="op">...</span>}]</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="callout-tip callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Astuce
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Si la carte ne s‚Äôaffiche pas correctement, utiliser l‚Äôattribut <code>rewind:true</code></p>
</div>
</div>
</div>
<ul>
<li>Afficher les donn√©es attributaires.</li>
</ul>
<div class="callout-tip callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Besoin d‚Äôaide ?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>On peut afficher les donn√©es avec l‚Äôinstruction. <code>Inputs.table()</code> Mais auparavant, il faut r√©cup√©rer les propri√©t√©s du geoJSON comme ceci :</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>munic<span class="op">.</span><span class="at">features</span><span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">properties</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<ul>
<li>Cr√©er une liste d√©roulante pour choisir parmi 3 r√©gions √† √©tudier</li>
</ul>
<div class="callout-tip callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Besoin d‚Äôaide ?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Par exemple :</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>mesregions <span class="op">=</span> [<span class="st">"Estrie"</span><span class="op">,</span><span class="st">"Capitale-Nationale"</span><span class="op">,</span><span class="st">"Bas-Saint-Laurent"</span>]</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>viewof myregion <span class="op">=</span>  Inputs<span class="op">.</span><span class="fu">select</span>(mesregions<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Choisissez une r√©gion"</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<ul>
<li>Cr√©ez un nouveau fond de carte contenant les municipalit√©s de la r√©gion concern√©e.</li>
</ul>
<div class="callout-tip callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Besoin d‚Äôaide ?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Pour cr√©er ce sous jeu de donn√©es, on peut utiliser la fonction <code>subset</code> de la biblioth√®que <code>bertin</code>.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>myreg <span class="op">=</span> bertin<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="fu">subset</span>({</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">geojson</span><span class="op">:</span> munic<span class="op">,</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">field</span><span class="op">:</span> <span class="st">"MUS_NM_REG"</span><span class="op">,</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">selection</span><span class="op">:</span>   [myregion]</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<ul>
<li>Afficher le nouveau fond de carte</li>
<li>D√©finisser la couleur de fond, l‚Äô√©paisseur des traits, la couleur des contours.</li>
<li>R√©aliser une carte <a href="https://github.com/neocarto/bertin#choropleth">chorpl√®the</a> √† partir d‚Äôune variable disponible. Par exemple, le taux d‚Äôactifs (TX_2564).</li>
</ul>
<div class="callout-tip callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Besoin d‚Äôaide ?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>D√©finissez l‚Äôattribut <code>fill</code> par un objet commen√ßant par <code>{type: choro, values: ...}</code></p>
</div>
</div>
</div>
<ul>
<li>Changez les couleurs et la m√©thode de discretisation</li>
</ul>
<div class="callout-tip callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Besoin d‚Äôaide ?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>La documentation est disponible <a href="https://github.com/neocarto/bertin#choropleth">ici</a></p>
</div>
</div>
</div>
<ul>
<li>Ajouter un <a href="https://github.com/neocarto/bertin#header">titre</a></li>
<li>Ajouter la l√©gende</li>
<li>Ajouter l‚Äô<a href="https://github.com/neocarto/bertin#scalebar">√©chelle</a></li>
<li>Ajoutez des <a href="https://observablehq.com/@neocartocnrs/bertin-js-tooltips">infobulles</a></li>
</ul>
<div class="callout-caution callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
SOLUTION
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-eval="false">
<div class="sourceCode cell-code" id="cb46" data-startfrom="813" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 812;"><span id="cb46-813"><a href="#cb46-813" aria-hidden="true" tabindex="-1"></a>bertin <span class="op">=</span> <span class="pp">require</span>(<span class="st">"bertin"</span>)</span>
<span id="cb46-814"><a href="#cb46-814" aria-hidden="true" tabindex="-1"></a>munic <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"munic.geojson"</span>)<span class="op">.</span><span class="fu">json</span>()</span>
<span id="cb46-815"><a href="#cb46-815" aria-hidden="true" tabindex="-1"></a>viewof myregion <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">select</span>(</span>
<span id="cb46-816"><a href="#cb46-816" aria-hidden="true" tabindex="-1"></a>  [<span class="st">"Estrie"</span><span class="op">,</span> <span class="st">"Capitale-Nationale"</span><span class="op">,</span> <span class="st">"Bas-Saint-Laurent"</span>]<span class="op">,</span></span>
<span id="cb46-817"><a href="#cb46-817" aria-hidden="true" tabindex="-1"></a>  { <span class="dt">label</span><span class="op">:</span> <span class="st">"Choisissez une r√©gion"</span> }</span>
<span id="cb46-818"><a href="#cb46-818" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-819"><a href="#cb46-819" aria-hidden="true" tabindex="-1"></a>myreg <span class="op">=</span> bertin<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="fu">subset</span>({</span>
<span id="cb46-820"><a href="#cb46-820" aria-hidden="true" tabindex="-1"></a>    <span class="dt">geojson</span><span class="op">:</span> munic<span class="op">,</span></span>
<span id="cb46-821"><a href="#cb46-821" aria-hidden="true" tabindex="-1"></a>    <span class="dt">field</span><span class="op">:</span> <span class="st">"MUS_NM_REG"</span><span class="op">,</span></span>
<span id="cb46-822"><a href="#cb46-822" aria-hidden="true" tabindex="-1"></a>    <span class="dt">selection</span><span class="op">:</span>   [myregion]</span>
<span id="cb46-823"><a href="#cb46-823" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb46-824"><a href="#cb46-824" aria-hidden="true" tabindex="-1"></a>bertin<span class="op">.</span><span class="fu">draw</span>({</span>
<span id="cb46-825"><a href="#cb46-825" aria-hidden="true" tabindex="-1"></a>  <span class="dt">layers</span><span class="op">:</span> [</span>
<span id="cb46-826"><a href="#cb46-826" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">type</span><span class="op">:</span> <span class="st">"header"</span><span class="op">,</span> <span class="dt">text</span><span class="op">:</span> <span class="vs">`Les actifs (</span><span class="sc">${</span>myregion<span class="sc">}</span><span class="vs">)`</span> }<span class="op">,</span></span>
<span id="cb46-827"><a href="#cb46-827" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">type</span><span class="op">:</span> <span class="st">"scalebar"</span> }<span class="op">,</span></span>
<span id="cb46-828"><a href="#cb46-828" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb46-829"><a href="#cb46-829" aria-hidden="true" tabindex="-1"></a>      <span class="dt">geojson</span><span class="op">:</span> myreg<span class="op">,</span></span>
<span id="cb46-830"><a href="#cb46-830" aria-hidden="true" tabindex="-1"></a>      <span class="dt">rewind</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb46-831"><a href="#cb46-831" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fill</span><span class="op">:</span> {</span>
<span id="cb46-832"><a href="#cb46-832" aria-hidden="true" tabindex="-1"></a>        <span class="dt">type</span><span class="op">:</span> <span class="st">"choro"</span><span class="op">,</span></span>
<span id="cb46-833"><a href="#cb46-833" aria-hidden="true" tabindex="-1"></a>        <span class="dt">values</span><span class="op">:</span> <span class="st">"TX_2564"</span><span class="op">,</span></span>
<span id="cb46-834"><a href="#cb46-834" aria-hidden="true" tabindex="-1"></a>        <span class="dt">colors</span><span class="op">:</span> <span class="st">"RdYlGn"</span><span class="op">,</span></span>
<span id="cb46-835"><a href="#cb46-835" aria-hidden="true" tabindex="-1"></a>        <span class="dt">leg_x</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb46-836"><a href="#cb46-836" aria-hidden="true" tabindex="-1"></a>        <span class="dt">leg_y</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb46-837"><a href="#cb46-837" aria-hidden="true" tabindex="-1"></a>        <span class="dt">leg_title</span><span class="op">:</span> <span class="st">"Taux d'actifs"</span><span class="op">,</span></span>
<span id="cb46-838"><a href="#cb46-838" aria-hidden="true" tabindex="-1"></a>        <span class="dt">leg_round</span><span class="op">:</span> <span class="dv">1</span></span>
<span id="cb46-839"><a href="#cb46-839" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb46-840"><a href="#cb46-840" aria-hidden="true" tabindex="-1"></a>      <span class="dt">tooltip</span><span class="op">:</span> [</span>
<span id="cb46-841"><a href="#cb46-841" aria-hidden="true" tabindex="-1"></a>        <span class="st">"$MUS_NM_MUN"</span><span class="op">,</span></span>
<span id="cb46-842"><a href="#cb46-842" aria-hidden="true" tabindex="-1"></a>        (d) <span class="kw">=&gt;</span> <span class="st">"Taux d'actifs :"</span> <span class="op">+</span> d<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">TX_2564</span> <span class="op">+</span> <span class="st">"%"</span></span>
<span id="cb46-843"><a href="#cb46-843" aria-hidden="true" tabindex="-1"></a>      ]</span>
<span id="cb46-844"><a href="#cb46-844" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb46-845"><a href="#cb46-845" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb46-846"><a href="#cb46-846" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-33-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-33-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-33-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-33-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-33-5" data-nodetype="expression">

</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<!-- -->

<script type="ojs-module-contents">
{"contents":[
  {"methodName":"interpret","inline":"true","source":"htl.html`<span>${aq.version}</span>`", "cellName":"ojs-element-id-1"}
,
  {"methodName":"interpret","inline":"true","source":"htl.html`<span>${d3.version}</span>`", "cellName":"ojs-element-id-2"}
,
  {"methodName":"interpret","inline":"true","source":"htl.html`<span>${htl.version}</span>`", "cellName":"ojs-element-id-3"}
,
  {"methodName":"interpret","inline":"true","source":"htl.html`<span>${Inputs.version}</span>`", "cellName":"ojs-element-id-4"}
,
  {"methodName":"interpret","inline":"true","source":"htl.html`<span>${L.version}</span>`", "cellName":"ojs-element-id-5"}
,
  {"methodName":"interpret","inline":"true","source":"htl.html`<span>${Plot.version}</span>`", "cellName":"ojs-element-id-6"}
]}
</script>
</section>

</main>
<!-- /main column -->

<script type="ojs-module-contents">
{"contents":[{"methodName":"interpret","cellName":"ojs-cell-1","inline":false,"source":"viewof x = Inputs.range([0, 255], {step: 1})\n"},{"methodName":"interpret","cellName":"ojs-cell-2","inline":false,"source":"viewof y = Inputs.text({value: 30})\n"},{"methodName":"interpret","cellName":"ojs-cell-3","inline":false,"source":"viewof z = Inputs.radio([10, 100, 1000], {value: 10})\n"},{"methodName":"interpret","cellName":"ojs-cell-4","inline":false,"source":"x * y * z\n"},{"methodName":"interpret","cellName":"ojs-cell-5","inline":false,"source":"viewof color = Inputs.color({ label: \"Couleur\", value: \"#4ab58c\" })\nviewof radius = Inputs.range([1, 50], { label: \"Rayon\", step: 1, value: 100 })\nviewof position = Inputs.range([50, 950], { label: \"Position\", step: 1, value: 50 })\n"},{"methodName":"interpret","cellName":"ojs-cell-6","inline":false,"source":"html`<svg viewBox=\"0 0 1000 100\" xmlns=\"http://www.w3.org/2000/svg\">\n  <circle cx=${position} cy=\"50\" r=${radius} fill=\"${color}\"/>\n</svg>`\n"},{"methodName":"interpret","cellName":"ojs-cell-8","inline":false,"source":"tmp = FileAttachment(\"geom/munic.geojson\").json()\nmunic =  geo.rewind(geo.simplify(tmp, {k:0.1}))\ntmp2 = FileAttachment(\"geom/mrc.geojson\").json()\nmrc =  geo.rewind(geo.simplify(tmp2, {k:0.1}))\n\n"},{"methodName":"interpret","cellName":"ojs-cell-9","inline":false,"source":"Inputs.table(munic.features.map(d => d.properties))\n"},{"methodName":"interpret","cellName":"ojs-cell-10","inline":false,"source":"communes = munic.features\n  .map((d) => d.properties)\n  .sort((a, b) => d3.descending(a.POP_2022, b.POP_2022))\n  .map((d) => d.MUS_NM_MUN)\n  .slice(0, 20)\n"},{"methodName":"interpret","cellName":"ojs-cell-11","inline":false,"source":"communes\n"},{"methodName":"interpret","cellName":"ojs-cell-12","inline":false,"source":"data = {\n  let arr = [];\n  communes.forEach((d) => {\n    let tmp = munic.features\n      .map((d) => d.properties)\n      .find((x) => x.MUS_NM_MUN == d);\n    for (let i = 2001; i <= 2022; i++) {\n      arr.push({ year: i, pop: tmp[\"POP_\" + i], com: d });\n    }\n  });\n  return arr;\n}\n"},{"methodName":"interpret","cellName":"ojs-cell-13","inline":false,"source":"Inputs.table(data, {width:250, height:250})\n"},{"methodName":"interpret","cellName":"ojs-cell-14","inline":false,"source":"viewof commune = Inputs.select(communes, { label: \"Commune\" })\nPlot.plot({\n  grid: true,\n  x: {\n    label: \"Ann√©es ‚Üí\",\n    tickFormat: \"\"\n  },\n  y: {\n    label: `‚Üë Population (${commune})`\n  },\n  color: { legend: true },\n  marginLeft: 60,\n  marks: [\n    Plot.lineY(data.filter(d => d.com == commune), {\n      x: \"year\",\n      y: \"pop\",\n      stroke: \"red\",\n      strokeWidth: 2\n    })\n  ]\n})\n"},{"methodName":"interpret","cellName":"ojs-cell-15","inline":false,"source":"{\n  const container = yield htl.html`<div style=\"height: 500px;\">`;\n  const map = L.map(container);\n  const layer = L.geoJSON(mrc).addTo(map);\n  map.fitBounds(layer.getBounds(), { maxZoom: 9 });\n  L.tileLayer(\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\", {\n    attribution:\n      \"¬© <a href=https://www.openstreetmap.org/copyright>OpenStreetMap</a> contributors\"\n  }).addTo(map);\n}\n"},{"methodName":"interpret","cellName":"ojs-cell-16","inline":false,"source":"bertin = require(\"bertin\")\n"},{"methodName":"interpret","cellName":"ojs-cell-17","inline":false,"source":"bertin.quickdraw(mrc)\n"},{"methodName":"interpret","cellName":"ojs-cell-18","inline":false,"source":"geo = require(\"geotoolbox\")\n"},{"methodName":"interpret","cellName":"ojs-cell-19","inline":false,"source":"viewof simpl = Inputs.range([0.0001, 0.2], { label: \"Simplification\",  value: 0.1 })\nmrc2 = geo.simplify(mrc, { k: simpl })\n"},{"methodName":"interpret","cellName":"ojs-cell-20","inline":false,"source":"bertin.draw({params:{extent: munic},layers:[{geojson: mrc2, stroke:\"black\", strokeWidth:1.5, fill:\"white\", rewind: true}]})\n"},{"methodName":"interpret","cellName":"ojs-cell-21","inline":false,"source":"ctr = geo.centroid(mrc)\n"},{"methodName":"interpret","cellName":"ojs-cell-22","inline":false,"source":"bertin.draw({params:{extent: mrc}, layers:[{geojson: ctr, fill:\"red\"},{geojson: mrc, fill:\"#CCC\"}, ]}) \n"},{"methodName":"interpret","cellName":"ojs-cell-23","inline":false,"source":"quebec = geo.filter(mrc, (d) => d.MUS_CO_MRC == \"23\")\nbuff = geo.buffer(quebec, { dist: distance})\nctr2 = geo.clip(ctr, {clip: buff})\n"},{"methodName":"interpret","cellName":"ojs-cell-24","inline":false,"source":"viewof distance = Inputs.range([0, 500], {\n  label: \"Distance\",\n  value: 300,\n  step: 10\n})\nbertin.draw({layers:[{geojson: quebec, fill:\"red\"}, {geojson: ctr2, fill:\"red\"}, {geojson: buff, stroke:\"red\", fill: \"none\", strokeWidth:2},{geojson: mrc, fill:\"#CCC\"}, ]}) \n"},{"methodName":"interpret","cellName":"ojs-cell-25","inline":false,"source":"bertin.draw({layers:[{geojson: munic, fill: \"#d18de0\"}]})\n"},{"methodName":"interpret","cellName":"ojs-cell-26","inline":false,"source":"bertin.draw({\n  layers:[\n    { \n      geojson: munic, fill: \"#d18de0\",\n      tooltip: \"$MUS_NM_MUN\"\n    }\n  ]\n})\n"},{"methodName":"interpret","cellName":"ojs-cell-27","inline":false,"source":"bertin.draw({\n    layers: [\n      {\n        type: \"bubble\",\n        geojson: munic, \n        values: \"POP_2022\", \n        fill:\"red\"\n      },\n      {\n        geojson: munic,\n        fill: \"#CCC\"\n      }, \n  ]\n})\n"},{"methodName":"interpret","cellName":"ojs-cell-28","inline":false,"source":"bertin.draw({\n  params: { extent: [[-79, 44.5], [-66, 51]]},\n  layers: [\n    { type: \"header\", text: \"Population en 2022\", anchor: \"start\" }, // Titre\n    { type: \"minimap\", x: 10, y: 10, width: 160 }, \n    {\n      id : \"bub\", //  identifiant de la couche\n      type: \"bubble\", // couche de symboles proportionnels\n      geojson: munic, \n      values: \"POP_2022\", // variable √† cartographier \n      k: 50, // Rayon du plus gros cercle\n      leg_x: 740,\n      leg_y: 350,\n      leg_round: 0,\n      leg_title: \"Nombre d'habitants\",\n      fill: \"red\",\n      fillOpacity:0.5,\n      tooltip: [\"$MUS_NM_MUN\", d => d.properties[\"POP_2022\"] + \" habitants\"] // infobulle\n    },\n    {geojson: munic, fill:\"#CCC\"}, // Couche des communes\n    {type:\"scalebar\"}\n  ]\n})\n"},{"methodName":"interpret","cellName":"ojs-cell-29","inline":false,"source":"bertin.draw({\n  params: { extent: [[-79, 44.5], [-66, 51]]},\n  layers: [\n    { type: \"header\", text: \"Population en 2022\", anchor: \"start\" }, // Titre\n    { type: \"minimap\", x: 10, y: 10, width: 160 }, \n    {\n      id : \"bub\", \n      type: \"bubble\", \n      geojson: munic, \n      values: \"POP_2022\", \n      k: 50, \n      leg_x: 690,\n      leg_y: 370,\n      leg_round: 0,\n      leg_title: \"Nombre d'habitants\",\n      fill: \"white\",\n      fillOpacity:0.2,\n      stroke:\"black\",\n      strokeWidth:1.4,\n      tooltip: [\"$MUS_NM_MUN\", d => d.properties[\"POP_2022\"] + \" habitants\"] \n    },\n    { \n      geojson: munic,\n      fill: {\n            type: \"choro\",\n            values: \"VIT_ECO\", \n            colors: \"RdYlBu\",\n            leg_x:870,\n            leg_y:315,\n            leg_title: \"Indice de\\nvitalit√©\\n√©conomique\",\n            leg_round: 2\n        }\n    }, // Couche des communes\n    {type:\"scalebar\"}\n  ]\n})\n"},{"methodName":"interpret","cellName":"ojs-cell-30","inline":false,"source":"bertin.draw({\n  params: { extent: [[-79, 44.5], [-66, 51]]},\n  layers: [\n    { type: \"header\", text: \"Population en 2022\", anchor: \"start\" }, // Titre\n    { type: \"minimap\", x: 10, y: 10, width: 160 }, \n    {\n      id : \"bub\", \n      type: \"bubble\", \n      geojson: munic, \n      values: \"POP_2022\", \n      k: 50, \n      leg_x: 690,\n      leg_y: 370,\n      leg_round: 0,\n      leg_title: \"Nombre d'habitants\",\n      fill: {\n            type: \"choro\",\n            values: \"VIT_ECO\", \n            colors: \"RdYlBu\",\n            leg_x:870,\n            leg_y:315,\n            leg_title: \"Indice de\\nvitalit√©\\n√©conomique\",\n            leg_round: 2\n        },\n      tooltip: [\"$MUS_NM_MUN\", d => d.properties[\"POP_2022\"] + \" habitants\"] \n    },\n    { \n      geojson: munic,\n      fill: \"#CCC\"\n    }, // Couche des communes\n    {type:\"scalebar\"}\n  ]\n})\n"},{"methodName":"interpret","cellName":"ojs-cell-31","inline":false,"source":"// Inputs\nviewof symbology = Inputs.radio([\"bubble\", \"square\", \"spikes\", \"smooth\", \"dotdensity\"], { label: \"symbologie\",   value: \"bubble\"})\nviewof r = Inputs.range([10, 100], { label: \"taille\", step: 1, value: 50, disabled : [\"bubble\", \"square\", \"spikes\"].includes(symbology) ? false: true})\nviewof toggle = Inputs.toggle({label: \"dorling\", value: false, disabled : [\"bubble\", \"square\", \"dotdensity\"].includes(symbology) ? false: true})\nviewof thresholds = Inputs.range([5, 50], { label: \"thresholds\", step: 1, value: 23, disabled : symbology == \"smooth\" ? false : true})\nviewof bandwidth = Inputs.range([5, 50], { label: \"bandwidth\", step: 1, value: 27, disabled : symbology == \"smooth\" ? false : true })\nviewof filterpop = Inputs.range([1000, 100000], { label: \"POP >= \", step: 1, value: 1000})\n// Carte\nbertin.draw({\n    params: { extent: [[-79, 44.5], [-66, 51]]},\n    layers: [\n      {\n        type: symbology,\n        geojson: geo.filter(munic, (d) => d.POP_2022 >= filterpop), \n        values: \"POP_2022\", \n        fill: symbology == \"smooth\" ? \"RdYlGn\" : \"red\",\n        fillOpacity:0.7,\n        dorling: toggle,\n        k: r,\n        thresholds,\n        bandwidth,\n        symbol_size:25,\n        w:15,\n        symbol_shift : toggle ? 1 : 0,\n        stroke : symbology == \"spikes\" ? \"red\" : \"white\",\n        tooltip: [\"$MUS_NM_MUN\", d => d.properties[\"POP_2022\"] + \" habitants\"] \n      },\n      {\n        geojson: munic,\n        fill: \"#CCC\",\n        stroke : toggle ? \"#CCC\" : \"white\"\n      }, \n  ]\n})\n"},{"methodName":"interpret","cellName":"ojs-cell-32","inline":false,"source":"viewof myregion =  Inputs.select([\"Estrie\",\"Capitale-Nationale\",\"Bas-Saint-Laurent\"], {label: \"Choisissez une r√©gion\"})\nmyreg = bertin.properties.subset({\n    geojson: munic,\n    field: \"MUS_NM_REG\",\n    selection:   [myregion]\n})\nbertin.draw({ layers: [{type:\"header\", text: `Les actifs (${myregion})`},{type:\"scalebar\"},{ geojson: myreg, rewind: true, fill: {type:\"choro\", values: \"TX_2564\", colors: \"RdYlGn\", leg_x: 2, leg_y:2, leg_title:\"Taux d'actifs\", leg_round:1}, tooltip:[\"$MUS_NM_MUN\", d => \"Taux d'actifs :\" + d.properties.TX_2564 + \"%\"]}] })\n"},{"methodName":"interpretQuiet","source":"shinyInput('x')"},{"methodName":"interpretQuiet","source":"shinyInput('y')"},{"methodName":"interpretQuiet","source":"shinyInput('z')"},{"methodName":"interpretQuiet","source":"shinyInput('color')"},{"methodName":"interpretQuiet","source":"shinyInput('radius')"},{"methodName":"interpretQuiet","source":"shinyInput('position')"},{"methodName":"interpretQuiet","source":"shinyInput('commune')"},{"methodName":"interpretQuiet","source":"shinyInput('simpl')"},{"methodName":"interpretQuiet","source":"shinyInput('distance')"},{"methodName":"interpretQuiet","source":"shinyInput('symbology')"},{"methodName":"interpretQuiet","source":"shinyInput('r')"},{"methodName":"interpretQuiet","source":"shinyInput('toggle')"},{"methodName":"interpretQuiet","source":"shinyInput('thresholds')"},{"methodName":"interpretQuiet","source":"shinyInput('bandwidth')"},{"methodName":"interpretQuiet","source":"shinyInput('filterpop')"},{"methodName":"interpretQuiet","source":"shinyInput('myregion')"}]}
</script>
<script type="module">
window._ojs.paths.runtimeToDoc = "../../..";
window._ojs.paths.runtimeToRoot = "../../..";
window._ojs.paths.docToRoot = "";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb47" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Articulation de diff√©rents langages (R, JavaScript et Python) pour la g√©ovisualisation avec Quarto"</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Atelier Sageo, Qu√©bec, Juin 2023"</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Timoth√©e Giraud, Nicolas Lambert, Matthieu Viry, Ronan Ysebaert (UAR RIATE, CNRS, Universit√© Paris Cit√©)"</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: sandstone</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="co">    fontsize: 0.9em</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 2</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a><span class="co">    linkcolor: "#8631ad"</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span><span class="co"> </span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a><span class="co">  cache: false</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a><span class="fu">## Observable JavaScript</span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a><span class="fu">### Observable Kezako ?</span></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>L'<span class="kw">&lt;b&gt;</span>Observable javascript {ojs}<span class="kw">&lt;/b&gt;</span> est un ensemble d'am√©liorations apport√©es √† vanilla JavaScript cr√©√© par Mike Bostock (√©galement auteur de D3). Observable JS se distingue par son ex√©cution r√©active, qui convient particuli√®rement bien √† l'exploration et √† l'analyse interactives des donn√©es.</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a><span class="al">![](fig/d3.png)</span>{width=20%} <span class="al">![](fig/arrow.png)</span>{width=20%} <span class="al">![](fig/observable.png)</span>{width=20%} <span class="kw">&lt;br/&gt;</span></span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>**Observable** est aussi une startup fond√©e par Mike Bostock et Melody Meckfessel, qui propose une plateforme 100% en ligne (<span class="co">[</span><span class="ot">https://observablehq.com</span><span class="co">](https://observablehq.com)</span>) pour concevoir, partager et diffuser des visualisations de donn√©es. </span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a><span class="al">![](fig/frise.png)</span></span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>**Observable** c'est donc aussi C‚Äôest aussi une <span class="co">[</span><span class="ot">plateforme web</span><span class="co">](https://observablehq.com/)</span> qui h√©berge des notebooks computationnels sur la visualisation de donn√©es.</span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a><span class="al">![](fig/notebookobs.png)</span></span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a>üëâ **Objectif** : faire collaborer une communaut√© autour de la visualisation de donn√©es.</span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a><span class="fu">### Observable dans Quarto</span></span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a>Le runtime d'Observable est Open Source et est utilis√© dans Quarto. </span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a>Dans Quarto, toutes les instructions s'√©crivent dans des chunks {ojs}</span>
<span id="cb47-41"><a href="#cb47-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-42"><a href="#cb47-42" aria-hidden="true" tabindex="-1"></a><span class="in">``` {{ojs}}</span></span>
<span id="cb47-43"><a href="#cb47-43" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-44"><a href="#cb47-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-45"><a href="#cb47-45" aria-hidden="true" tabindex="-1"></a>On peut param√©trer l'affiche et/ou l'execution du code avec **//| echo** et **//| eval**.</span>
<span id="cb47-46"><a href="#cb47-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-47"><a href="#cb47-47" aria-hidden="true" tabindex="-1"></a><span class="in">``` {{ojs}}</span></span>
<span id="cb47-48"><a href="#cb47-48" aria-hidden="true" tabindex="-1"></a><span class="in">//| echo: false</span></span>
<span id="cb47-49"><a href="#cb47-49" aria-hidden="true" tabindex="-1"></a><span class="in">//| eval: true</span></span>
<span id="cb47-50"><a href="#cb47-50" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-51"><a href="#cb47-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-52"><a href="#cb47-52" aria-hidden="true" tabindex="-1"></a>_NB : Contrairement aux chunks R et Python, le code s'execute *just in time* dans le navigateur web une fois le notebook g√©n√©r√©. Seul l'export html est donc pris en compte._</span>
<span id="cb47-53"><a href="#cb47-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-54"><a href="#cb47-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-55"><a href="#cb47-55" aria-hidden="true" tabindex="-1"></a><span class="fu">### Principes</span></span>
<span id="cb47-56"><a href="#cb47-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-57"><a href="#cb47-57" aria-hidden="true" tabindex="-1"></a>Le langage JavaScript n'a pas du √©t√© con√ßu pour l‚Äôanalyse de donn√©es. Mais, gros point fort, on a tous un navigateur web et JavaScript tourne sur toutes les machines. Le but : b√¢tir une √©volution du langage JavaScript pour en faire un langage adapt√© √† l‚Äôanalyse et la visualisation de donn√©es sur le web. </span>
<span id="cb47-58"><a href="#cb47-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-59"><a href="#cb47-59" aria-hidden="true" tabindex="-1"></a><span class="fu">#### üëâ Des biblioth√®ques pr√©charg√©es üìä</span></span>
<span id="cb47-60"><a href="#cb47-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-61"><a href="#cb47-61" aria-hidden="true" tabindex="-1"></a>OJS c'est du JavaScript + plein de biblioth√®ques pr√© charg√©es : <span class="kw">&lt;br/&gt;</span></span>
<span id="cb47-62"><a href="#cb47-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-63"><a href="#cb47-63" aria-hidden="true" tabindex="-1"></a>| Symbol   | Name              | Version            |</span>
<span id="cb47-64"><a href="#cb47-64" aria-hidden="true" tabindex="-1"></a>|----------|-------------------|--------------------|</span>
<span id="cb47-65"><a href="#cb47-65" aria-hidden="true" tabindex="-1"></a>| <span class="sc">\_</span>       | Lodash            | 4.17.21            |</span>
<span id="cb47-66"><a href="#cb47-66" aria-hidden="true" tabindex="-1"></a>| aq       | Arquero           | \${aq.version}     |</span>
<span id="cb47-67"><a href="#cb47-67" aria-hidden="true" tabindex="-1"></a>| Arrow    | Apache Arrow      | 4.0.1              |</span>
<span id="cb47-68"><a href="#cb47-68" aria-hidden="true" tabindex="-1"></a>| d3       | D3.js             | \${d3.version}     |</span>
<span id="cb47-69"><a href="#cb47-69" aria-hidden="true" tabindex="-1"></a>| dot      | Graphviz          | 0.2.1              |</span>
<span id="cb47-70"><a href="#cb47-70" aria-hidden="true" tabindex="-1"></a>| htl      | Hypertext Literal | \${htl.version}    |</span>
<span id="cb47-71"><a href="#cb47-71" aria-hidden="true" tabindex="-1"></a>| Inputs   | Observable Inputs | \${Inputs.version} |</span>
<span id="cb47-72"><a href="#cb47-72" aria-hidden="true" tabindex="-1"></a>| L        | Leaflet           | \${L.version}      |</span>
<span id="cb47-73"><a href="#cb47-73" aria-hidden="true" tabindex="-1"></a>| mermaid  | Mermaid           | 9.1.6              |</span>
<span id="cb47-74"><a href="#cb47-74" aria-hidden="true" tabindex="-1"></a>| Plot     | Observable Plot   | \${Plot.version}   |</span>
<span id="cb47-75"><a href="#cb47-75" aria-hidden="true" tabindex="-1"></a>| SQLite   | SQL.js            | 1.7.0              |</span>
<span id="cb47-76"><a href="#cb47-76" aria-hidden="true" tabindex="-1"></a>| topojson | TopoJSON Client   | 3.1.0              |</span>
<span id="cb47-77"><a href="#cb47-77" aria-hidden="true" tabindex="-1"></a>| vl       | Vega, Vega-Lite   | 5.22.1, 5.2.0      |</span>
<span id="cb47-78"><a href="#cb47-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-79"><a href="#cb47-79" aria-hidden="true" tabindex="-1"></a><span class="fu">#### üëâ Chaque d√©but de ligne identifie une cellule ojs üôã</span></span>
<span id="cb47-80"><a href="#cb47-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-81"><a href="#cb47-81" aria-hidden="true" tabindex="-1"></a>Chaque ligne d√©finit une variable et une cellule qui doit √™tre unique sur l'ensemble du document.</span>
<span id="cb47-82"><a href="#cb47-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-83"><a href="#cb47-83" aria-hidden="true" tabindex="-1"></a><span class="in">``` {{ojs}}</span></span>
<span id="cb47-84"><a href="#cb47-84" aria-hidden="true" tabindex="-1"></a><span class="in">a = 10 // une cellule</span></span>
<span id="cb47-85"><a href="#cb47-85" aria-hidden="true" tabindex="-1"></a><span class="in">b = 20 // une cellule</span></span>
<span id="cb47-86"><a href="#cb47-86" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-87"><a href="#cb47-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-88"><a href="#cb47-88" aria-hidden="true" tabindex="-1"></a><span class="in">``` {{ojs}}</span></span>
<span id="cb47-89"><a href="#cb47-89" aria-hidden="true" tabindex="-1"></a><span class="in">c = a + b // une cellule</span></span>
<span id="cb47-90"><a href="#cb47-90" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-91"><a href="#cb47-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-92"><a href="#cb47-92" aria-hidden="true" tabindex="-1"></a><span class="in">``` {{ojs}}</span></span>
<span id="cb47-93"><a href="#cb47-93" aria-hidden="true" tabindex="-1"></a><span class="in">d = { </span></span>
<span id="cb47-94"><a href="#cb47-94" aria-hidden="true" tabindex="-1"></a><span class="in">  let a = 10 </span></span>
<span id="cb47-95"><a href="#cb47-95" aria-hidden="true" tabindex="-1"></a><span class="in">  let b = 30</span></span>
<span id="cb47-96"><a href="#cb47-96" aria-hidden="true" tabindex="-1"></a><span class="in">  return a + b </span></span>
<span id="cb47-97"><a href="#cb47-97" aria-hidden="true" tabindex="-1"></a><span class="in">} // Une cellule</span></span>
<span id="cb47-98"><a href="#cb47-98" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-99"><a href="#cb47-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-100"><a href="#cb47-100" aria-hidden="true" tabindex="-1"></a><span class="fu">#### üëâ L‚Äôordre des cellules n‚Äôa pas d‚Äôimportance ü§Ø</span></span>
<span id="cb47-101"><a href="#cb47-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-102"><a href="#cb47-102" aria-hidden="true" tabindex="-1"></a>On peut donc √©crire √ßa</span>
<span id="cb47-103"><a href="#cb47-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-104"><a href="#cb47-104" aria-hidden="true" tabindex="-1"></a><span class="in">``` {{ojs}}</span></span>
<span id="cb47-105"><a href="#cb47-105" aria-hidden="true" tabindex="-1"></a><span class="in">result = val1 * val2</span></span>
<span id="cb47-106"><a href="#cb47-106" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-107"><a href="#cb47-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-108"><a href="#cb47-108" aria-hidden="true" tabindex="-1"></a>avant √ßa</span>
<span id="cb47-109"><a href="#cb47-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-110"><a href="#cb47-110" aria-hidden="true" tabindex="-1"></a><span class="in">``` {{ojs}}</span></span>
<span id="cb47-111"><a href="#cb47-111" aria-hidden="true" tabindex="-1"></a><span class="in">val1 = 10</span></span>
<span id="cb47-112"><a href="#cb47-112" aria-hidden="true" tabindex="-1"></a><span class="in">val2 = 20</span></span>
<span id="cb47-113"><a href="#cb47-113" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-114"><a href="#cb47-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-115"><a href="#cb47-115" aria-hidden="true" tabindex="-1"></a>Le lien entre les cellules se fait de fa√ßon topologique et non de haut en bas. </span>
<span id="cb47-116"><a href="#cb47-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-117"><a href="#cb47-117" aria-hidden="true" tabindex="-1"></a><span class="al">![](fig/topology.png)</span></span>
<span id="cb47-118"><a href="#cb47-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-119"><a href="#cb47-119" aria-hidden="true" tabindex="-1"></a><span class="fu">#### üëâ Tout est r√©actif üî•</span></span>
<span id="cb47-120"><a href="#cb47-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-121"><a href="#cb47-121" aria-hidden="true" tabindex="-1"></a>D√®s lors qu'une cellule est modifi√©e, les cellules qui en d√©pendent sont modifi√©es √©galement.</span>
<span id="cb47-122"><a href="#cb47-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-123"><a href="#cb47-123" aria-hidden="true" tabindex="-1"></a>Pour modifier la valeutr d'une c√©llule, on utilise des **`Inputs`** (des composants propos√©s par OJS pour explorer les donn√©es) avec le mot cl√© **`viewof`**. Voir : https://observablehq.com/@observablehq/inputs</span>
<span id="cb47-124"><a href="#cb47-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-125"><a href="#cb47-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-128"><a href="#cb47-128" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb47-129"><a href="#cb47-129" aria-hidden="true" tabindex="-1"></a>viewof x <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">255</span>]<span class="op">,</span> {<span class="dt">step</span><span class="op">:</span> <span class="dv">1</span>})</span>
<span id="cb47-130"><a href="#cb47-130" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb47-131"><a href="#cb47-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-134"><a href="#cb47-134" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb47-135"><a href="#cb47-135" aria-hidden="true" tabindex="-1"></a>viewof y <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">text</span>({<span class="dt">value</span><span class="op">:</span> <span class="dv">30</span>})</span>
<span id="cb47-136"><a href="#cb47-136" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb47-137"><a href="#cb47-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-140"><a href="#cb47-140" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb47-141"><a href="#cb47-141" aria-hidden="true" tabindex="-1"></a>viewof z <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">radio</span>([<span class="dv">10</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">1000</span>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="dv">10</span>})</span>
<span id="cb47-142"><a href="#cb47-142" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb47-143"><a href="#cb47-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-146"><a href="#cb47-146" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb47-147"><a href="#cb47-147" aria-hidden="true" tabindex="-1"></a>x <span class="op">*</span> y <span class="op">*</span> z</span>
<span id="cb47-148"><a href="#cb47-148" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb47-149"><a href="#cb47-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-150"><a href="#cb47-150" aria-hidden="true" tabindex="-1"></a><span class="vs">Ce syst√®me est pratique pour modifier des visualisations de donn√©es.</span></span>
<span id="cb47-151"><a href="#cb47-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-152"><a href="#cb47-152" aria-hidden="true" tabindex="-1"></a><span class="vs">Ici, un exemple avec un simple cercle dessin√© en svg.</span></span>
<span id="cb47-153"><a href="#cb47-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-156"><a href="#cb47-156" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb47-157"><a href="#cb47-157" aria-hidden="true" tabindex="-1"></a>viewof color <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">color</span>({ <span class="dt">label</span><span class="op">:</span> <span class="st">"Couleur"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">"#4ab58c"</span> })</span>
<span id="cb47-158"><a href="#cb47-158" aria-hidden="true" tabindex="-1"></a>viewof radius <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">1</span><span class="op">,</span> <span class="dv">50</span>]<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"Rayon"</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">100</span> })</span>
<span id="cb47-159"><a href="#cb47-159" aria-hidden="true" tabindex="-1"></a>viewof position <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">50</span><span class="op">,</span> <span class="dv">950</span>]<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"Position"</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">50</span> })</span>
<span id="cb47-160"><a href="#cb47-160" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb47-161"><a href="#cb47-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-164"><a href="#cb47-164" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb47-165"><a href="#cb47-165" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`&lt;svg viewBox="0 0 1000 100" xmlns="http://www.w3.org/2000/svg"&gt;</span></span>
<span id="cb47-166"><a href="#cb47-166" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;circle cx=</span><span class="sc">${</span>position<span class="sc">}</span><span class="vs"> cy="50" r=</span><span class="sc">${</span>radius<span class="sc">}</span><span class="vs"> fill="</span><span class="sc">${</span>color<span class="sc">}</span><span class="vs">"/&gt;</span></span>
<span id="cb47-167"><a href="#cb47-167" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/svg&gt;`</span></span>
<span id="cb47-168"><a href="#cb47-168" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb47-169"><a href="#cb47-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-170"><a href="#cb47-170" aria-hidden="true" tabindex="-1"></a><span class="vs">### l'√©cosyst√®me spatial avec Ojs</span></span>
<span id="cb47-171"><a href="#cb47-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-172"><a href="#cb47-172" aria-hidden="true" tabindex="-1"></a><span class="vs">L'√©cosyst√®me spatial de JavaScript est moins √©toff√© que ce qu'on peut trouver en Python ou en R. Mais on trouve quand m√™me des choses int√©ressantes qui permettent de faire de la g√©omatique directement dans le navigateur web. Voici quelques exemples.</span></span>
<span id="cb47-173"><a href="#cb47-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-174"><a href="#cb47-174" aria-hidden="true" tabindex="-1"></a><span class="vs">**Les fonctionnalit√©s spatiales de `</span>d3<span class="op">.</span><span class="fu">js</span><span class="vs">`**</span></span>
<span id="cb47-175"><a href="#cb47-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-176"><a href="#cb47-176" aria-hidden="true" tabindex="-1"></a><span class="vs">::: columns</span></span>
<span id="cb47-177"><a href="#cb47-177" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="8%"}</span></span>
<span id="cb47-178"><a href="#cb47-178" aria-hidden="true" tabindex="-1"></a><span class="vs">![](fig/d3.png)</span></span>
<span id="cb47-179"><a href="#cb47-179" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb47-180"><a href="#cb47-180" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="2%"}</span></span>
<span id="cb47-181"><a href="#cb47-181" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb47-182"><a href="#cb47-182" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="90%"}</span></span>
<span id="cb47-183"><a href="#cb47-183" aria-hidden="true" tabindex="-1"></a><span class="vs">[**`</span>d3<span class="op">-</span><span class="fu">geo</span><span class="vs">`**](https://github.com/d3/d3-geo) est le module spatial de d3. Il permet de g√©rer les projections cartographiques, les formes sph√©riques et la trigonom√©trie sph√©rique. Voir aussi [**`</span>d3<span class="op">-</span>geo<span class="op">-</span><span class="fu">projection</span><span class="vs">`**](https://github.com/d3/d3-geo-projection). [**`</span>d3<span class="op">-</span><span class="fu">delaunay</span><span class="vs">`**](https://github.com/d3/d3-delaunay) est une biblioth√®que rapide pour calculer le diagramme de Vorono√Ø d'un ensemble de points bidimensionnels. Elle est bas√©e sur Delaunator, une biblioth√®que rapide pour calculer la triangulation de Delaunay en utilisant des algorithmes de balayage. Le diagramme de Vorono√Ø est construit en reliant les circonf√©rences des triangles adjacents dans la triangulation de Delaunay. [**`</span>d3<span class="op">-</span>geo<span class="op">-</span><span class="fu">voronoi</span><span class="vs">`**](https://github.com/Fil/d3-geo-voronoi) est une adaptation de d3-delaunay sur la sph√®re.</span></span>
<span id="cb47-184"><a href="#cb47-184" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb47-185"><a href="#cb47-185" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb47-186"><a href="#cb47-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-187"><a href="#cb47-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-188"><a href="#cb47-188" aria-hidden="true" tabindex="-1"></a><span class="vs">::: columns</span></span>
<span id="cb47-189"><a href="#cb47-189" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="8%"}</span></span>
<span id="cb47-190"><a href="#cb47-190" aria-hidden="true" tabindex="-1"></a><span class="vs">![](fig/topojson.svg)</span></span>
<span id="cb47-191"><a href="#cb47-191" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb47-192"><a href="#cb47-192" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="2%"}</span></span>
<span id="cb47-193"><a href="#cb47-193" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb47-194"><a href="#cb47-194" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="90%"}</span></span>
<span id="cb47-195"><a href="#cb47-195" aria-hidden="true" tabindex="-1"></a><span class="vs">[**`</span><span class="fu">TopoJSON</span><span class="vs">`**](https://github.com/topojson/topojson)  est une extension de GeoJSON. La librairie permet de r√©aliser des op√©rations SIG bas√©es sur la topologie (agr√©gation, voisins, simplification, etc.)</span></span>
<span id="cb47-196"><a href="#cb47-196" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb47-197"><a href="#cb47-197" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb47-198"><a href="#cb47-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-199"><a href="#cb47-199" aria-hidden="true" tabindex="-1"></a><span class="vs">**Les biblioth√®ques SIG**</span></span>
<span id="cb47-200"><a href="#cb47-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-201"><a href="#cb47-201" aria-hidden="true" tabindex="-1"></a><span class="vs">::: columns</span></span>
<span id="cb47-202"><a href="#cb47-202" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="8%"}</span></span>
<span id="cb47-203"><a href="#cb47-203" aria-hidden="true" tabindex="-1"></a><span class="vs">![](fig/turf.png)</span></span>
<span id="cb47-204"><a href="#cb47-204" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb47-205"><a href="#cb47-205" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="2%"}</span></span>
<span id="cb47-206"><a href="#cb47-206" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb47-207"><a href="#cb47-207" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="90%"}</span></span>
<span id="cb47-208"><a href="#cb47-208" aria-hidden="true" tabindex="-1"></a><span class="vs">[**`</span><span class="fu">turf</span><span class="vs">`**](https://turfjs.org/) est une biblioth√®que JavaScript pour l'analyse spatiale (de type SIG). Elle comprend les op√©rations spatiales traditionnelles, des fonctions d'aide pour la cr√©ation de donn√©es GeoJSON, ainsi que des outils de classification des donn√©es et de statistiques. L'avantage de turf est d'√™tre modulaire. On ne charge que ce dont on a besoin.</span></span>
<span id="cb47-209"><a href="#cb47-209" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb47-210"><a href="#cb47-210" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb47-211"><a href="#cb47-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-212"><a href="#cb47-212" aria-hidden="true" tabindex="-1"></a><span class="vs">::: columns</span></span>
<span id="cb47-213"><a href="#cb47-213" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="8%"}</span></span>
<span id="cb47-214"><a href="#cb47-214" aria-hidden="true" tabindex="-1"></a><span class="vs">![](fig/spljs.jpg)</span></span>
<span id="cb47-215"><a href="#cb47-215" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb47-216"><a href="#cb47-216" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="2%"}</span></span>
<span id="cb47-217"><a href="#cb47-217" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb47-218"><a href="#cb47-218" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="90%"}</span></span>
<span id="cb47-219"><a href="#cb47-219" aria-hidden="true" tabindex="-1"></a><span class="vs">[**`</span>spl<span class="op">.</span><span class="fu">js</span><span class="vs">`**](https://turfjs.org/) est une impl√©mentation de SpatiaLite (et de ses amis : sqlite, geos, proj, rttopo) pour le navigateur.</span></span>
<span id="cb47-220"><a href="#cb47-220" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb47-221"><a href="#cb47-221" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb47-222"><a href="#cb47-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-223"><a href="#cb47-223" aria-hidden="true" tabindex="-1"></a><span class="vs">::: columns</span></span>
<span id="cb47-224"><a href="#cb47-224" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="8%"}</span></span>
<span id="cb47-225"><a href="#cb47-225" aria-hidden="true" tabindex="-1"></a><span class="vs">![](fig/geotoolbox.svg)</span></span>
<span id="cb47-226"><a href="#cb47-226" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb47-227"><a href="#cb47-227" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="2%"}</span></span>
<span id="cb47-228"><a href="#cb47-228" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb47-229"><a href="#cb47-229" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="90%"}</span></span>
<span id="cb47-230"><a href="#cb47-230" aria-hidden="true" tabindex="-1"></a><span class="vs">[**`</span><span class="fu">geotoolbox</span><span class="vs">`**](https://github.com/neocarto/geotoolbox) est un outil javascript pour les g√©ographes bas√© sur d3geo, topojson et jsts. Il permet de traiter simplement les propri√©t√©s geojson et fournit plusieurs op√©rations SIG utiles pour la cartographie th√©matique.</span></span>
<span id="cb47-231"><a href="#cb47-231" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb47-232"><a href="#cb47-232" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb47-233"><a href="#cb47-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-234"><a href="#cb47-234" aria-hidden="true" tabindex="-1"></a><span class="vs">::: columns</span></span>
<span id="cb47-235"><a href="#cb47-235" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="8%"}</span></span>
<span id="cb47-236"><a href="#cb47-236" aria-hidden="true" tabindex="-1"></a><span class="vs">![](fig/gdal.png)</span></span>
<span id="cb47-237"><a href="#cb47-237" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb47-238"><a href="#cb47-238" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="2%"}</span></span>
<span id="cb47-239"><a href="#cb47-239" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb47-240"><a href="#cb47-240" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="90%"}</span></span>
<span id="cb47-241"><a href="#cb47-241" aria-hidden="true" tabindex="-1"></a><span class="vs">[**`</span>Gdals3<span class="op">.</span><span class="fu">js</span><span class="vs">`**](https://github.com/bugra9/gdal3.js) est un portage des applications Gdal (gdal_translate, ogr2ogr, gdal_rasterize, gdalwarp, gdaltransform) vers Webassembly. Il permet de convertir des donn√©es g√©ospatiales matricielles et vectorielles dans divers formats et syst√®mes de coordonn√©es.</span></span>
<span id="cb47-242"><a href="#cb47-242" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb47-243"><a href="#cb47-243" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb47-244"><a href="#cb47-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-245"><a href="#cb47-245" aria-hidden="true" tabindex="-1"></a><span class="vs">::: columns</span></span>
<span id="cb47-246"><a href="#cb47-246" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="8%"}</span></span>
<span id="cb47-247"><a href="#cb47-247" aria-hidden="true" tabindex="-1"></a><span class="vs">![](fig/proj4.png)</span></span>
<span id="cb47-248"><a href="#cb47-248" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb47-249"><a href="#cb47-249" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="2%"}</span></span>
<span id="cb47-250"><a href="#cb47-250" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb47-251"><a href="#cb47-251" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="90%"}</span></span>
<span id="cb47-252"><a href="#cb47-252" aria-hidden="true" tabindex="-1"></a><span class="vs">[**`</span><span class="fu">proj4js</span><span class="vs">`**](http://proj4js.org/) est une biblioth√®que JavaScript permettant de transformer les coordonn√©es d'un syst√®me de coordonn√©es √† un autre, y compris les transformations de datum</span></span>
<span id="cb47-253"><a href="#cb47-253" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb47-254"><a href="#cb47-254" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb47-255"><a href="#cb47-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-256"><a href="#cb47-256" aria-hidden="true" tabindex="-1"></a><span class="vs">**Dataviz / cartographie**</span></span>
<span id="cb47-257"><a href="#cb47-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-258"><a href="#cb47-258" aria-hidden="true" tabindex="-1"></a><span class="vs">::: columns</span></span>
<span id="cb47-259"><a href="#cb47-259" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="8%"}</span></span>
<span id="cb47-260"><a href="#cb47-260" aria-hidden="true" tabindex="-1"></a><span class="vs">![](fig/plot.png)</span></span>
<span id="cb47-261"><a href="#cb47-261" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb47-262"><a href="#cb47-262" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="2%"}</span></span>
<span id="cb47-263"><a href="#cb47-263" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb47-264"><a href="#cb47-264" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="90%"}</span></span>
<span id="cb47-265"><a href="#cb47-265" aria-hidden="true" tabindex="-1"></a><span class="vs">[**`</span><span class="fu">plot</span><span class="vs">`**](https://observablehq.com/plot/) est la biblioth√®que de visualisation de donn√©e d√©velopp√©e par Observable (Mike Bostock et Philippe Rivi√®re). Au d√©part pens√©e pour la visualisation de donn√©es statistiques, elle permet aujourd'hui de r√©aliser des cartes. Plot est disponible par d√©faut dans les cellules {ojs}.</span></span>
<span id="cb47-266"><a href="#cb47-266" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb47-267"><a href="#cb47-267" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb47-268"><a href="#cb47-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-269"><a href="#cb47-269" aria-hidden="true" tabindex="-1"></a><span class="vs">::: columns</span></span>
<span id="cb47-270"><a href="#cb47-270" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="8%"}</span></span>
<span id="cb47-271"><a href="#cb47-271" aria-hidden="true" tabindex="-1"></a><span class="vs">![](fig/vega.png)</span></span>
<span id="cb47-272"><a href="#cb47-272" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb47-273"><a href="#cb47-273" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="2%"}</span></span>
<span id="cb47-274"><a href="#cb47-274" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb47-275"><a href="#cb47-275" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="90%"}</span></span>
<span id="cb47-276"><a href="#cb47-276" aria-hidden="true" tabindex="-1"></a><span class="vs">[**`</span>vega<span class="op">-</span><span class="fu">lite</span><span class="vs">`**](https://github.com/vega/vega-lite) est un outil de visualisation mettant en ≈ìuvre une grammaire graphique, similaire √† ggplot2. Cette biblioth√®que est disponible par d√©faut dans les cellules {ojs}.</span></span>
<span id="cb47-277"><a href="#cb47-277" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb47-278"><a href="#cb47-278" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb47-279"><a href="#cb47-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-280"><a href="#cb47-280" aria-hidden="true" tabindex="-1"></a><span class="vs">::: columns</span></span>
<span id="cb47-281"><a href="#cb47-281" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="8%"}</span></span>
<span id="cb47-282"><a href="#cb47-282" aria-hidden="true" tabindex="-1"></a><span class="vs">![](fig/bertin.png)</span></span>
<span id="cb47-283"><a href="#cb47-283" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb47-284"><a href="#cb47-284" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="2%"}</span></span>
<span id="cb47-285"><a href="#cb47-285" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb47-286"><a href="#cb47-286" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="90%"}</span></span>
<span id="cb47-287"><a href="#cb47-287" aria-hidden="true" tabindex="-1"></a><span class="vs">[**`</span><span class="fu">bertin</span><span class="vs">`**](https://github.com/neocarto/bertin) est une biblioth√®que √©crite en JavaScript qui permet de r√©aliser des cartes th√©matiques pour le web. Sa conception vise √† permettre aux utilisateurs de cr√©er rapidement des cartes th√©matiques interactives sans forcement conna√Ætre le langage JavaScript.</span></span>
<span id="cb47-288"><a href="#cb47-288" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb47-289"><a href="#cb47-289" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb47-290"><a href="#cb47-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-291"><a href="#cb47-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-292"><a href="#cb47-292" aria-hidden="true" tabindex="-1"></a><span class="vs">::: columns</span></span>
<span id="cb47-293"><a href="#cb47-293" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="8%"}</span></span>
<span id="cb47-294"><a href="#cb47-294" aria-hidden="true" tabindex="-1"></a><span class="vs">![](fig/gridviz.png)</span></span>
<span id="cb47-295"><a href="#cb47-295" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb47-296"><a href="#cb47-296" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="2%"}</span></span>
<span id="cb47-297"><a href="#cb47-297" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb47-298"><a href="#cb47-298" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="90%"}</span></span>
<span id="cb47-299"><a href="#cb47-299" aria-hidden="true" tabindex="-1"></a><span class="vs">[**`</span><span class="fu">Gridviz</span><span class="vs">`**](https://github.com/eurostat/gridviz) est une biblioth√®que JavaScript bas√©e sur WebGL d√©velopp√©e par Julien Gaffuri et Joe Davies. Elle permet de visualiser des donn√©es carroy√©es (ou tout ensemble de donn√©es tabulaires avec une position x/y) dans le navigateur dans une grande vari√©t√© de styles cartographiques. </span></span>
<span id="cb47-300"><a href="#cb47-300" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb47-301"><a href="#cb47-301" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb47-302"><a href="#cb47-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-303"><a href="#cb47-303" aria-hidden="true" tabindex="-1"></a><span class="vs">::: columns</span></span>
<span id="cb47-304"><a href="#cb47-304" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="8%"}</span></span>
<span id="cb47-305"><a href="#cb47-305" aria-hidden="true" tabindex="-1"></a><span class="vs">![](fig/logo-go-cart-wasm.png)</span></span>
<span id="cb47-306"><a href="#cb47-306" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb47-307"><a href="#cb47-307" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="2%"}</span></span>
<span id="cb47-308"><a href="#cb47-308" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb47-309"><a href="#cb47-309" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.column width="90%"}</span></span>
<span id="cb47-310"><a href="#cb47-310" aria-hidden="true" tabindex="-1"></a><span class="vs">[**`</span>go<span class="op">-</span>cart<span class="op">-</span><span class="fu">wasm</span><span class="vs">`**](https://github.com/riatelab/go-cart-wasm) est une biblioth√®que JS/WASM permettant de r√©aliser des cartogrammes bas√©s sur le flux (comme d√©crit dans "Gastner, Seguy, and More (2018). </span></span>
<span id="cb47-311"><a href="#cb47-311" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb47-312"><a href="#cb47-312" aria-hidden="true" tabindex="-1"></a><span class="vs">::::</span></span>
<span id="cb47-313"><a href="#cb47-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-314"><a href="#cb47-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-315"><a href="#cb47-315" aria-hidden="true" tabindex="-1"></a><span class="vs">### Importer des donn√©es</span></span>
<span id="cb47-316"><a href="#cb47-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-317"><a href="#cb47-317" aria-hidden="true" tabindex="-1"></a><span class="vs">Pour importer des donn√©es en **`</span>{ojs}<span class="vs">`**, on utilise l'instruction **`</span><span class="fu">FileAttachment</span>()<span class="vs">`** </span></span>
<span id="cb47-318"><a href="#cb47-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-319"><a href="#cb47-319" aria-hidden="true" tabindex="-1"></a><span class="vs">Pour un fichier JSON </span></span>
<span id="cb47-320"><a href="#cb47-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-321"><a href="#cb47-321" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span>js</span>
<span id="cb47-322"><a href="#cb47-322" aria-hidden="true" tabindex="-1"></a>mrc <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"geom/mrc.geojson"</span>)<span class="op">.</span><span class="fu">json</span>()</span>
<span id="cb47-323"><a href="#cb47-323" aria-hidden="true" tabindex="-1"></a>munic <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"geom/munic.geojson"</span>)<span class="op">.</span><span class="fu">json</span>()</span>
<span id="cb47-324"><a href="#cb47-324" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb47-325"><a href="#cb47-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-326"><a href="#cb47-326" aria-hidden="true" tabindex="-1"></a><span class="vs">Pour un fichier csv</span></span>
<span id="cb47-327"><a href="#cb47-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-328"><a href="#cb47-328" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span>js</span>
<span id="cb47-329"><a href="#cb47-329" aria-hidden="true" tabindex="-1"></a><span class="fu">FileAttachment</span>(<span class="st">"data.csv"</span>)<span class="op">.</span><span class="fu">csv</span>({<span class="dt">typed</span><span class="op">:</span> <span class="kw">true</span>})</span>
<span id="cb47-330"><a href="#cb47-330" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb47-331"><a href="#cb47-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-332"><a href="#cb47-332" aria-hidden="true" tabindex="-1"></a><span class="vs">On peut aussi r√©cup√©rer des donn√©es depuis R ou Python avec l'instruction **`</span><span class="fu">ojs_define</span><span class="vs">`**</span></span>
<span id="cb47-333"><a href="#cb47-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-336"><a href="#cb47-336" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb47-337"><a href="#cb47-337" aria-hidden="true" tabindex="-1"></a><span class="co">//| eval: false</span></span>
<span id="cb47-338"><a href="#cb47-338" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: true</span></span>
<span id="cb47-339"><a href="#cb47-339" aria-hidden="true" tabindex="-1"></a>mrc <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"geom/mrc.geojson"</span>)<span class="op">.</span><span class="fu">json</span>()</span>
<span id="cb47-340"><a href="#cb47-340" aria-hidden="true" tabindex="-1"></a>munic <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"geom/munic.geojson"</span>)<span class="op">.</span><span class="fu">json</span>()</span>
<span id="cb47-341"><a href="#cb47-341" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb47-342"><a href="#cb47-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-343"><a href="#cb47-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-344"><a href="#cb47-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-347"><a href="#cb47-347" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb47-348"><a href="#cb47-348" aria-hidden="true" tabindex="-1"></a><span class="co">//| eval: true</span></span>
<span id="cb47-349"><a href="#cb47-349" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb47-350"><a href="#cb47-350" aria-hidden="true" tabindex="-1"></a>tmp <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"geom/munic.geojson"</span>)<span class="op">.</span><span class="fu">json</span>()</span>
<span id="cb47-351"><a href="#cb47-351" aria-hidden="true" tabindex="-1"></a>munic <span class="op">=</span>  geo<span class="op">.</span><span class="fu">rewind</span>(geo<span class="op">.</span><span class="fu">simplify</span>(tmp<span class="op">,</span> {<span class="dt">k</span><span class="op">:</span><span class="fl">0.1</span>}))</span>
<span id="cb47-352"><a href="#cb47-352" aria-hidden="true" tabindex="-1"></a>tmp2 <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"geom/mrc.geojson"</span>)<span class="op">.</span><span class="fu">json</span>()</span>
<span id="cb47-353"><a href="#cb47-353" aria-hidden="true" tabindex="-1"></a>mrc <span class="op">=</span>  geo<span class="op">.</span><span class="fu">rewind</span>(geo<span class="op">.</span><span class="fu">simplify</span>(tmp2<span class="op">,</span> {<span class="dt">k</span><span class="op">:</span><span class="fl">0.1</span>}))</span>
<span id="cb47-354"><a href="#cb47-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-355"><a href="#cb47-355" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb47-356"><a href="#cb47-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-357"><a href="#cb47-357" aria-hidden="true" tabindex="-1"></a><span class="vs">### Visualiser les donn√©es stats</span></span>
<span id="cb47-358"><a href="#cb47-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-359"><a href="#cb47-359" aria-hidden="true" tabindex="-1"></a><span class="vs">Pour regarder la table attributaire, on utilise **`</span>Inputs<span class="op">.</span><span class="fu">table</span>()<span class="vs">`**</span></span>
<span id="cb47-360"><a href="#cb47-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-363"><a href="#cb47-363" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb47-364"><a href="#cb47-364" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">table</span>(munic<span class="op">.</span><span class="at">features</span><span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">properties</span>))</span>
<span id="cb47-365"><a href="#cb47-365" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb47-366"><a href="#cb47-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-367"><a href="#cb47-367" aria-hidden="true" tabindex="-1"></a><span class="vs">Avec **`</span>{ojs}<span class="vs">`**, on va aussi pouvoir faire des graphiques avec la biblioth√®que **`</span><span class="fu">plot</span><span class="vs">`**. Pour cela, on fait quelques manipulations de donn√©es.</span></span>
<span id="cb47-368"><a href="#cb47-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-369"><a href="#cb47-369" aria-hidden="true" tabindex="-1"></a><span class="vs">Tout d'abord, on r√©cup√®re les noms des 20 communes les plus peupl√©es, class√©es par ordre d√©croissant de population.</span></span>
<span id="cb47-370"><a href="#cb47-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-373"><a href="#cb47-373" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb47-374"><a href="#cb47-374" aria-hidden="true" tabindex="-1"></a>communes <span class="op">=</span> munic<span class="op">.</span><span class="at">features</span></span>
<span id="cb47-375"><a href="#cb47-375" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">properties</span>)</span>
<span id="cb47-376"><a href="#cb47-376" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">sort</span>((a<span class="op">,</span> b) <span class="kw">=&gt;</span> d3<span class="op">.</span><span class="fu">descending</span>(a<span class="op">.</span><span class="at">POP_2022</span><span class="op">,</span> b<span class="op">.</span><span class="at">POP_2022</span>))</span>
<span id="cb47-377"><a href="#cb47-377" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">MUS_NM_MUN</span>)</span>
<span id="cb47-378"><a href="#cb47-378" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">20</span>)</span>
<span id="cb47-379"><a href="#cb47-379" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb47-380"><a href="#cb47-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-383"><a href="#cb47-383" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb47-384"><a href="#cb47-384" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb47-385"><a href="#cb47-385" aria-hidden="true" tabindex="-1"></a><span class="co">//| eval: true</span></span>
<span id="cb47-386"><a href="#cb47-386" aria-hidden="true" tabindex="-1"></a>communes</span>
<span id="cb47-387"><a href="#cb47-387" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb47-388"><a href="#cb47-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-389"><a href="#cb47-389" aria-hidden="true" tabindex="-1"></a><span class="vs">On met en forme les donn√©es. </span></span>
<span id="cb47-390"><a href="#cb47-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-393"><a href="#cb47-393" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb47-394"><a href="#cb47-394" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> {</span>
<span id="cb47-395"><a href="#cb47-395" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> arr <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb47-396"><a href="#cb47-396" aria-hidden="true" tabindex="-1"></a>  communes<span class="op">.</span><span class="fu">forEach</span>((d) <span class="kw">=&gt;</span> {</span>
<span id="cb47-397"><a href="#cb47-397" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> tmp <span class="op">=</span> munic<span class="op">.</span><span class="at">features</span></span>
<span id="cb47-398"><a href="#cb47-398" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">properties</span>)</span>
<span id="cb47-399"><a href="#cb47-399" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">find</span>((x) <span class="kw">=&gt;</span> x<span class="op">.</span><span class="at">MUS_NM_MUN</span> <span class="op">==</span> d)<span class="op">;</span></span>
<span id="cb47-400"><a href="#cb47-400" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">2001</span><span class="op">;</span> i <span class="op">&lt;=</span> <span class="dv">2022</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb47-401"><a href="#cb47-401" aria-hidden="true" tabindex="-1"></a>      arr<span class="op">.</span><span class="fu">push</span>({ <span class="dt">year</span><span class="op">:</span> i<span class="op">,</span> <span class="dt">pop</span><span class="op">:</span> tmp[<span class="st">"POP_"</span> <span class="op">+</span> i]<span class="op">,</span> <span class="dt">com</span><span class="op">:</span> d })<span class="op">;</span></span>
<span id="cb47-402"><a href="#cb47-402" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb47-403"><a href="#cb47-403" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb47-404"><a href="#cb47-404" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> arr<span class="op">;</span></span>
<span id="cb47-405"><a href="#cb47-405" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-406"><a href="#cb47-406" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb47-407"><a href="#cb47-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-410"><a href="#cb47-410" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb47-411"><a href="#cb47-411" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb47-412"><a href="#cb47-412" aria-hidden="true" tabindex="-1"></a><span class="co">//| eval: true</span></span>
<span id="cb47-413"><a href="#cb47-413" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">table</span>(data<span class="op">,</span> {<span class="dt">width</span><span class="op">:</span><span class="dv">250</span><span class="op">,</span> <span class="dt">height</span><span class="op">:</span><span class="dv">250</span>})</span>
<span id="cb47-414"><a href="#cb47-414" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb47-415"><a href="#cb47-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-416"><a href="#cb47-416" aria-hidden="true" tabindex="-1"></a><span class="vs">Puis on r√©alise le graphique avec `</span><span class="fu">plot</span><span class="vs">` en proposant de s√©lectionner une commune.</span></span>
<span id="cb47-417"><a href="#cb47-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-420"><a href="#cb47-420" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb47-421"><a href="#cb47-421" aria-hidden="true" tabindex="-1"></a>viewof commune <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">select</span>(communes<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"Commune"</span> })</span>
<span id="cb47-422"><a href="#cb47-422" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb47-423"><a href="#cb47-423" aria-hidden="true" tabindex="-1"></a>  <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb47-424"><a href="#cb47-424" aria-hidden="true" tabindex="-1"></a>  <span class="dt">x</span><span class="op">:</span> {</span>
<span id="cb47-425"><a href="#cb47-425" aria-hidden="true" tabindex="-1"></a>    <span class="dt">label</span><span class="op">:</span> <span class="st">"Ann√©es ‚Üí"</span><span class="op">,</span></span>
<span id="cb47-426"><a href="#cb47-426" aria-hidden="true" tabindex="-1"></a>    <span class="dt">tickFormat</span><span class="op">:</span> <span class="st">""</span></span>
<span id="cb47-427"><a href="#cb47-427" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb47-428"><a href="#cb47-428" aria-hidden="true" tabindex="-1"></a>  <span class="dt">y</span><span class="op">:</span> {</span>
<span id="cb47-429"><a href="#cb47-429" aria-hidden="true" tabindex="-1"></a>    <span class="dt">label</span><span class="op">:</span> <span class="vs">`‚Üë Population (</span><span class="sc">${</span>commune<span class="sc">}</span><span class="vs">)`</span></span>
<span id="cb47-430"><a href="#cb47-430" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb47-431"><a href="#cb47-431" aria-hidden="true" tabindex="-1"></a>  <span class="dt">color</span><span class="op">:</span> { <span class="dt">legend</span><span class="op">:</span> <span class="kw">true</span> }<span class="op">,</span></span>
<span id="cb47-432"><a href="#cb47-432" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marginLeft</span><span class="op">:</span> <span class="dv">60</span><span class="op">,</span></span>
<span id="cb47-433"><a href="#cb47-433" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb47-434"><a href="#cb47-434" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">lineY</span>(data<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">com</span> <span class="op">==</span> commune)<span class="op">,</span> {</span>
<span id="cb47-435"><a href="#cb47-435" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span></span>
<span id="cb47-436"><a href="#cb47-436" aria-hidden="true" tabindex="-1"></a>      <span class="dt">y</span><span class="op">:</span> <span class="st">"pop"</span><span class="op">,</span></span>
<span id="cb47-437"><a href="#cb47-437" aria-hidden="true" tabindex="-1"></a>      <span class="dt">stroke</span><span class="op">:</span> <span class="st">"red"</span><span class="op">,</span></span>
<span id="cb47-438"><a href="#cb47-438" aria-hidden="true" tabindex="-1"></a>      <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">2</span></span>
<span id="cb47-439"><a href="#cb47-439" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb47-440"><a href="#cb47-440" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb47-441"><a href="#cb47-441" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb47-442"><a href="#cb47-442" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb47-443"><a href="#cb47-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-444"><a href="#cb47-444" aria-hidden="true" tabindex="-1"></a><span class="vs">### Visualiser les g√©m√©tries</span></span>
<span id="cb47-445"><a href="#cb47-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-446"><a href="#cb47-446" aria-hidden="true" tabindex="-1"></a><span class="vs">Comme leaflet est disponible dans les cellules {ojs}, on peut directement afficher les g√©om√©tries.</span></span>
<span id="cb47-447"><a href="#cb47-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-450"><a href="#cb47-450" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb47-451"><a href="#cb47-451" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb47-452"><a href="#cb47-452" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> container <span class="op">=</span> <span class="kw">yield</span> htl<span class="op">.</span><span class="fu">html</span><span class="vs">`&lt;div style="height: 500px;"&gt;`</span><span class="op">;</span></span>
<span id="cb47-453"><a href="#cb47-453" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> map <span class="op">=</span> L<span class="op">.</span><span class="fu">map</span>(container)<span class="op">;</span></span>
<span id="cb47-454"><a href="#cb47-454" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> layer <span class="op">=</span> L<span class="op">.</span><span class="fu">geoJSON</span>(mrc)<span class="op">.</span><span class="fu">addTo</span>(map)<span class="op">;</span></span>
<span id="cb47-455"><a href="#cb47-455" aria-hidden="true" tabindex="-1"></a>  map<span class="op">.</span><span class="fu">fitBounds</span>(layer<span class="op">.</span><span class="fu">getBounds</span>()<span class="op">,</span> { <span class="dt">maxZoom</span><span class="op">:</span> <span class="dv">9</span> })<span class="op">;</span></span>
<span id="cb47-456"><a href="#cb47-456" aria-hidden="true" tabindex="-1"></a>  L<span class="op">.</span><span class="fu">tileLayer</span>(<span class="st">"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"</span><span class="op">,</span> {</span>
<span id="cb47-457"><a href="#cb47-457" aria-hidden="true" tabindex="-1"></a>    <span class="dt">attribution</span><span class="op">:</span></span>
<span id="cb47-458"><a href="#cb47-458" aria-hidden="true" tabindex="-1"></a>      <span class="st">"¬© &lt;a href=https://www.openstreetmap.org/copyright&gt;OpenStreetMap&lt;/a&gt; contributors"</span></span>
<span id="cb47-459"><a href="#cb47-459" aria-hidden="true" tabindex="-1"></a>  })<span class="op">.</span><span class="fu">addTo</span>(map)<span class="op">;</span></span>
<span id="cb47-460"><a href="#cb47-460" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-461"><a href="#cb47-461" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb47-462"><a href="#cb47-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-463"><a href="#cb47-463" aria-hidden="true" tabindex="-1"></a><span class="vs">On peut √©galement afficher la carte simplement avec la biblioth√®que [**`</span><span class="fu">bertin</span><span class="vs">`**](https://github.com/neocarto/bertin).</span></span>
<span id="cb47-464"><a href="#cb47-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-467"><a href="#cb47-467" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb47-468"><a href="#cb47-468" aria-hidden="true" tabindex="-1"></a>bertin <span class="op">=</span> <span class="pp">require</span>(<span class="st">"bertin"</span>)</span>
<span id="cb47-469"><a href="#cb47-469" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb47-470"><a href="#cb47-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-473"><a href="#cb47-473" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb47-474"><a href="#cb47-474" aria-hidden="true" tabindex="-1"></a>bertin<span class="op">.</span><span class="fu">quickdraw</span>(mrc)</span>
<span id="cb47-475"><a href="#cb47-475" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb47-476"><a href="#cb47-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-477"><a href="#cb47-477" aria-hidden="true" tabindex="-1"></a><span class="vs">### Un peu de SIG</span></span>
<span id="cb47-478"><a href="#cb47-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-479"><a href="#cb47-479" aria-hidden="true" tabindex="-1"></a><span class="vs">La bibioth√®que **`</span><span class="fu">geotoolbox</span><span class="vs">`** permet de faire facilement differentes operations SIG.</span></span>
<span id="cb47-480"><a href="#cb47-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-483"><a href="#cb47-483" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb47-484"><a href="#cb47-484" aria-hidden="true" tabindex="-1"></a>geo <span class="op">=</span> <span class="pp">require</span>(<span class="st">"geotoolbox"</span>)</span>
<span id="cb47-485"><a href="#cb47-485" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb47-486"><a href="#cb47-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-487"><a href="#cb47-487" aria-hidden="true" tabindex="-1"></a><span class="vs">- **Simplification**</span></span>
<span id="cb47-488"><a href="#cb47-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-489"><a href="#cb47-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-492"><a href="#cb47-492" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb47-493"><a href="#cb47-493" aria-hidden="true" tabindex="-1"></a>viewof simpl <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="fl">0.0001</span><span class="op">,</span> <span class="fl">0.2</span>]<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"Simplification"</span><span class="op">,</span>  <span class="dt">value</span><span class="op">:</span> <span class="fl">0.1</span> })</span>
<span id="cb47-494"><a href="#cb47-494" aria-hidden="true" tabindex="-1"></a>mrc2 <span class="op">=</span> geo<span class="op">.</span><span class="fu">simplify</span>(mrc<span class="op">,</span> { <span class="dt">k</span><span class="op">:</span> simpl })</span>
<span id="cb47-495"><a href="#cb47-495" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb47-496"><a href="#cb47-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-499"><a href="#cb47-499" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb47-500"><a href="#cb47-500" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb47-501"><a href="#cb47-501" aria-hidden="true" tabindex="-1"></a>bertin<span class="op">.</span><span class="fu">draw</span>({<span class="dt">params</span><span class="op">:</span>{<span class="dt">extent</span><span class="op">:</span> munic}<span class="op">,</span><span class="dt">layers</span><span class="op">:</span>[{<span class="dt">geojson</span><span class="op">:</span> mrc2<span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span><span class="st">"black"</span><span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span><span class="fl">1.5</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span><span class="st">"white"</span><span class="op">,</span> <span class="dt">rewind</span><span class="op">:</span> <span class="kw">true</span>}]})</span>
<span id="cb47-502"><a href="#cb47-502" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb47-503"><a href="#cb47-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-504"><a href="#cb47-504" aria-hidden="true" tabindex="-1"></a><span class="vs">- **Centroid**</span></span>
<span id="cb47-505"><a href="#cb47-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-508"><a href="#cb47-508" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb47-509"><a href="#cb47-509" aria-hidden="true" tabindex="-1"></a>ctr <span class="op">=</span> geo<span class="op">.</span><span class="fu">centroid</span>(mrc)</span>
<span id="cb47-510"><a href="#cb47-510" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb47-513"><a href="#cb47-513" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb47-514"><a href="#cb47-514" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb47-515"><a href="#cb47-515" aria-hidden="true" tabindex="-1"></a>bertin<span class="op">.</span><span class="fu">draw</span>({<span class="dt">params</span><span class="op">:</span>{<span class="dt">extent</span><span class="op">:</span> mrc}<span class="op">,</span> <span class="dt">layers</span><span class="op">:</span>[{<span class="dt">geojson</span><span class="op">:</span> ctr<span class="op">,</span> <span class="dt">fill</span><span class="op">:</span><span class="st">"red"</span>}<span class="op">,</span>{<span class="dt">geojson</span><span class="op">:</span> mrc<span class="op">,</span> <span class="dt">fill</span><span class="op">:</span><span class="st">"#CCC"</span>}<span class="op">,</span> ]}) </span>
<span id="cb47-516"><a href="#cb47-516" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb47-517"><a href="#cb47-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-518"><a href="#cb47-518" aria-hidden="true" tabindex="-1"></a><span class="vs">- **Buffer**</span></span>
<span id="cb47-519"><a href="#cb47-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-522"><a href="#cb47-522" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb47-523"><a href="#cb47-523" aria-hidden="true" tabindex="-1"></a>quebec <span class="op">=</span> geo<span class="op">.</span><span class="fu">filter</span>(mrc<span class="op">,</span> (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">MUS_CO_MRC</span> <span class="op">==</span> <span class="st">"23"</span>)</span>
<span id="cb47-524"><a href="#cb47-524" aria-hidden="true" tabindex="-1"></a>buff <span class="op">=</span> geo<span class="op">.</span><span class="fu">buffer</span>(quebec<span class="op">,</span> { <span class="dt">dist</span><span class="op">:</span> distance})</span>
<span id="cb47-525"><a href="#cb47-525" aria-hidden="true" tabindex="-1"></a>ctr2 <span class="op">=</span> geo<span class="op">.</span><span class="fu">clip</span>(ctr<span class="op">,</span> {<span class="dt">clip</span><span class="op">:</span> buff})</span>
<span id="cb47-526"><a href="#cb47-526" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb47-527"><a href="#cb47-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-530"><a href="#cb47-530" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb47-531"><a href="#cb47-531" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb47-532"><a href="#cb47-532" aria-hidden="true" tabindex="-1"></a>viewof distance <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">500</span>]<span class="op">,</span> {</span>
<span id="cb47-533"><a href="#cb47-533" aria-hidden="true" tabindex="-1"></a>  <span class="dt">label</span><span class="op">:</span> <span class="st">"Distance"</span><span class="op">,</span></span>
<span id="cb47-534"><a href="#cb47-534" aria-hidden="true" tabindex="-1"></a>  <span class="dt">value</span><span class="op">:</span> <span class="dv">300</span><span class="op">,</span></span>
<span id="cb47-535"><a href="#cb47-535" aria-hidden="true" tabindex="-1"></a>  <span class="dt">step</span><span class="op">:</span> <span class="dv">10</span></span>
<span id="cb47-536"><a href="#cb47-536" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb47-537"><a href="#cb47-537" aria-hidden="true" tabindex="-1"></a>bertin<span class="op">.</span><span class="fu">draw</span>({<span class="dt">layers</span><span class="op">:</span>[{<span class="dt">geojson</span><span class="op">:</span> quebec<span class="op">,</span> <span class="dt">fill</span><span class="op">:</span><span class="st">"red"</span>}<span class="op">,</span> {<span class="dt">geojson</span><span class="op">:</span> ctr2<span class="op">,</span> <span class="dt">fill</span><span class="op">:</span><span class="st">"red"</span>}<span class="op">,</span> {<span class="dt">geojson</span><span class="op">:</span> buff<span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span><span class="st">"red"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"none"</span><span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span><span class="dv">2</span>}<span class="op">,</span>{<span class="dt">geojson</span><span class="op">:</span> mrc<span class="op">,</span> <span class="dt">fill</span><span class="op">:</span><span class="st">"#CCC"</span>}<span class="op">,</span> ]}) </span>
<span id="cb47-538"><a href="#cb47-538" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb47-539"><a href="#cb47-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-540"><a href="#cb47-540" aria-hidden="true" tabindex="-1"></a><span class="vs">**Cr√©ation de cartes th√©matiques**</span></span>
<span id="cb47-541"><a href="#cb47-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-542"><a href="#cb47-542" aria-hidden="true" tabindex="-1"></a><span class="vs">Pour cr√©er des cartes th√©matiques, on peut utiliser la biblioth√®que [**`</span><span class="fu">bertin</span><span class="vs">`**](https://github.com/neocarto/bertin)</span></span>
<span id="cb47-543"><a href="#cb47-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-544"><a href="#cb47-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-545"><a href="#cb47-545" aria-hidden="true" tabindex="-1"></a><span class="vs">La fonction **`</span><span class="fu">draw</span><span class="vs">`** permet de r√©aliser n'importe quel type de carte. </span></span>
<span id="cb47-546"><a href="#cb47-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-547"><a href="#cb47-547" aria-hidden="true" tabindex="-1"></a><span class="vs">![](fig/bertin_code.png)</span></span>
<span id="cb47-548"><a href="#cb47-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-549"><a href="#cb47-549" aria-hidden="true" tabindex="-1"></a><span class="vs">Par d√©faut, la couche s'affiche simplement.</span></span>
<span id="cb47-550"><a href="#cb47-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-553"><a href="#cb47-553" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb47-554"><a href="#cb47-554" aria-hidden="true" tabindex="-1"></a>bertin<span class="op">.</span><span class="fu">draw</span>({<span class="dt">layers</span><span class="op">:</span>[{<span class="dt">geojson</span><span class="op">:</span> munic<span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"#d18de0"</span>}]})</span>
<span id="cb47-555"><a href="#cb47-555" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb47-556"><a href="#cb47-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-557"><a href="#cb47-557" aria-hidden="true" tabindex="-1"></a><span class="vs">On peut ajouter l'attrubut **`</span><span class="fu">tooltip</span><span class="vs">`** pour afficher des infobulles.</span></span>
<span id="cb47-558"><a href="#cb47-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-561"><a href="#cb47-561" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb47-562"><a href="#cb47-562" aria-hidden="true" tabindex="-1"></a>bertin<span class="op">.</span><span class="fu">draw</span>({</span>
<span id="cb47-563"><a href="#cb47-563" aria-hidden="true" tabindex="-1"></a>  <span class="dt">layers</span><span class="op">:</span>[</span>
<span id="cb47-564"><a href="#cb47-564" aria-hidden="true" tabindex="-1"></a>    { </span>
<span id="cb47-565"><a href="#cb47-565" aria-hidden="true" tabindex="-1"></a>      <span class="dt">geojson</span><span class="op">:</span> munic<span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"#d18de0"</span><span class="op">,</span></span>
<span id="cb47-566"><a href="#cb47-566" aria-hidden="true" tabindex="-1"></a>      <span class="dt">tooltip</span><span class="op">:</span> <span class="st">"$MUS_NM_MUN"</span></span>
<span id="cb47-567"><a href="#cb47-567" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb47-568"><a href="#cb47-568" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb47-569"><a href="#cb47-569" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb47-570"><a href="#cb47-570" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb47-571"><a href="#cb47-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-572"><a href="#cb47-572" aria-hidden="true" tabindex="-1"></a><span class="vs">**Cartographie th√©matique**</span></span>
<span id="cb47-573"><a href="#cb47-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-574"><a href="#cb47-574" aria-hidden="true" tabindex="-1"></a><span class="vs">A pr√©sent, r√©alisons une carte de la population en 2022. Pour cela, on utilise le type **`</span><span class="fu">bubble</span><span class="vs">`**.</span></span>
<span id="cb47-575"><a href="#cb47-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-576"><a href="#cb47-576" aria-hidden="true" tabindex="-1"></a><span class="vs">Par d√©faut, √ßa donne ceci :</span></span>
<span id="cb47-577"><a href="#cb47-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-580"><a href="#cb47-580" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb47-581"><a href="#cb47-581" aria-hidden="true" tabindex="-1"></a>bertin<span class="op">.</span><span class="fu">draw</span>({</span>
<span id="cb47-582"><a href="#cb47-582" aria-hidden="true" tabindex="-1"></a>    <span class="dt">layers</span><span class="op">:</span> [</span>
<span id="cb47-583"><a href="#cb47-583" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb47-584"><a href="#cb47-584" aria-hidden="true" tabindex="-1"></a>        <span class="dt">type</span><span class="op">:</span> <span class="st">"bubble"</span><span class="op">,</span></span>
<span id="cb47-585"><a href="#cb47-585" aria-hidden="true" tabindex="-1"></a>        <span class="dt">geojson</span><span class="op">:</span> munic<span class="op">,</span> </span>
<span id="cb47-586"><a href="#cb47-586" aria-hidden="true" tabindex="-1"></a>        <span class="dt">values</span><span class="op">:</span> <span class="st">"POP_2022"</span><span class="op">,</span> </span>
<span id="cb47-587"><a href="#cb47-587" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fill</span><span class="op">:</span><span class="st">"red"</span></span>
<span id="cb47-588"><a href="#cb47-588" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb47-589"><a href="#cb47-589" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb47-590"><a href="#cb47-590" aria-hidden="true" tabindex="-1"></a>        <span class="dt">geojson</span><span class="op">:</span> munic<span class="op">,</span></span>
<span id="cb47-591"><a href="#cb47-591" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fill</span><span class="op">:</span> <span class="st">"#CCC"</span></span>
<span id="cb47-592"><a href="#cb47-592" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span> </span>
<span id="cb47-593"><a href="#cb47-593" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb47-594"><a href="#cb47-594" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb47-595"><a href="#cb47-595" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb47-596"><a href="#cb47-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-597"><a href="#cb47-597" aria-hidden="true" tabindex="-1"></a><span class="vs">Et en param√©trant un peu, on obtient ceci.</span></span>
<span id="cb47-598"><a href="#cb47-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-599"><a href="#cb47-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-602"><a href="#cb47-602" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb47-603"><a href="#cb47-603" aria-hidden="true" tabindex="-1"></a>bertin<span class="op">.</span><span class="fu">draw</span>({</span>
<span id="cb47-604"><a href="#cb47-604" aria-hidden="true" tabindex="-1"></a>  <span class="dt">params</span><span class="op">:</span> { <span class="dt">extent</span><span class="op">:</span> [[<span class="op">-</span><span class="dv">79</span><span class="op">,</span> <span class="fl">44.5</span>]<span class="op">,</span> [<span class="op">-</span><span class="dv">66</span><span class="op">,</span> <span class="dv">51</span>]]}<span class="op">,</span></span>
<span id="cb47-605"><a href="#cb47-605" aria-hidden="true" tabindex="-1"></a>  <span class="dt">layers</span><span class="op">:</span> [</span>
<span id="cb47-606"><a href="#cb47-606" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">type</span><span class="op">:</span> <span class="st">"header"</span><span class="op">,</span> <span class="dt">text</span><span class="op">:</span> <span class="st">"Population en 2022"</span><span class="op">,</span> <span class="dt">anchor</span><span class="op">:</span> <span class="st">"start"</span> }<span class="op">,</span> <span class="co">// Titre</span></span>
<span id="cb47-607"><a href="#cb47-607" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">type</span><span class="op">:</span> <span class="st">"minimap"</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dt">width</span><span class="op">:</span> <span class="dv">160</span> }<span class="op">,</span> </span>
<span id="cb47-608"><a href="#cb47-608" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb47-609"><a href="#cb47-609" aria-hidden="true" tabindex="-1"></a>      <span class="dt">id</span> <span class="op">:</span> <span class="st">"bub"</span><span class="op">,</span> <span class="co">//  identifiant de la couche</span></span>
<span id="cb47-610"><a href="#cb47-610" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"bubble"</span><span class="op">,</span> <span class="co">// couche de symboles proportionnels</span></span>
<span id="cb47-611"><a href="#cb47-611" aria-hidden="true" tabindex="-1"></a>      <span class="dt">geojson</span><span class="op">:</span> munic<span class="op">,</span> </span>
<span id="cb47-612"><a href="#cb47-612" aria-hidden="true" tabindex="-1"></a>      <span class="dt">values</span><span class="op">:</span> <span class="st">"POP_2022"</span><span class="op">,</span> <span class="co">// variable √† cartographier </span></span>
<span id="cb47-613"><a href="#cb47-613" aria-hidden="true" tabindex="-1"></a>      <span class="dt">k</span><span class="op">:</span> <span class="dv">50</span><span class="op">,</span> <span class="co">// Rayon du plus gros cercle</span></span>
<span id="cb47-614"><a href="#cb47-614" aria-hidden="true" tabindex="-1"></a>      <span class="dt">leg_x</span><span class="op">:</span> <span class="dv">740</span><span class="op">,</span></span>
<span id="cb47-615"><a href="#cb47-615" aria-hidden="true" tabindex="-1"></a>      <span class="dt">leg_y</span><span class="op">:</span> <span class="dv">350</span><span class="op">,</span></span>
<span id="cb47-616"><a href="#cb47-616" aria-hidden="true" tabindex="-1"></a>      <span class="dt">leg_round</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb47-617"><a href="#cb47-617" aria-hidden="true" tabindex="-1"></a>      <span class="dt">leg_title</span><span class="op">:</span> <span class="st">"Nombre d'habitants"</span><span class="op">,</span></span>
<span id="cb47-618"><a href="#cb47-618" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fill</span><span class="op">:</span> <span class="st">"red"</span><span class="op">,</span></span>
<span id="cb47-619"><a href="#cb47-619" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fillOpacity</span><span class="op">:</span><span class="fl">0.5</span><span class="op">,</span></span>
<span id="cb47-620"><a href="#cb47-620" aria-hidden="true" tabindex="-1"></a>      <span class="dt">tooltip</span><span class="op">:</span> [<span class="st">"$MUS_NM_MUN"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">properties</span>[<span class="st">"POP_2022"</span>] <span class="op">+</span> <span class="st">" habitants"</span>] <span class="co">// infobulle</span></span>
<span id="cb47-621"><a href="#cb47-621" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb47-622"><a href="#cb47-622" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">geojson</span><span class="op">:</span> munic<span class="op">,</span> <span class="dt">fill</span><span class="op">:</span><span class="st">"#CCC"</span>}<span class="op">,</span> <span class="co">// Couche des communes</span></span>
<span id="cb47-623"><a href="#cb47-623" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">type</span><span class="op">:</span><span class="st">"scalebar"</span>}</span>
<span id="cb47-624"><a href="#cb47-624" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb47-625"><a href="#cb47-625" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb47-626"><a href="#cb47-626" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb47-627"><a href="#cb47-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-628"><a href="#cb47-628" aria-hidden="true" tabindex="-1"></a><span class="vs">On peut facilement combiner cette couche de cercles avec un une carte choropl√®the.</span></span>
<span id="cb47-629"><a href="#cb47-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-630"><a href="#cb47-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-633"><a href="#cb47-633" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb47-634"><a href="#cb47-634" aria-hidden="true" tabindex="-1"></a>bertin<span class="op">.</span><span class="fu">draw</span>({</span>
<span id="cb47-635"><a href="#cb47-635" aria-hidden="true" tabindex="-1"></a>  <span class="dt">params</span><span class="op">:</span> { <span class="dt">extent</span><span class="op">:</span> [[<span class="op">-</span><span class="dv">79</span><span class="op">,</span> <span class="fl">44.5</span>]<span class="op">,</span> [<span class="op">-</span><span class="dv">66</span><span class="op">,</span> <span class="dv">51</span>]]}<span class="op">,</span></span>
<span id="cb47-636"><a href="#cb47-636" aria-hidden="true" tabindex="-1"></a>  <span class="dt">layers</span><span class="op">:</span> [</span>
<span id="cb47-637"><a href="#cb47-637" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">type</span><span class="op">:</span> <span class="st">"header"</span><span class="op">,</span> <span class="dt">text</span><span class="op">:</span> <span class="st">"Population en 2022"</span><span class="op">,</span> <span class="dt">anchor</span><span class="op">:</span> <span class="st">"start"</span> }<span class="op">,</span> <span class="co">// Titre</span></span>
<span id="cb47-638"><a href="#cb47-638" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">type</span><span class="op">:</span> <span class="st">"minimap"</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dt">width</span><span class="op">:</span> <span class="dv">160</span> }<span class="op">,</span> </span>
<span id="cb47-639"><a href="#cb47-639" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb47-640"><a href="#cb47-640" aria-hidden="true" tabindex="-1"></a>      <span class="dt">id</span> <span class="op">:</span> <span class="st">"bub"</span><span class="op">,</span> </span>
<span id="cb47-641"><a href="#cb47-641" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"bubble"</span><span class="op">,</span> </span>
<span id="cb47-642"><a href="#cb47-642" aria-hidden="true" tabindex="-1"></a>      <span class="dt">geojson</span><span class="op">:</span> munic<span class="op">,</span> </span>
<span id="cb47-643"><a href="#cb47-643" aria-hidden="true" tabindex="-1"></a>      <span class="dt">values</span><span class="op">:</span> <span class="st">"POP_2022"</span><span class="op">,</span> </span>
<span id="cb47-644"><a href="#cb47-644" aria-hidden="true" tabindex="-1"></a>      <span class="dt">k</span><span class="op">:</span> <span class="dv">50</span><span class="op">,</span> </span>
<span id="cb47-645"><a href="#cb47-645" aria-hidden="true" tabindex="-1"></a>      <span class="dt">leg_x</span><span class="op">:</span> <span class="dv">690</span><span class="op">,</span></span>
<span id="cb47-646"><a href="#cb47-646" aria-hidden="true" tabindex="-1"></a>      <span class="dt">leg_y</span><span class="op">:</span> <span class="dv">370</span><span class="op">,</span></span>
<span id="cb47-647"><a href="#cb47-647" aria-hidden="true" tabindex="-1"></a>      <span class="dt">leg_round</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb47-648"><a href="#cb47-648" aria-hidden="true" tabindex="-1"></a>      <span class="dt">leg_title</span><span class="op">:</span> <span class="st">"Nombre d'habitants"</span><span class="op">,</span></span>
<span id="cb47-649"><a href="#cb47-649" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fill</span><span class="op">:</span> <span class="st">"white"</span><span class="op">,</span></span>
<span id="cb47-650"><a href="#cb47-650" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fillOpacity</span><span class="op">:</span><span class="fl">0.2</span><span class="op">,</span></span>
<span id="cb47-651"><a href="#cb47-651" aria-hidden="true" tabindex="-1"></a>      <span class="dt">stroke</span><span class="op">:</span><span class="st">"black"</span><span class="op">,</span></span>
<span id="cb47-652"><a href="#cb47-652" aria-hidden="true" tabindex="-1"></a>      <span class="dt">strokeWidth</span><span class="op">:</span><span class="fl">1.4</span><span class="op">,</span></span>
<span id="cb47-653"><a href="#cb47-653" aria-hidden="true" tabindex="-1"></a>      <span class="dt">tooltip</span><span class="op">:</span> [<span class="st">"$MUS_NM_MUN"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">properties</span>[<span class="st">"POP_2022"</span>] <span class="op">+</span> <span class="st">" habitants"</span>] </span>
<span id="cb47-654"><a href="#cb47-654" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb47-655"><a href="#cb47-655" aria-hidden="true" tabindex="-1"></a>    { </span>
<span id="cb47-656"><a href="#cb47-656" aria-hidden="true" tabindex="-1"></a>      <span class="dt">geojson</span><span class="op">:</span> munic<span class="op">,</span></span>
<span id="cb47-657"><a href="#cb47-657" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fill</span><span class="op">:</span> {</span>
<span id="cb47-658"><a href="#cb47-658" aria-hidden="true" tabindex="-1"></a>            <span class="dt">type</span><span class="op">:</span> <span class="st">"choro"</span><span class="op">,</span></span>
<span id="cb47-659"><a href="#cb47-659" aria-hidden="true" tabindex="-1"></a>            <span class="dt">values</span><span class="op">:</span> <span class="st">"VIT_ECO"</span><span class="op">,</span> </span>
<span id="cb47-660"><a href="#cb47-660" aria-hidden="true" tabindex="-1"></a>            <span class="dt">colors</span><span class="op">:</span> <span class="st">"RdYlBu"</span><span class="op">,</span></span>
<span id="cb47-661"><a href="#cb47-661" aria-hidden="true" tabindex="-1"></a>            <span class="dt">leg_x</span><span class="op">:</span><span class="dv">870</span><span class="op">,</span></span>
<span id="cb47-662"><a href="#cb47-662" aria-hidden="true" tabindex="-1"></a>            <span class="dt">leg_y</span><span class="op">:</span><span class="dv">315</span><span class="op">,</span></span>
<span id="cb47-663"><a href="#cb47-663" aria-hidden="true" tabindex="-1"></a>            <span class="dt">leg_title</span><span class="op">:</span> <span class="st">"Indice de</span><span class="sc">\n</span><span class="st">vitalit√©</span><span class="sc">\n</span><span class="st">√©conomique"</span><span class="op">,</span></span>
<span id="cb47-664"><a href="#cb47-664" aria-hidden="true" tabindex="-1"></a>            <span class="dt">leg_round</span><span class="op">:</span> <span class="dv">2</span></span>
<span id="cb47-665"><a href="#cb47-665" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb47-666"><a href="#cb47-666" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span> <span class="co">// Couche des communes</span></span>
<span id="cb47-667"><a href="#cb47-667" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">type</span><span class="op">:</span><span class="st">"scalebar"</span>}</span>
<span id="cb47-668"><a href="#cb47-668" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb47-669"><a href="#cb47-669" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb47-670"><a href="#cb47-670" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb47-671"><a href="#cb47-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-672"><a href="#cb47-672" aria-hidden="true" tabindex="-1"></a><span class="vs">On peut aussi colorier les cercles</span></span>
<span id="cb47-673"><a href="#cb47-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-676"><a href="#cb47-676" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb47-677"><a href="#cb47-677" aria-hidden="true" tabindex="-1"></a>bertin<span class="op">.</span><span class="fu">draw</span>({</span>
<span id="cb47-678"><a href="#cb47-678" aria-hidden="true" tabindex="-1"></a>  <span class="dt">params</span><span class="op">:</span> { <span class="dt">extent</span><span class="op">:</span> [[<span class="op">-</span><span class="dv">79</span><span class="op">,</span> <span class="fl">44.5</span>]<span class="op">,</span> [<span class="op">-</span><span class="dv">66</span><span class="op">,</span> <span class="dv">51</span>]]}<span class="op">,</span></span>
<span id="cb47-679"><a href="#cb47-679" aria-hidden="true" tabindex="-1"></a>  <span class="dt">layers</span><span class="op">:</span> [</span>
<span id="cb47-680"><a href="#cb47-680" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">type</span><span class="op">:</span> <span class="st">"header"</span><span class="op">,</span> <span class="dt">text</span><span class="op">:</span> <span class="st">"Population en 2022"</span><span class="op">,</span> <span class="dt">anchor</span><span class="op">:</span> <span class="st">"start"</span> }<span class="op">,</span> <span class="co">// Titre</span></span>
<span id="cb47-681"><a href="#cb47-681" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">type</span><span class="op">:</span> <span class="st">"minimap"</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dt">width</span><span class="op">:</span> <span class="dv">160</span> }<span class="op">,</span> </span>
<span id="cb47-682"><a href="#cb47-682" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb47-683"><a href="#cb47-683" aria-hidden="true" tabindex="-1"></a>      <span class="dt">id</span> <span class="op">:</span> <span class="st">"bub"</span><span class="op">,</span> </span>
<span id="cb47-684"><a href="#cb47-684" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"bubble"</span><span class="op">,</span> </span>
<span id="cb47-685"><a href="#cb47-685" aria-hidden="true" tabindex="-1"></a>      <span class="dt">geojson</span><span class="op">:</span> munic<span class="op">,</span> </span>
<span id="cb47-686"><a href="#cb47-686" aria-hidden="true" tabindex="-1"></a>      <span class="dt">values</span><span class="op">:</span> <span class="st">"POP_2022"</span><span class="op">,</span> </span>
<span id="cb47-687"><a href="#cb47-687" aria-hidden="true" tabindex="-1"></a>      <span class="dt">k</span><span class="op">:</span> <span class="dv">50</span><span class="op">,</span> </span>
<span id="cb47-688"><a href="#cb47-688" aria-hidden="true" tabindex="-1"></a>      <span class="dt">leg_x</span><span class="op">:</span> <span class="dv">690</span><span class="op">,</span></span>
<span id="cb47-689"><a href="#cb47-689" aria-hidden="true" tabindex="-1"></a>      <span class="dt">leg_y</span><span class="op">:</span> <span class="dv">370</span><span class="op">,</span></span>
<span id="cb47-690"><a href="#cb47-690" aria-hidden="true" tabindex="-1"></a>      <span class="dt">leg_round</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb47-691"><a href="#cb47-691" aria-hidden="true" tabindex="-1"></a>      <span class="dt">leg_title</span><span class="op">:</span> <span class="st">"Nombre d'habitants"</span><span class="op">,</span></span>
<span id="cb47-692"><a href="#cb47-692" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fill</span><span class="op">:</span> {</span>
<span id="cb47-693"><a href="#cb47-693" aria-hidden="true" tabindex="-1"></a>            <span class="dt">type</span><span class="op">:</span> <span class="st">"choro"</span><span class="op">,</span></span>
<span id="cb47-694"><a href="#cb47-694" aria-hidden="true" tabindex="-1"></a>            <span class="dt">values</span><span class="op">:</span> <span class="st">"VIT_ECO"</span><span class="op">,</span> </span>
<span id="cb47-695"><a href="#cb47-695" aria-hidden="true" tabindex="-1"></a>            <span class="dt">colors</span><span class="op">:</span> <span class="st">"RdYlBu"</span><span class="op">,</span></span>
<span id="cb47-696"><a href="#cb47-696" aria-hidden="true" tabindex="-1"></a>            <span class="dt">leg_x</span><span class="op">:</span><span class="dv">870</span><span class="op">,</span></span>
<span id="cb47-697"><a href="#cb47-697" aria-hidden="true" tabindex="-1"></a>            <span class="dt">leg_y</span><span class="op">:</span><span class="dv">315</span><span class="op">,</span></span>
<span id="cb47-698"><a href="#cb47-698" aria-hidden="true" tabindex="-1"></a>            <span class="dt">leg_title</span><span class="op">:</span> <span class="st">"Indice de</span><span class="sc">\n</span><span class="st">vitalit√©</span><span class="sc">\n</span><span class="st">√©conomique"</span><span class="op">,</span></span>
<span id="cb47-699"><a href="#cb47-699" aria-hidden="true" tabindex="-1"></a>            <span class="dt">leg_round</span><span class="op">:</span> <span class="dv">2</span></span>
<span id="cb47-700"><a href="#cb47-700" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb47-701"><a href="#cb47-701" aria-hidden="true" tabindex="-1"></a>      <span class="dt">tooltip</span><span class="op">:</span> [<span class="st">"$MUS_NM_MUN"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">properties</span>[<span class="st">"POP_2022"</span>] <span class="op">+</span> <span class="st">" habitants"</span>] </span>
<span id="cb47-702"><a href="#cb47-702" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb47-703"><a href="#cb47-703" aria-hidden="true" tabindex="-1"></a>    { </span>
<span id="cb47-704"><a href="#cb47-704" aria-hidden="true" tabindex="-1"></a>      <span class="dt">geojson</span><span class="op">:</span> munic<span class="op">,</span></span>
<span id="cb47-705"><a href="#cb47-705" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fill</span><span class="op">:</span> <span class="st">"#CCC"</span></span>
<span id="cb47-706"><a href="#cb47-706" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span> <span class="co">// Couche des communes</span></span>
<span id="cb47-707"><a href="#cb47-707" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">type</span><span class="op">:</span><span class="st">"scalebar"</span>}</span>
<span id="cb47-708"><a href="#cb47-708" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb47-709"><a href="#cb47-709" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb47-710"><a href="#cb47-710" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb47-711"><a href="#cb47-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-712"><a href="#cb47-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-713"><a href="#cb47-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-714"><a href="#cb47-714" aria-hidden="true" tabindex="-1"></a><span class="vs">On peut utiliser les **`</span><span class="fu">Inputs</span><span class="vs">`** pour tester des visualisations, explorer les donn√©es ou proposer des interactions √† un utilisatuer.</span></span>
<span id="cb47-715"><a href="#cb47-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-718"><a href="#cb47-718" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb47-719"><a href="#cb47-719" aria-hidden="true" tabindex="-1"></a><span class="co">// Inputs</span></span>
<span id="cb47-720"><a href="#cb47-720" aria-hidden="true" tabindex="-1"></a>viewof symbology <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">radio</span>([<span class="st">"bubble"</span><span class="op">,</span> <span class="st">"square"</span><span class="op">,</span> <span class="st">"spikes"</span><span class="op">,</span> <span class="st">"smooth"</span><span class="op">,</span> <span class="st">"dotdensity"</span>]<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"symbologie"</span><span class="op">,</span>   <span class="dt">value</span><span class="op">:</span> <span class="st">"bubble"</span>})</span>
<span id="cb47-721"><a href="#cb47-721" aria-hidden="true" tabindex="-1"></a>viewof r <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>]<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"taille"</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">50</span><span class="op">,</span> <span class="dt">disabled</span> <span class="op">:</span> [<span class="st">"bubble"</span><span class="op">,</span> <span class="st">"square"</span><span class="op">,</span> <span class="st">"spikes"</span>]<span class="op">.</span><span class="fu">includes</span>(symbology) <span class="op">?</span> <span class="kw">false</span><span class="op">:</span> <span class="kw">true</span>})</span>
<span id="cb47-722"><a href="#cb47-722" aria-hidden="true" tabindex="-1"></a>viewof toggle <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">toggle</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">"dorling"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="dt">disabled</span> <span class="op">:</span> [<span class="st">"bubble"</span><span class="op">,</span> <span class="st">"square"</span><span class="op">,</span> <span class="st">"dotdensity"</span>]<span class="op">.</span><span class="fu">includes</span>(symbology) <span class="op">?</span> <span class="kw">false</span><span class="op">:</span> <span class="kw">true</span>})</span>
<span id="cb47-723"><a href="#cb47-723" aria-hidden="true" tabindex="-1"></a>viewof thresholds <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">5</span><span class="op">,</span> <span class="dv">50</span>]<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"thresholds"</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">23</span><span class="op">,</span> <span class="dt">disabled</span> <span class="op">:</span> symbology <span class="op">==</span> <span class="st">"smooth"</span> <span class="op">?</span> <span class="kw">false</span> <span class="op">:</span> <span class="kw">true</span>})</span>
<span id="cb47-724"><a href="#cb47-724" aria-hidden="true" tabindex="-1"></a>viewof bandwidth <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">5</span><span class="op">,</span> <span class="dv">50</span>]<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"bandwidth"</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">27</span><span class="op">,</span> <span class="dt">disabled</span> <span class="op">:</span> symbology <span class="op">==</span> <span class="st">"smooth"</span> <span class="op">?</span> <span class="kw">false</span> <span class="op">:</span> <span class="kw">true</span> })</span>
<span id="cb47-725"><a href="#cb47-725" aria-hidden="true" tabindex="-1"></a>viewof filterpop <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">1000</span><span class="op">,</span> <span class="dv">100000</span>]<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"POP &gt;= "</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">1000</span>})</span>
<span id="cb47-726"><a href="#cb47-726" aria-hidden="true" tabindex="-1"></a><span class="co">// Carte</span></span>
<span id="cb47-727"><a href="#cb47-727" aria-hidden="true" tabindex="-1"></a>bertin<span class="op">.</span><span class="fu">draw</span>({</span>
<span id="cb47-728"><a href="#cb47-728" aria-hidden="true" tabindex="-1"></a>    <span class="dt">params</span><span class="op">:</span> { <span class="dt">extent</span><span class="op">:</span> [[<span class="op">-</span><span class="dv">79</span><span class="op">,</span> <span class="fl">44.5</span>]<span class="op">,</span> [<span class="op">-</span><span class="dv">66</span><span class="op">,</span> <span class="dv">51</span>]]}<span class="op">,</span></span>
<span id="cb47-729"><a href="#cb47-729" aria-hidden="true" tabindex="-1"></a>    <span class="dt">layers</span><span class="op">:</span> [</span>
<span id="cb47-730"><a href="#cb47-730" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb47-731"><a href="#cb47-731" aria-hidden="true" tabindex="-1"></a>        <span class="dt">type</span><span class="op">:</span> symbology<span class="op">,</span></span>
<span id="cb47-732"><a href="#cb47-732" aria-hidden="true" tabindex="-1"></a>        <span class="dt">geojson</span><span class="op">:</span> geo<span class="op">.</span><span class="fu">filter</span>(munic<span class="op">,</span> (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">POP_2022</span> <span class="op">&gt;=</span> filterpop)<span class="op">,</span> </span>
<span id="cb47-733"><a href="#cb47-733" aria-hidden="true" tabindex="-1"></a>        <span class="dt">values</span><span class="op">:</span> <span class="st">"POP_2022"</span><span class="op">,</span> </span>
<span id="cb47-734"><a href="#cb47-734" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fill</span><span class="op">:</span> symbology <span class="op">==</span> <span class="st">"smooth"</span> <span class="op">?</span> <span class="st">"RdYlGn"</span> <span class="op">:</span> <span class="st">"red"</span><span class="op">,</span></span>
<span id="cb47-735"><a href="#cb47-735" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fillOpacity</span><span class="op">:</span><span class="fl">0.7</span><span class="op">,</span></span>
<span id="cb47-736"><a href="#cb47-736" aria-hidden="true" tabindex="-1"></a>        <span class="dt">dorling</span><span class="op">:</span> toggle<span class="op">,</span></span>
<span id="cb47-737"><a href="#cb47-737" aria-hidden="true" tabindex="-1"></a>        <span class="dt">k</span><span class="op">:</span> r<span class="op">,</span></span>
<span id="cb47-738"><a href="#cb47-738" aria-hidden="true" tabindex="-1"></a>        thresholds<span class="op">,</span></span>
<span id="cb47-739"><a href="#cb47-739" aria-hidden="true" tabindex="-1"></a>        bandwidth<span class="op">,</span></span>
<span id="cb47-740"><a href="#cb47-740" aria-hidden="true" tabindex="-1"></a>        <span class="dt">symbol_size</span><span class="op">:</span><span class="dv">25</span><span class="op">,</span></span>
<span id="cb47-741"><a href="#cb47-741" aria-hidden="true" tabindex="-1"></a>        <span class="dt">w</span><span class="op">:</span><span class="dv">15</span><span class="op">,</span></span>
<span id="cb47-742"><a href="#cb47-742" aria-hidden="true" tabindex="-1"></a>        <span class="dt">symbol_shift</span> <span class="op">:</span> toggle <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb47-743"><a href="#cb47-743" aria-hidden="true" tabindex="-1"></a>        <span class="dt">stroke</span> <span class="op">:</span> symbology <span class="op">==</span> <span class="st">"spikes"</span> <span class="op">?</span> <span class="st">"red"</span> <span class="op">:</span> <span class="st">"white"</span><span class="op">,</span></span>
<span id="cb47-744"><a href="#cb47-744" aria-hidden="true" tabindex="-1"></a>        <span class="dt">tooltip</span><span class="op">:</span> [<span class="st">"$MUS_NM_MUN"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">properties</span>[<span class="st">"POP_2022"</span>] <span class="op">+</span> <span class="st">" habitants"</span>] </span>
<span id="cb47-745"><a href="#cb47-745" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb47-746"><a href="#cb47-746" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb47-747"><a href="#cb47-747" aria-hidden="true" tabindex="-1"></a>        <span class="dt">geojson</span><span class="op">:</span> munic<span class="op">,</span></span>
<span id="cb47-748"><a href="#cb47-748" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fill</span><span class="op">:</span> <span class="st">"#CCC"</span><span class="op">,</span></span>
<span id="cb47-749"><a href="#cb47-749" aria-hidden="true" tabindex="-1"></a>        <span class="dt">stroke</span> <span class="op">:</span> toggle <span class="op">?</span> <span class="st">"#CCC"</span> <span class="op">:</span> <span class="st">"white"</span></span>
<span id="cb47-750"><a href="#cb47-750" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span> </span>
<span id="cb47-751"><a href="#cb47-751" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb47-752"><a href="#cb47-752" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb47-753"><a href="#cb47-753" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb47-754"><a href="#cb47-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-755"><a href="#cb47-755" aria-hidden="true" tabindex="-1"></a><span class="vs">## A vous de jouer</span></span>
<span id="cb47-756"><a href="#cb47-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-757"><a href="#cb47-757" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.callout-caution appearance="simple"}</span></span>
<span id="cb47-758"><a href="#cb47-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-759"><a href="#cb47-759" aria-hidden="true" tabindex="-1"></a><span class="vs">## faire des cartes avec {ojs}</span></span>
<span id="cb47-760"><a href="#cb47-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-761"><a href="#cb47-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-762"><a href="#cb47-762" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.callout-note icon=false}</span></span>
<span id="cb47-763"><a href="#cb47-763" aria-hidden="true" tabindex="-1"></a><span class="vs">## Objectif</span></span>
<span id="cb47-764"><a href="#cb47-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-765"><a href="#cb47-765" aria-hidden="true" tabindex="-1"></a><span class="vs">R√©aliser comme ci-dessous, une carte [choropl√®the](http://geoconfluences.ens-lyon.fr/glossaire/choroplethe-choroisoplethe) sur une r√©gion du Qu√©bec que l'on peut selectionner dans une liste d√©roulante.</span></span>
<span id="cb47-766"><a href="#cb47-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-769"><a href="#cb47-769" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb47-770"><a href="#cb47-770" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb47-771"><a href="#cb47-771" aria-hidden="true" tabindex="-1"></a><span class="co">//| eval: true</span></span>
<span id="cb47-772"><a href="#cb47-772" aria-hidden="true" tabindex="-1"></a>viewof myregion <span class="op">=</span>  Inputs<span class="op">.</span><span class="fu">select</span>([<span class="st">"Estrie"</span><span class="op">,</span><span class="st">"Capitale-Nationale"</span><span class="op">,</span><span class="st">"Bas-Saint-Laurent"</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Choisissez une r√©gion"</span>})</span>
<span id="cb47-773"><a href="#cb47-773" aria-hidden="true" tabindex="-1"></a>myreg <span class="op">=</span> bertin<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="fu">subset</span>({</span>
<span id="cb47-774"><a href="#cb47-774" aria-hidden="true" tabindex="-1"></a>    <span class="dt">geojson</span><span class="op">:</span> munic<span class="op">,</span></span>
<span id="cb47-775"><a href="#cb47-775" aria-hidden="true" tabindex="-1"></a>    <span class="dt">field</span><span class="op">:</span> <span class="st">"MUS_NM_REG"</span><span class="op">,</span></span>
<span id="cb47-776"><a href="#cb47-776" aria-hidden="true" tabindex="-1"></a>    <span class="dt">selection</span><span class="op">:</span>   [myregion]</span>
<span id="cb47-777"><a href="#cb47-777" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb47-778"><a href="#cb47-778" aria-hidden="true" tabindex="-1"></a>bertin<span class="op">.</span><span class="fu">draw</span>({ <span class="dt">layers</span><span class="op">:</span> [{<span class="dt">type</span><span class="op">:</span><span class="st">"header"</span><span class="op">,</span> <span class="dt">text</span><span class="op">:</span> <span class="vs">`Les actifs (</span><span class="sc">${</span>myregion<span class="sc">}</span><span class="vs">)`</span>}<span class="op">,</span>{<span class="dt">type</span><span class="op">:</span><span class="st">"scalebar"</span>}<span class="op">,</span>{ <span class="dt">geojson</span><span class="op">:</span> myreg<span class="op">,</span> <span class="dt">rewind</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> {<span class="dt">type</span><span class="op">:</span><span class="st">"choro"</span><span class="op">,</span> <span class="dt">values</span><span class="op">:</span> <span class="st">"TX_2564"</span><span class="op">,</span> <span class="dt">colors</span><span class="op">:</span> <span class="st">"RdYlGn"</span><span class="op">,</span> <span class="dt">leg_x</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="dt">leg_y</span><span class="op">:</span><span class="dv">2</span><span class="op">,</span> <span class="dt">leg_title</span><span class="op">:</span><span class="st">"Taux d'actifs"</span><span class="op">,</span> <span class="dt">leg_round</span><span class="op">:</span><span class="dv">1</span>}<span class="op">,</span> <span class="dt">tooltip</span><span class="op">:</span>[<span class="st">"$MUS_NM_MUN"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="st">"Taux d'actifs :"</span> <span class="op">+</span> d<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">TX_2564</span> <span class="op">+</span> <span class="st">"%"</span>]}] })</span>
<span id="cb47-779"><a href="#cb47-779" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb47-780"><a href="#cb47-780" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb47-781"><a href="#cb47-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-782"><a href="#cb47-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-783"><a href="#cb47-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-784"><a href="#cb47-784" aria-hidden="true" tabindex="-1"></a><span class="vs">**A vous de jouer**</span></span>
<span id="cb47-785"><a href="#cb47-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-786"><a href="#cb47-786" aria-hidden="true" tabindex="-1"></a><span class="vs">- Chargez la biblioth√®que [`</span><span class="fu">bertin</span><span class="vs">`](https://github.com/neocarto/bertin)</span></span>
<span id="cb47-787"><a href="#cb47-787" aria-hidden="true" tabindex="-1"></a><span class="vs">- Importez la couche `</span>munic<span class="op">.</span><span class="fu">geojson</span><span class="vs">`</span></span>
<span id="cb47-788"><a href="#cb47-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-789"><a href="#cb47-789" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.callout-tip icon=false collapse="true"}</span></span>
<span id="cb47-790"><a href="#cb47-790" aria-hidden="true" tabindex="-1"></a><span class="vs">## Besoin d'aide ?</span></span>
<span id="cb47-791"><a href="#cb47-791" aria-hidden="true" tabindex="-1"></a><span class="vs">Pour importer des donn√©es au format JSON en Observable JavaScript, on utilise l'instruction `</span><span class="fu">FileAttachment</span>()<span class="vs">`</span></span>
<span id="cb47-792"><a href="#cb47-792" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb47-793"><a href="#cb47-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-794"><a href="#cb47-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-795"><a href="#cb47-795" aria-hidden="true" tabindex="-1"></a><span class="vs">- Afficher le fond de carte avec la fonction [`</span><span class="fu">draw</span><span class="vs">`](https://github.com/neocarto/bertin#drawing-a-map)</span></span>
<span id="cb47-796"><a href="#cb47-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-797"><a href="#cb47-797" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.callout-tip icon=false collapse="true"}</span></span>
<span id="cb47-798"><a href="#cb47-798" aria-hidden="true" tabindex="-1"></a><span class="vs">## Besoin d'aide ?</span></span>
<span id="cb47-799"><a href="#cb47-799" aria-hidden="true" tabindex="-1"></a><span class="vs">La fonction draw prend en entr√©e un objet qui a la structure suivante : </span></span>
<span id="cb47-800"><a href="#cb47-800" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span>js</span>
<span id="cb47-801"><a href="#cb47-801" aria-hidden="true" tabindex="-1"></a>bertin<span class="op">.</span><span class="fu">draw</span>({</span>
<span id="cb47-802"><a href="#cb47-802" aria-hidden="true" tabindex="-1"></a>  <span class="dt">layers</span><span class="op">:</span> [{<span class="op">...</span>}]</span>
<span id="cb47-803"><a href="#cb47-803" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb47-804"><a href="#cb47-804" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb47-805"><a href="#cb47-805" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb47-806"><a href="#cb47-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-807"><a href="#cb47-807" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.callout-tip icon=false collapse="true"}</span></span>
<span id="cb47-808"><a href="#cb47-808" aria-hidden="true" tabindex="-1"></a><span class="vs">## Astuce</span></span>
<span id="cb47-809"><a href="#cb47-809" aria-hidden="true" tabindex="-1"></a><span class="vs">Si la carte ne s'affiche pas correctement, utiliser l'attribut `</span>rewind<span class="op">:</span><span class="fu">true</span><span class="vs">`</span></span>
<span id="cb47-810"><a href="#cb47-810" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb47-811"><a href="#cb47-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-812"><a href="#cb47-812" aria-hidden="true" tabindex="-1"></a><span class="vs">- Afficher les donn√©es attributaires.</span></span>
<span id="cb47-813"><a href="#cb47-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-814"><a href="#cb47-814" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.callout-tip icon=false collapse="true"}</span></span>
<span id="cb47-815"><a href="#cb47-815" aria-hidden="true" tabindex="-1"></a><span class="vs">## Besoin d'aide ?</span></span>
<span id="cb47-816"><a href="#cb47-816" aria-hidden="true" tabindex="-1"></a><span class="vs">On peut afficher les donn√©es avec l'instruction. `</span>Inputs<span class="op">.</span><span class="fu">table</span>()<span class="vs">`</span></span>
<span id="cb47-817"><a href="#cb47-817" aria-hidden="true" tabindex="-1"></a><span class="vs">Mais auparavant, il faut r√©cup√©rer les propri√©t√©s du geoJSON comme ceci :</span></span>
<span id="cb47-818"><a href="#cb47-818" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span>js</span>
<span id="cb47-819"><a href="#cb47-819" aria-hidden="true" tabindex="-1"></a>munic<span class="op">.</span><span class="at">features</span><span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">properties</span>)</span>
<span id="cb47-820"><a href="#cb47-820" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb47-821"><a href="#cb47-821" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb47-822"><a href="#cb47-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-823"><a href="#cb47-823" aria-hidden="true" tabindex="-1"></a><span class="vs">- Cr√©er une liste d√©roulante pour choisir parmi 3 r√©gions √† √©tudier</span></span>
<span id="cb47-824"><a href="#cb47-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-825"><a href="#cb47-825" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.callout-tip icon=false collapse="true"}</span></span>
<span id="cb47-826"><a href="#cb47-826" aria-hidden="true" tabindex="-1"></a><span class="vs">## Besoin d'aide ?</span></span>
<span id="cb47-827"><a href="#cb47-827" aria-hidden="true" tabindex="-1"></a><span class="vs">Par exemple :</span></span>
<span id="cb47-828"><a href="#cb47-828" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span>js</span>
<span id="cb47-829"><a href="#cb47-829" aria-hidden="true" tabindex="-1"></a>mesregions <span class="op">=</span> [<span class="st">"Estrie"</span><span class="op">,</span><span class="st">"Capitale-Nationale"</span><span class="op">,</span><span class="st">"Bas-Saint-Laurent"</span>]</span>
<span id="cb47-830"><a href="#cb47-830" aria-hidden="true" tabindex="-1"></a>viewof myregion <span class="op">=</span>  Inputs<span class="op">.</span><span class="fu">select</span>(mesregions<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Choisissez une r√©gion"</span>})</span>
<span id="cb47-831"><a href="#cb47-831" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb47-832"><a href="#cb47-832" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb47-833"><a href="#cb47-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-834"><a href="#cb47-834" aria-hidden="true" tabindex="-1"></a><span class="vs">- Cr√©ez un nouveau fond de carte contenant les municipalit√©s de la r√©gion concern√©e.</span></span>
<span id="cb47-835"><a href="#cb47-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-836"><a href="#cb47-836" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.callout-tip icon=false collapse="true"}</span></span>
<span id="cb47-837"><a href="#cb47-837" aria-hidden="true" tabindex="-1"></a><span class="vs">## Besoin d'aide ?</span></span>
<span id="cb47-838"><a href="#cb47-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-839"><a href="#cb47-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-840"><a href="#cb47-840" aria-hidden="true" tabindex="-1"></a><span class="vs">Pour cr√©er ce sous jeu de donn√©es, on peut utiliser la fonction `</span><span class="fu">subset</span><span class="vs">` de la biblioth√®que `</span><span class="fu">bertin</span><span class="vs">`.</span></span>
<span id="cb47-841"><a href="#cb47-841" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span>js</span>
<span id="cb47-842"><a href="#cb47-842" aria-hidden="true" tabindex="-1"></a>myreg <span class="op">=</span> bertin<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="fu">subset</span>({</span>
<span id="cb47-843"><a href="#cb47-843" aria-hidden="true" tabindex="-1"></a>    <span class="dt">geojson</span><span class="op">:</span> munic<span class="op">,</span></span>
<span id="cb47-844"><a href="#cb47-844" aria-hidden="true" tabindex="-1"></a>    <span class="dt">field</span><span class="op">:</span> <span class="st">"MUS_NM_REG"</span><span class="op">,</span></span>
<span id="cb47-845"><a href="#cb47-845" aria-hidden="true" tabindex="-1"></a>    <span class="dt">selection</span><span class="op">:</span>   [myregion]</span>
<span id="cb47-846"><a href="#cb47-846" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb47-847"><a href="#cb47-847" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb47-848"><a href="#cb47-848" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb47-849"><a href="#cb47-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-850"><a href="#cb47-850" aria-hidden="true" tabindex="-1"></a><span class="vs">- Afficher le nouveau fond de carte</span></span>
<span id="cb47-851"><a href="#cb47-851" aria-hidden="true" tabindex="-1"></a><span class="vs">- D√©finisser la couleur de fond, l'√©paisseur des traits, la couleur des contours.</span></span>
<span id="cb47-852"><a href="#cb47-852" aria-hidden="true" tabindex="-1"></a><span class="vs">- R√©aliser une carte [chorpl√®the](https://github.com/neocarto/bertin#choropleth) √† partir d'une variable disponible. Par exemple, le taux d'actifs (TX_2564).</span></span>
<span id="cb47-853"><a href="#cb47-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-854"><a href="#cb47-854" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.callout-tip icon=false collapse="true"}</span></span>
<span id="cb47-855"><a href="#cb47-855" aria-hidden="true" tabindex="-1"></a><span class="vs">## Besoin d'aide ?</span></span>
<span id="cb47-856"><a href="#cb47-856" aria-hidden="true" tabindex="-1"></a><span class="vs">D√©finissez l'attribut `</span><span class="fu">fill</span><span class="vs">` par un objet commen√ßant par `</span>{<span class="dt">type</span><span class="op">:</span> choro<span class="op">,</span> <span class="dt">values</span><span class="op">:</span> <span class="op">...</span>}<span class="vs">`</span></span>
<span id="cb47-857"><a href="#cb47-857" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb47-858"><a href="#cb47-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-859"><a href="#cb47-859" aria-hidden="true" tabindex="-1"></a><span class="vs">- Changez les couleurs et la m√©thode de discretisation</span></span>
<span id="cb47-860"><a href="#cb47-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-861"><a href="#cb47-861" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.callout-tip icon=false collapse="true"}</span></span>
<span id="cb47-862"><a href="#cb47-862" aria-hidden="true" tabindex="-1"></a><span class="vs">## Besoin d'aide ?</span></span>
<span id="cb47-863"><a href="#cb47-863" aria-hidden="true" tabindex="-1"></a><span class="vs">La documentation est disponible [ici](https://github.com/neocarto/bertin#choropleth)</span></span>
<span id="cb47-864"><a href="#cb47-864" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb47-865"><a href="#cb47-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-866"><a href="#cb47-866" aria-hidden="true" tabindex="-1"></a><span class="vs">- Ajouter un [titre](https://github.com/neocarto/bertin#header)</span></span>
<span id="cb47-867"><a href="#cb47-867" aria-hidden="true" tabindex="-1"></a><span class="vs">- Ajouter la l√©gende</span></span>
<span id="cb47-868"><a href="#cb47-868" aria-hidden="true" tabindex="-1"></a><span class="vs">- Ajouter l'[√©chelle](https://github.com/neocarto/bertin#scalebar)</span></span>
<span id="cb47-869"><a href="#cb47-869" aria-hidden="true" tabindex="-1"></a><span class="vs">- Ajoutez des [infobulles](https://observablehq.com/@neocartocnrs/bertin-js-tooltips)</span></span>
<span id="cb47-870"><a href="#cb47-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-871"><a href="#cb47-871" aria-hidden="true" tabindex="-1"></a><span class="vs">::: {.callout-caution collapse="true"}</span></span>
<span id="cb47-872"><a href="#cb47-872" aria-hidden="true" tabindex="-1"></a><span class="vs">## SOLUTION</span></span>
<span id="cb47-873"><a href="#cb47-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-876"><a href="#cb47-876" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb47-877"><a href="#cb47-877" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: true</span></span>
<span id="cb47-878"><a href="#cb47-878" aria-hidden="true" tabindex="-1"></a><span class="co">//| eval: false</span></span>
<span id="cb47-879"><a href="#cb47-879" aria-hidden="true" tabindex="-1"></a>bertin <span class="op">=</span> <span class="pp">require</span>(<span class="st">"bertin"</span>)</span>
<span id="cb47-880"><a href="#cb47-880" aria-hidden="true" tabindex="-1"></a>munic <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"munic.geojson"</span>)<span class="op">.</span><span class="fu">json</span>()</span>
<span id="cb47-881"><a href="#cb47-881" aria-hidden="true" tabindex="-1"></a>viewof myregion <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">select</span>(</span>
<span id="cb47-882"><a href="#cb47-882" aria-hidden="true" tabindex="-1"></a>  [<span class="st">"Estrie"</span><span class="op">,</span> <span class="st">"Capitale-Nationale"</span><span class="op">,</span> <span class="st">"Bas-Saint-Laurent"</span>]<span class="op">,</span></span>
<span id="cb47-883"><a href="#cb47-883" aria-hidden="true" tabindex="-1"></a>  { <span class="dt">label</span><span class="op">:</span> <span class="st">"Choisissez une r√©gion"</span> }</span>
<span id="cb47-884"><a href="#cb47-884" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-885"><a href="#cb47-885" aria-hidden="true" tabindex="-1"></a>myreg <span class="op">=</span> bertin<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="fu">subset</span>({</span>
<span id="cb47-886"><a href="#cb47-886" aria-hidden="true" tabindex="-1"></a>    <span class="dt">geojson</span><span class="op">:</span> munic<span class="op">,</span></span>
<span id="cb47-887"><a href="#cb47-887" aria-hidden="true" tabindex="-1"></a>    <span class="dt">field</span><span class="op">:</span> <span class="st">"MUS_NM_REG"</span><span class="op">,</span></span>
<span id="cb47-888"><a href="#cb47-888" aria-hidden="true" tabindex="-1"></a>    <span class="dt">selection</span><span class="op">:</span>   [myregion]</span>
<span id="cb47-889"><a href="#cb47-889" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb47-890"><a href="#cb47-890" aria-hidden="true" tabindex="-1"></a>bertin<span class="op">.</span><span class="fu">draw</span>({</span>
<span id="cb47-891"><a href="#cb47-891" aria-hidden="true" tabindex="-1"></a>  <span class="dt">layers</span><span class="op">:</span> [</span>
<span id="cb47-892"><a href="#cb47-892" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">type</span><span class="op">:</span> <span class="st">"header"</span><span class="op">,</span> <span class="dt">text</span><span class="op">:</span> <span class="vs">`Les actifs (</span><span class="sc">${</span>myregion<span class="sc">}</span><span class="vs">)`</span> }<span class="op">,</span></span>
<span id="cb47-893"><a href="#cb47-893" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">type</span><span class="op">:</span> <span class="st">"scalebar"</span> }<span class="op">,</span></span>
<span id="cb47-894"><a href="#cb47-894" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb47-895"><a href="#cb47-895" aria-hidden="true" tabindex="-1"></a>      <span class="dt">geojson</span><span class="op">:</span> myreg<span class="op">,</span></span>
<span id="cb47-896"><a href="#cb47-896" aria-hidden="true" tabindex="-1"></a>      <span class="dt">rewind</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb47-897"><a href="#cb47-897" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fill</span><span class="op">:</span> {</span>
<span id="cb47-898"><a href="#cb47-898" aria-hidden="true" tabindex="-1"></a>        <span class="dt">type</span><span class="op">:</span> <span class="st">"choro"</span><span class="op">,</span></span>
<span id="cb47-899"><a href="#cb47-899" aria-hidden="true" tabindex="-1"></a>        <span class="dt">values</span><span class="op">:</span> <span class="st">"TX_2564"</span><span class="op">,</span></span>
<span id="cb47-900"><a href="#cb47-900" aria-hidden="true" tabindex="-1"></a>        <span class="dt">colors</span><span class="op">:</span> <span class="st">"RdYlGn"</span><span class="op">,</span></span>
<span id="cb47-901"><a href="#cb47-901" aria-hidden="true" tabindex="-1"></a>        <span class="dt">leg_x</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb47-902"><a href="#cb47-902" aria-hidden="true" tabindex="-1"></a>        <span class="dt">leg_y</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb47-903"><a href="#cb47-903" aria-hidden="true" tabindex="-1"></a>        <span class="dt">leg_title</span><span class="op">:</span> <span class="st">"Taux d'actifs"</span><span class="op">,</span></span>
<span id="cb47-904"><a href="#cb47-904" aria-hidden="true" tabindex="-1"></a>        <span class="dt">leg_round</span><span class="op">:</span> <span class="dv">1</span></span>
<span id="cb47-905"><a href="#cb47-905" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb47-906"><a href="#cb47-906" aria-hidden="true" tabindex="-1"></a>      <span class="dt">tooltip</span><span class="op">:</span> [</span>
<span id="cb47-907"><a href="#cb47-907" aria-hidden="true" tabindex="-1"></a>        <span class="st">"$MUS_NM_MUN"</span><span class="op">,</span></span>
<span id="cb47-908"><a href="#cb47-908" aria-hidden="true" tabindex="-1"></a>        (d) <span class="kw">=&gt;</span> <span class="st">"Taux d'actifs :"</span> <span class="op">+</span> d<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">TX_2564</span> <span class="op">+</span> <span class="st">"%"</span></span>
<span id="cb47-909"><a href="#cb47-909" aria-hidden="true" tabindex="-1"></a>      ]</span>
<span id="cb47-910"><a href="#cb47-910" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb47-911"><a href="#cb47-911" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb47-912"><a href="#cb47-912" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb47-913"><a href="#cb47-913" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb47-914"><a href="#cb47-914" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb47-915"><a href="#cb47-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-916"><a href="#cb47-916" aria-hidden="true" tabindex="-1"></a><span class="vs">:::</span></span>
<span id="cb47-917"><a href="#cb47-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-918"><a href="#cb47-918" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>